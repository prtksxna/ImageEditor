/*! OOjs UI v0.13.3 | http://oojs.mit-license.org */
!function(a){"use strict";a.ui={},a.ui.bind=$.proxy,a.ui.Keys={UNDEFINED:0,BACKSPACE:8,DELETE:46,LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13,END:35,HOME:36,TAB:9,PAGEUP:33,PAGEDOWN:34,ESCAPE:27,SHIFT:16,SPACE:32},a.ui.elementId=0,a.ui.generateElementId=function(){return a.ui.elementId+=1,"oojsui-"+a.ui.elementId},a.ui.isFocusableElement=function(a){var b,c=a[0];return c.disabled?!1:!$.expr.filters.visible(c)||a.parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length?!1:"true"===c.contentEditable?!0:a.prop("tabIndex")>=0?!0:(b=c.nodeName.toLowerCase(),-1!==["input","select","textarea","button","object"].indexOf(b)?!0:"a"!==b&&"area"!==b||void 0===a.attr("href")?!1:!0)},a.ui.findFocusable=function(b,c){var d=$([]),e=b.find("input, select, textarea, button, object, a, area, [contenteditable], [tabindex]");return c&&(e=Array.prototype.reverse.call(e)),e.each(function(){var b=$(this);return a.ui.isFocusableElement(b)?(d=b,!1):void 0}),d},a.ui.getUserLanguages=function(){return["en"]},a.ui.getLocalValue=function(b,c,d){var e,f,g;if(b[c])return b[c];for(g=a.ui.getUserLanguages(),e=0,f=g.length;f>e;e++)if(c=g[e],b[c])return b[c];if(b[d])return b[d];for(c in b)return b[c];return void 0},a.ui.contains=function(a,b,c){var d;for(Array.isArray(a)||(a=[a]),d=a.length-1;d>=0;d--)if(c&&b===a[d]||$.contains(a[d],b))return!0;return!1},a.ui.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)};c&&!d&&a.apply(e,f),clearTimeout(d),d=setTimeout(g,b)}},a.ui.addCaptureEventListener=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!0):a.attachEvent("on"+b,c)},a.ui.removeCaptureEventListener=function(a,b,c){a.addEventListener?a.removeEventListener(b,c,!0):a.detachEvent("on"+b,c)},a.ui.infuse=function(b){return a.ui.Element["static"].infuse(b)},function(){var b={"ooui-outline-control-move-down":"Move item down","ooui-outline-control-move-up":"Move item up","ooui-outline-control-remove":"Remove item","ooui-toolbar-more":"More","ooui-toolgroup-expand":"More","ooui-toolgroup-collapse":"Fewer","ooui-dialog-message-accept":"OK","ooui-dialog-message-reject":"Cancel","ooui-dialog-process-error":"Something went wrong","ooui-dialog-process-dismiss":"Dismiss","ooui-dialog-process-retry":"Try again","ooui-dialog-process-continue":"Continue","ooui-selectfile-button-select":"Select a file","ooui-selectfile-not-supported":"File selection is not supported","ooui-selectfile-placeholder":"No file is selected","ooui-selectfile-dragdrop-placeholder":"Drop file here"};a.ui.msg=function(a){var c=b[a],d=Array.prototype.slice.call(arguments,1);return c="string"==typeof c?c.replace(/\$(\d+)/g,function(a,b){var c=parseInt(b,10);return void 0!==d[c-1]?d[c-1]:"$"+b}):"["+a+"]"},a.ui.deferMsg=function(){var b=arguments;return function(){return a.ui.msg.apply(a.ui,b)}},a.ui.resolveMsg=function(a){return $.isFunction(a)?a():a},a.ui.isSafeUrl=function(a){var b,c=["bitcoin:","ftp:","ftps:","geo:","git:","gopher:","http:","https:","irc:","ircs:","magnet:","mailto:","mms:","news:","nntp:","redis:","sftp:","sip:","sips:","sms:","ssh:","svn:","tel:","telnet:","urn:","worldwind:","xmpp:"];return-1===a.indexOf(":")?!0:(b=a.split(":",1)[0]+":",b.match(/^([A-za-z0-9\+\.\-])+:/)?-1!==c.indexOf(b):!0)}}(),a.ui.mixin={},a.ui.mixin.PendingElement=function(a){a=a||{},this.pending=0,this.$pending=null,this.setPendingElement(a.$pending||this.$element)},a.initClass(a.ui.mixin.PendingElement),a.ui.mixin.PendingElement.prototype.setPendingElement=function(a){this.$pending&&this.$pending.removeClass("oo-ui-pendingElement-pending"),this.$pending=a,this.pending>0&&this.$pending.addClass("oo-ui-pendingElement-pending")},a.ui.mixin.PendingElement.prototype.isPending=function(){return!!this.pending},a.ui.mixin.PendingElement.prototype.pushPending=function(){return 0===this.pending&&(this.$pending.addClass("oo-ui-pendingElement-pending"),this.updateThemeClasses()),this.pending++,this},a.ui.mixin.PendingElement.prototype.popPending=function(){return 1===this.pending&&(this.$pending.removeClass("oo-ui-pendingElement-pending"),this.updateThemeClasses()),this.pending=Math.max(0,this.pending-1),this},a.ui.ActionSet=function(b){b=b||{},a.EventEmitter.call(this),this.list=[],this.categories={actions:"getAction",flags:"getFlags",modes:"getModes"},this.categorized={},this.special={},this.others=[],this.organized=!1,this.changing=!1,this.changed=!1},a.mixinClass(a.ui.ActionSet,a.EventEmitter),a.ui.ActionSet["static"].specialFlags=["safe","primary"],a.ui.ActionSet.prototype.onActionChange=function(){this.organized=!1,this.changing?this.changed=!0:this.emit("change")},a.ui.ActionSet.prototype.isSpecial=function(a){var b;for(b in this.special)if(a===this.special[b])return!0;return!1},a.ui.ActionSet.prototype.get=function(a){var b,c,d,e,f,g,h,i;if(a){this.organize(),i=[];for(e in this.categorized)if(d=a[e])for(Array.isArray(d)||(d=[d]),b=0,c=d.length;c>b;b++)f=this.categorized[e][d[b]],Array.isArray(f)&&i.push.apply(i,f);for(b=0,c=i.length;c>b;b++)h=i[b],(void 0!==a.visible&&h.isVisible()!==a.visible||void 0!==a.disabled&&h.isDisabled()!==a.disabled)&&(i.splice(b,1),c--,b--);for(b=0,c=i.length;c>b;b++)for(h=i[b],g=i.lastIndexOf(h);g!==b;)i.splice(g,1),c--,g=i.lastIndexOf(h);return i}return this.list.slice()},a.ui.ActionSet.prototype.getSpecial=function(){return this.organize(),$.extend({},this.special)},a.ui.ActionSet.prototype.getOthers=function(){return this.organize(),this.others.slice()},a.ui.ActionSet.prototype.setMode=function(a){var b,c,d;for(this.changing=!0,b=0,c=this.list.length;c>b;b++)d=this.list[b],d.toggle(d.hasMode(a));return this.organized=!1,this.changing=!1,this.emit("change"),this},a.ui.ActionSet.prototype.setAbilities=function(a){var b,c,d,e;for(b=0,c=this.list.length;c>b;b++)e=this.list[b],d=e.getAction(),void 0!==a[d]&&e.setDisabled(!a[d]);return this},a.ui.ActionSet.prototype.forEach=function(a,b){return this.changed=!1,this.changing=!0,this.get(a).forEach(b),this.changing=!1,this.changed&&this.emit("change"),this},a.ui.ActionSet.prototype.add=function(a){var b,c,d;for(this.changing=!0,b=0,c=a.length;c>b;b++)d=a[b],d.connect(this,{click:["emit","click",d],resize:["emit","resize",d],toggle:["onActionChange"]}),this.list.push(d);return this.organized=!1,this.emit("add",a),this.changing=!1,this.emit("change"),this},a.ui.ActionSet.prototype.remove=function(a){var b,c,d,e;for(this.changing=!0,b=0,c=a.length;c>b;b++)e=a[b],d=this.list.indexOf(e),-1!==d&&(e.disconnect(this),this.list.splice(d,1));return this.organized=!1,this.emit("remove",a),this.changing=!1,this.emit("change"),this},a.ui.ActionSet.prototype.clear=function(){var a,b,c,d=this.list.slice();for(this.changing=!0,a=0,b=this.list.length;b>a;a++)c=this.list[a],c.disconnect(this);return this.list=[],this.organized=!1,this.emit("remove",d),this.changing=!1,this.emit("change"),this},a.ui.ActionSet.prototype.organize=function(){var a,b,c,d,e,f,g,h,i,j,k=this.constructor["static"].specialFlags;if(!this.organized){for(this.categorized={},this.special={},this.others=[],a=0,b=this.list.length;b>a;a++)if(f=this.list[a],f.isVisible()){for(g in this.categories)for(this.categorized[g]||(this.categorized[g]={}),h=f[this.categories[g]](),Array.isArray(h)||(h=[h]),c=0,d=h.length;d>c;c++)i=h[c],this.categorized[g][i]||(this.categorized[g][i]=[]),this.categorized[g][i].push(f);for(j=!1,c=0,d=k.length;d>c;c++)if(e=k[c],!this.special[e]&&f.hasFlag(e)){this.special[e]=f,j=!0;break}j||this.others.push(f)}this.organized=!0}return this},a.ui.Element=function(b){b=b||{},this.$=$,this.visible=!0,this.data=b.data,this.$element=b.$element||$(document.createElement(this.getTagName())),this.elementGroup=null,this.debouncedUpdateThemeClassesHandler=a.ui.debounce(this.debouncedUpdateThemeClasses),Array.isArray(b.classes)&&this.$element.addClass(b.classes.join(" ")),b.id&&this.$element.attr("id",b.id),b.text&&this.$element.text(b.text),b.content&&this.$element.append(b.content.map(function(b){return"string"==typeof b?document.createTextNode(b):b instanceof a.ui.HtmlSnippet?b.toString():b instanceof a.ui.Element?b.$element:b})),b.$content&&this.$element.append(b.$content)},a.initClass(a.ui.Element),a.ui.Element["static"].tagName="div",a.ui.Element["static"].infuse=function(b){var c=a.ui.Element["static"].unsafeInfuse(b,!1);return c},a.ui.Element["static"].unsafeInfuse=function(b,c){var d,e,f,g,h,i,j,k,l;if("string"==typeof b?(d=b,e=$(document.getElementById(d))):(e=$(b),d=e.attr("id")),!e.length)throw new Error("Widget not found: "+d);if(f=e.data("ooui-infused")||e[0].oouiInfused){if(f===!0)throw new Error("Circular dependency! "+d);return f}if(f=e.attr("data-ooui"),!f)throw new Error("No infusion data found: "+d);try{f=$.parseJSON(f)}catch(m){f=null}if(!f||!f._)throw new Error("No valid infusion data found: "+d);if("Tag"===f._)return new a.ui.Element({$element:e});if(h=f._.split("."),g=a.getProp.apply(a,[window].concat(h)),void 0===g&&(g=a.getProp.apply(a,[a.ui].concat(h)),void 0===g))throw new Error("Unknown widget type: id: "+d+", class: "+f._);for(i=g.parent;void 0!==i&&i!==a.ui.Element;)i=i.parent;if(i!==a.ui.Element)throw new Error("Unknown widget type: id: "+d+", class: "+f._);return c===!1&&(k=$.Deferred(),c=k.promise()),e.data("ooui-infused",!0),f.id=d,f=a.copy(f,null,function(b){if(a.isPlainObject(b)){if(b.tag)return a.ui.Element["static"].unsafeInfuse(b.tag,c);if(b.html)return new a.ui.HtmlSnippet(b.html)}}),f=g["static"].reusePreInfuseDOM(e[0],f),l=g["static"].gatherPreInfuseState(e[0],f),j=new g(f),k&&(e[0]!==j.$element[0]&&(e.replaceWith(j.$element),e[0].oouiInfused=j),k.resolve()),j.$element.data("ooui-infused",j),j.$element.attr("data-ooui",""),c.done(j.restorePreInfuseState.bind(j,l)),j},a.ui.Element["static"].reusePreInfuseDOM=function(a,b){return b},a.ui.Element["static"].gatherPreInfuseState=function(){return{}},a.ui.Element["static"].getJQuery=function(a,b){function c(a){return $(a,c.context)}return c.context=this.getDocument(a),b&&(c.$iframe=b),c},a.ui.Element["static"].getDocument=function(a){return a[0]&&a[0].ownerDocument||a.context||a.ownerDocument||a.document||9===a.nodeType&&a||null},a.ui.Element["static"].getWindow=function(a){var b=this.getDocument(a);return b.parentWindow||b.defaultView},a.ui.Element["static"].getDir=function(a){var b,c;return a instanceof jQuery&&(a=a[0]),b=9===a.nodeType,c=void 0!==a.document,(b||c)&&(c&&(a=a.document),a=a.body),$(a).css("direction")},a.ui.Element["static"].getFrameOffset=function(a,b,c){var d,e,f,g,h;if(b||(b=window),c||(c={top:0,left:0}),a.parent===a)return c;for(f=a.parent.document.getElementsByTagName("iframe"),d=0,e=f.length;e>d;d++)if(f[d].contentWindow===a){g=f[d];break}return g&&(h=g.getBoundingClientRect(),c.left+=h.left,c.top+=h.top,a!==b&&this.getFrameOffset(a.parent,c)),c},a.ui.Element["static"].getRelativePosition=function(a,b){for(var c,d,e=a.offset(),f=b.offset(),g=this.getDocument(a),h=this.getDocument(b);g!==h;){if(c=g.defaultView.frameElement,!c)throw new Error("$element frame is not contained in $anchor frame");d=$(c).offset(),e.left+=d.left,e.top+=d.top,g=c.ownerDocument}return e.left-=f.left,e.top-=f.top,e},a.ui.Element["static"].getBorders=function(a){var b=a.ownerDocument,c=b.parentWindow||b.defaultView,d=c&&c.getComputedStyle?c.getComputedStyle(a,null):a.currentStyle,e=$(a),f=parseFloat(d?d.borderTopWidth:e.css("borderTopWidth"))||0,g=parseFloat(d?d.borderLeftWidth:e.css("borderLeftWidth"))||0,h=parseFloat(d?d.borderBottomWidth:e.css("borderBottomWidth"))||0,i=parseFloat(d?d.borderRightWidth:e.css("borderRightWidth"))||0;return{top:f,left:g,bottom:h,right:i}},a.ui.Element["static"].getDimensions=function(a){var b,c,d=a.ownerDocument||a.document,e=d.parentWindow||d.defaultView;return e===a||a===d.documentElement?(c=$(e),{borders:{top:0,left:0,bottom:0,right:0},scroll:{top:c.scrollTop(),left:c.scrollLeft()},scrollbar:{right:0,bottom:0},rect:{top:0,left:0,bottom:c.innerHeight(),right:c.innerWidth()}}):(b=$(a),{borders:this.getBorders(a),scroll:{top:b.scrollTop(),left:b.scrollLeft()},scrollbar:{right:b.innerWidth()-a.clientWidth,bottom:b.innerHeight()-a.clientHeight},rect:a.getBoundingClientRect()})},a.ui.Element["static"].getRootScrollableElement=function(b){var c,d;return void 0===a.ui.scrollableElement&&(d=b.ownerDocument.body,c=d.scrollTop,d.scrollTop=1,1===d.scrollTop?(d.scrollTop=c,a.ui.scrollableElement="body"):a.ui.scrollableElement="documentElement"),b.ownerDocument[a.ui.scrollableElement]},a.ui.Element["static"].getClosestScrollableContainer=function(a,b){var c,d,e=["overflow-x","overflow-y"],f=$(a).parent();for(("x"===b||"y"===b)&&(e=["overflow-"+b]);f.length;){if(f[0]===this.getRootScrollableElement(a))return f[0];for(c=e.length;c--;)if(d=f.css(e[c]),"auto"===d||"scroll"===d)return f[0];f=f.parent()}return this.getDocument(a).body},a.ui.Element["static"].scrollIntoView=function(a,b){var c,d,e,f,g,h,i,j;b=b||{},d={},e="function"==typeof b.complete&&b.complete,f=this.getClosestScrollableContainer(a,b.direction),g=$(f),h=this.getDimensions(a),i=this.getDimensions(f),j=$(this.getWindow(a)),c=g.is("html, body")?{top:h.rect.top,bottom:j.innerHeight()-h.rect.bottom,left:h.rect.left,right:j.innerWidth()-h.rect.right}:{top:h.rect.top-(i.rect.top+i.borders.top),bottom:i.rect.bottom-i.borders.bottom-i.scrollbar.bottom-h.rect.bottom,left:h.rect.left-(i.rect.left+i.borders.left),right:i.rect.right-i.borders.right-i.scrollbar.right-h.rect.right},b.direction&&"y"!==b.direction||(c.top<0?d.scrollTop=i.scroll.top+c.top:c.top>0&&c.bottom<0&&(d.scrollTop=i.scroll.top+Math.min(c.top,-c.bottom))),b.direction&&"x"!==b.direction||(c.left<0?d.scrollLeft=i.scroll.left+c.left:c.left>0&&c.right<0&&(d.scrollLeft=i.scroll.left+Math.min(c.left,-c.right))),$.isEmptyObject(d)?e&&e():(g.stop(!0).animate(d,b.duration||"fast"),e&&g.queue(function(a){e(),a()}))},a.ui.Element["static"].reconsiderScrollbars=function(a){var b,c,d,e,f=[];for(d=a.scrollLeft,e=a.scrollTop;a.firstChild;)f.push(a.firstChild),a.removeChild(a.firstChild);for(void a.offsetHeight,b=0,c=f.length;c>b;b++)a.appendChild(f[b]);a.scrollLeft=d,a.scrollTop=e},a.ui.Element.prototype.toggle=function(a){return a=void 0===a?!this.visible:!!a,a!==this.isVisible()&&(this.visible=a,this.$element.toggleClass("oo-ui-element-hidden",!this.visible),this.emit("toggle",a)),this},a.ui.Element.prototype.isVisible=function(){return this.visible},a.ui.Element.prototype.getData=function(){return this.data},a.ui.Element.prototype.setData=function(a){return this.data=a,this},a.ui.Element.prototype.supports=function(a){var b,c,d=0;for(a=Array.isArray(a)?a:[a],b=0,c=a.length;c>b;b++)$.isFunction(this[a[b]])&&d++;return a.length===d},a.ui.Element.prototype.updateThemeClasses=function(){this.debouncedUpdateThemeClassesHandler()},a.ui.Element.prototype.debouncedUpdateThemeClasses=function(){a.ui.theme.updateElementClasses(this)},a.ui.Element.prototype.getTagName=function(){return this.constructor["static"].tagName},a.ui.Element.prototype.isElementAttached=function(){return $.contains(this.getElementDocument(),this.$element[0])},a.ui.Element.prototype.getElementDocument=function(){return a.ui.Element["static"].getDocument(this.$element)},a.ui.Element.prototype.getElementWindow=function(){return a.ui.Element["static"].getWindow(this.$element)},a.ui.Element.prototype.getClosestScrollableElementContainer=function(){return a.ui.Element["static"].getClosestScrollableContainer(this.$element[0])},a.ui.Element.prototype.getElementGroup=function(){return this.elementGroup},a.ui.Element.prototype.setElementGroup=function(a){return this.elementGroup=a,this},a.ui.Element.prototype.scrollElementIntoView=function(b){return a.ui.Element["static"].scrollIntoView(this.$element[0],b)},a.ui.Element.prototype.restorePreInfuseState=function(){},a.ui.Layout=function(b){b=b||{},a.ui.Layout.parent.call(this,b),a.EventEmitter.call(this),this.$element.addClass("oo-ui-layout")},a.inheritClass(a.ui.Layout,a.ui.Element),a.mixinClass(a.ui.Layout,a.EventEmitter),a.ui.Widget=function(b){b=$.extend({disabled:!1},b),a.ui.Widget.parent.call(this,b),a.EventEmitter.call(this),this.disabled=null,this.wasDisabled=null,this.$element.addClass("oo-ui-widget"),this.setDisabled(!!b.disabled)},a.inheritClass(a.ui.Widget,a.ui.Element),a.mixinClass(a.ui.Widget,a.EventEmitter),a.ui.Widget["static"].supportsSimpleLabel=!1,a.ui.Widget.prototype.isDisabled=function(){return this.disabled},a.ui.Widget.prototype.setDisabled=function(a){var b;return this.disabled=!!a,b=this.isDisabled(),b!==this.wasDisabled&&(this.$element.toggleClass("oo-ui-widget-disabled",b),this.$element.toggleClass("oo-ui-widget-enabled",!b),this.$element.attr("aria-disabled",b.toString()),this.emit("disable",b),this.updateThemeClasses()),this.wasDisabled=b,this},a.ui.Widget.prototype.updateDisabled=function(){return this.setDisabled(this.disabled),this},a.ui.Window=function(b){b=b||{},a.ui.Window.parent.call(this,b),a.EventEmitter.call(this),this.manager=null,this.size=b.size||this.constructor["static"].size,this.$frame=$("<div>"),this.$overlay=$("<div>"),this.$content=$("<div>"),this.$focusTrapBefore=$("<div>").prop("tabIndex",0),this.$focusTrapAfter=$("<div>").prop("tabIndex",0),this.$focusTraps=this.$focusTrapBefore.add(this.$focusTrapAfter),this.$overlay.addClass("oo-ui-window-overlay"),this.$content.addClass("oo-ui-window-content").attr("tabindex",0),this.$frame.addClass("oo-ui-window-frame").append(this.$focusTrapBefore,this.$content,this.$focusTrapAfter),this.$element.addClass("oo-ui-window").append(this.$frame,this.$overlay),this.visible=!1,this.$element.addClass("oo-ui-element-hidden")},a.inheritClass(a.ui.Window,a.ui.Element),a.mixinClass(a.ui.Window,a.EventEmitter),a.ui.Window["static"].size="medium",a.ui.Window.prototype.onMouseDown=function(a){return a.target===this.$element[0]?!1:void 0},a.ui.Window.prototype.isInitialized=function(){return!!this.manager},a.ui.Window.prototype.isVisible=function(){return this.visible},a.ui.Window.prototype.isOpening=function(){return this.manager.isOpening(this)},a.ui.Window.prototype.isClosing=function(){return this.manager.isClosing(this)},a.ui.Window.prototype.isOpened=function(){return this.manager.isOpened(this)},a.ui.Window.prototype.getManager=function(){return this.manager},a.ui.Window.prototype.getSize=function(){var b=a.ui.Element["static"].getDimensions(this.getElementWindow()),c=this.manager.constructor["static"].sizes,d=this.size;return c[d]||(d=this.manager.constructor["static"].defaultSize),"full"!==d&&b.rect.right-b.rect.left<c[d].width&&(d="full"),d},a.ui.Window.prototype.getSizeProperties=function(){return this.manager.constructor["static"].sizes[this.getSize()]},a.ui.Window.prototype.withoutSizeTransitions=function(a){var b,c=this.$frame[0].style;b=c.transition||c.OTransition||c.MsTransition||c.MozTransition||c.WebkitTransition,c.transition=c.OTransition=c.MsTransition=c.MozTransition=c.WebkitTransition="none",a(),this.$frame.height(),c.transition=c.OTransition=c.MsTransition=c.MozTransition=c.WebkitTransition=b},a.ui.Window.prototype.getContentHeight=function(){var a,b=this,c=this.$body[0].style,d=this.$frame[0].style;return this.withoutSizeTransitions(function(){var e=d.height,f=c.position;d.height="1px",c.position="relative",a=b.getBodyHeight(),d.height=e,c.position=f}),this.$frame.outerHeight()-this.$frame.innerHeight()+(this.$head.outerHeight(!0)+a+this.$foot.outerHeight(!0))},a.ui.Window.prototype.getBodyHeight=function(){return this.$body[0].scrollHeight},a.ui.Window.prototype.getDir=function(){return a.ui.Element["static"].getDir(this.$content)||"ltr"},a.ui.Window.prototype.getSetupProcess=function(){return new a.ui.Process},a.ui.Window.prototype.getReadyProcess=function(){return new a.ui.Process},a.ui.Window.prototype.getHoldProcess=function(){return new a.ui.Process},a.ui.Window.prototype.getTeardownProcess=function(){return new a.ui.Process},a.ui.Window.prototype.setManager=function(a){if(this.manager)throw new Error("Cannot set window manager, window already has a manager");return this.manager=a,this.initialize(),this},a.ui.Window.prototype.setSize=function(a){return this.size=a,this.updateSize(),this},a.ui.Window.prototype.updateSize=function(){if(!this.manager)throw new Error("Cannot update window size, must be attached to a manager");return this.manager.updateWindowSize(this),this},a.ui.Window.prototype.setDimensions=function(a){var b,c=this,d=this.$frame[0].style;return void 0===a.height?this.withoutSizeTransitions(function(){var e=d.width;c.$frame.css("width",a.width||""),b=c.getContentHeight(),d.width=e}):b=a.height,this.$frame.css({width:a.width||"",minWidth:a.minWidth||"",maxWidth:a.maxWidth||"",height:b||"",minHeight:a.minHeight||"",maxHeight:a.maxHeight||""}),this},a.ui.Window.prototype.initialize=function(){if(!this.manager)throw new Error("Cannot initialize window, must be attached to a manager");return this.$head=$("<div>"),this.$body=$("<div>"),this.$foot=$("<div>"),this.$document=$(this.getElementDocument()),this.$element.on("mousedown",this.onMouseDown.bind(this)),this.$head.addClass("oo-ui-window-head"),this.$body.addClass("oo-ui-window-body"),this.$foot.addClass("oo-ui-window-foot"),this.$content.append(this.$head,this.$body,this.$foot),this},a.ui.Window.prototype.onFocusTrapFocused=function(b){this.$focusTrapBefore.is(b.target)?a.ui.findFocusable(this.$content,!0).focus():this.$content.focus()},a.ui.Window.prototype.open=function(a){if(!this.manager)throw new Error("Cannot open window, must be attached to a manager");return this.manager.openWindow(this,a)},a.ui.Window.prototype.close=function(a){if(!this.manager)throw new Error("Cannot close window, must be attached to a manager");return this.manager.closeWindow(this,a)},a.ui.Window.prototype.setup=function(b){var c=this;return this.toggle(!0),this.focusTrapHandler=a.ui.bind(this.onFocusTrapFocused,this),this.$focusTraps.on("focus",this.focusTrapHandler),this.getSetupProcess(b).execute().then(function(){c.$element.addClass("oo-ui-window-active oo-ui-window-setup").width(),c.$content.addClass("oo-ui-window-content-setup").width()})},a.ui.Window.prototype.ready=function(a){var b=this;return this.$content.focus(),this.getReadyProcess(a).execute().then(function(){b.$element.addClass("oo-ui-window-ready").width(),b.$content.addClass("oo-ui-window-content-ready").width()})},a.ui.Window.prototype.hold=function(b){var c=this;return this.getHoldProcess(b).execute().then(function(){var b=c.$content.find(a.ui.Element["static"].getDocument(c.$content).activeElement);b.length&&b[0].blur(),c.$element.removeClass("oo-ui-window-ready").width(),c.$content.removeClass("oo-ui-window-content-ready").width()})},a.ui.Window.prototype.teardown=function(a){var b=this;return this.getTeardownProcess(a).execute().then(function(){b.$element.removeClass("oo-ui-window-active oo-ui-window-setup").width(),b.$content.removeClass("oo-ui-window-content-setup").width(),b.$focusTraps.off("focus",b.focusTrapHandler),b.toggle(!1)})},a.ui.Dialog=function(b){a.ui.Dialog.parent.call(this,b),a.ui.mixin.PendingElement.call(this),this.actions=new a.ui.ActionSet,this.attachedActions=[],this.currentAction=null,this.onDialogKeyDownHandler=this.onDialogKeyDown.bind(this),this.actions.connect(this,{click:"onActionClick",resize:"onActionResize",change:"onActionsChange"}),this.$element.addClass("oo-ui-dialog").attr("role","dialog")},a.inheritClass(a.ui.Dialog,a.ui.Window),a.mixinClass(a.ui.Dialog,a.ui.mixin.PendingElement),a.ui.Dialog["static"].name="",a.ui.Dialog["static"].title="",a.ui.Dialog["static"].actions=[],a.ui.Dialog["static"].escapable=!0,a.ui.Dialog.prototype.onDialogKeyDown=function(b){b.which===a.ui.Keys.ESCAPE&&(this.close(),b.preventDefault(),b.stopPropagation())},a.ui.Dialog.prototype.onActionResize=function(){},a.ui.Dialog.prototype.onActionClick=function(a){this.isPending()||this.executeAction(a.getAction())},a.ui.Dialog.prototype.onActionsChange=function(){this.detachActions(),this.isClosing()||this.attachActions()},a.ui.Dialog.prototype.getActions=function(){return this.actions},a.ui.Dialog.prototype.getActionProcess=function(b){return(new a.ui.Process).next(function(){b||this.close()},this)},a.ui.Dialog.prototype.getSetupProcess=function(b){return b=b||{},a.ui.Dialog.parent.prototype.getSetupProcess.call(this,b).next(function(){var a=this.constructor["static"],c=void 0!==b.actions?b.actions:a.actions;this.title.setLabel(void 0!==b.title?b.title:this.constructor["static"].title),this.actions.add(this.getActionWidgets(c)),this.constructor["static"].escapable&&this.$element.on("keydown",this.onDialogKeyDownHandler)},this)},a.ui.Dialog.prototype.getTeardownProcess=function(b){return a.ui.Dialog.parent.prototype.getTeardownProcess.call(this,b).first(function(){this.constructor["static"].escapable&&this.$element.off("keydown",this.onDialogKeyDownHandler),this.actions.clear(),this.currentAction=null},this)},a.ui.Dialog.prototype.initialize=function(){var b;a.ui.Dialog.parent.prototype.initialize.call(this),b=a.ui.generateElementId(),this.title=new a.ui.LabelWidget({id:b}),this.$content.addClass("oo-ui-dialog-content"),this.$element.attr("aria-labelledby",b),this.setPendingElement(this.$head)},a.ui.Dialog.prototype.getActionWidgets=function(b){var c,d,e=[];for(c=0,d=b.length;d>c;c++)e.push(new a.ui.ActionWidget(b[c]));return e},a.ui.Dialog.prototype.attachActions=function(){this.attachedActions=this.actions.get()},a.ui.Dialog.prototype.detachActions=function(){var a,b;for(a=0,b=this.attachedActions.length;b>a;a++)this.attachedActions[a].$element.detach();this.attachedActions=[]},a.ui.Dialog.prototype.executeAction=function(a){return this.pushPending(),this.currentAction=a,this.getActionProcess(a).execute().always(this.popPending.bind(this))},a.ui.WindowManager=function(b){b=b||{},a.ui.WindowManager.parent.call(this,b),a.EventEmitter.call(this),this.factory=b.factory,this.modal=void 0===b.modal||!!b.modal,this.windows={},this.opening=null,this.opened=null,this.closing=null,this.preparingToOpen=null,this.preparingToClose=null,this.currentWindow=null,this.globalEvents=!1,this.$ariaHidden=null,this.onWindowResizeTimeout=null,this.onWindowResizeHandler=this.onWindowResize.bind(this),this.afterWindowResizeHandler=this.afterWindowResize.bind(this),this.$element.addClass("oo-ui-windowManager").toggleClass("oo-ui-windowManager-modal",this.modal)},a.inheritClass(a.ui.WindowManager,a.ui.Element),a.mixinClass(a.ui.WindowManager,a.EventEmitter),a.ui.WindowManager["static"].sizes={small:{width:300},medium:{width:500},large:{width:700},larger:{width:900},full:{width:"100%",height:"100%"}},a.ui.WindowManager["static"].defaultSize="medium",a.ui.WindowManager.prototype.onWindowResize=function(){clearTimeout(this.onWindowResizeTimeout),this.onWindowResizeTimeout=setTimeout(this.afterWindowResizeHandler,200)},a.ui.WindowManager.prototype.afterWindowResize=function(){this.currentWindow&&this.updateWindowSize(this.currentWindow)},a.ui.WindowManager.prototype.isOpening=function(a){return a===this.currentWindow&&!!this.opening&&"pending"===this.opening.state()},a.ui.WindowManager.prototype.isClosing=function(a){return a===this.currentWindow&&!!this.closing&&"pending"===this.closing.state()},a.ui.WindowManager.prototype.isOpened=function(a){return a===this.currentWindow&&!!this.opened&&"pending"===this.opened.state()},a.ui.WindowManager.prototype.hasWindow=function(a){var b;for(b in this.windows)if(this.windows[b]===a)return!0;return!1},a.ui.WindowManager.prototype.getSetupDelay=function(){return 0},a.ui.WindowManager.prototype.getReadyDelay=function(){return 0},a.ui.WindowManager.prototype.getHoldDelay=function(){return 0},a.ui.WindowManager.prototype.getTeardownDelay=function(){return this.modal?250:0},a.ui.WindowManager.prototype.getWindow=function(b){var c=$.Deferred(),d=this.windows[b];return d instanceof a.ui.Window?c.resolve(d):this.factory?this.factory.lookup(b)?(d=this.factory.create(b),this.addWindows([d]),c.resolve(d)):c.reject(new a.ui.Error("Cannot auto-instantiate window: symbolic name is unrecognized by the factory")):c.reject(new a.ui.Error("Cannot get unmanaged window: symbolic name unrecognized as a managed window")),c.promise()},a.ui.WindowManager.prototype.getCurrentWindow=function(){return this.currentWindow},a.ui.WindowManager.prototype.openWindow=function(b,c){var d=this,e=$.Deferred();return"string"==typeof b?this.getWindow(b).then(function(a){return d.openWindow(a,c)}):(this.hasWindow(b)?(this.preparingToOpen||this.opening||this.opened)&&e.reject(new a.ui.Error("Cannot open window: another window is opening or open")):e.reject(new a.ui.Error("Cannot open window: window is not attached to manager")),"rejected"!==e.state()&&(this.preparingToOpen=$.when(this.closing),this.preparingToOpen.done(function(){d.modal&&(d.toggleGlobalEvents(!0),d.toggleAriaIsolation(!0)),d.currentWindow=b,d.opening=e,d.preparingToOpen=null,d.emit("opening",b,e,c),setTimeout(function(){b.setup(c).then(function(){d.updateWindowSize(b),d.opening.notify({state:"setup"}),setTimeout(function(){b.ready(c).then(function(){d.opening.notify({state:"ready"}),d.opening=null,d.opened=$.Deferred(),e.resolve(d.opened.promise(),c)},function(){d.opening=null,d.opened=$.Deferred(),e.reject(),d.closeWindow(b)})},d.getReadyDelay())},function(){d.opening=null,d.opened=$.Deferred(),e.reject(),d.closeWindow(b)})},d.getSetupDelay())})),e.promise())},a.ui.WindowManager.prototype.closeWindow=function(b,c){var d,e=this,f=$.Deferred();return"string"==typeof b?b=this.windows[b]:this.hasWindow(b)||(b=null),b?b!==this.currentWindow?f.reject(new a.ui.Error("Cannot close window: window already closed with different data")):(this.preparingToClose||this.closing)&&f.reject(new a.ui.Error("Cannot close window: window already closing with different data")):f.reject(new a.ui.Error("Cannot close window: window is not attached to manager")),"rejected"!==f.state()&&(this.preparingToClose=$.when(this.opening),this.preparingToClose.always(function(){e.closing=f,e.preparingToClose=null,e.emit("closing",b,f,c),d=e.opened,e.opened=null,d.resolve(f.promise(),c),setTimeout(function(){b.hold(c).then(function(){f.notify({state:"hold"}),setTimeout(function(){b.teardown(c).then(function(){f.notify({state:"teardown"}),e.modal&&(e.toggleGlobalEvents(!1),e.toggleAriaIsolation(!1)),e.closing=null,e.currentWindow=null,f.resolve(c)})},e.getTeardownDelay())})},e.getHoldDelay())})),f.promise()},a.ui.WindowManager.prototype.addWindows=function(b){var c,d,e,f,g;if(Array.isArray(b))for(g={},c=0,d=b.length;d>c;c++){if(f=b[c].constructor["static"].name,"string"!=typeof f)throw new Error("Cannot add window");g[f]=b[c]}else a.isPlainObject(b)&&(g=b);for(f in g)e=g[f],this.windows[f]=e.toggle(!1),this.$element.append(e.$element),e.setManager(this)},a.ui.WindowManager.prototype.removeWindows=function(a){var b,c,d,e,f,g=this,h=[],i=function(a,b){delete g.windows[a],b.$element.detach()};for(b=0,c=a.length;c>b;b++){if(e=a[b],d=this.windows[e],!d)throw new Error("Cannot remove window");f=i.bind(null,e,d),h.push(this.closeWindow(e).then(f,f))}return $.when.apply($,h)},a.ui.WindowManager.prototype.clearWindows=function(){return this.removeWindows(Object.keys(this.windows))},a.ui.WindowManager.prototype.updateWindowSize=function(a){var b;if(a===this.currentWindow)return b="full"===a.getSize(),this.$element.toggleClass("oo-ui-windowManager-fullscreen",b),this.$element.toggleClass("oo-ui-windowManager-floating",!b),a.setDimensions(a.getSizeProperties()),this.emit("resize",a),this},a.ui.WindowManager.prototype.toggleGlobalEvents=function(a){var b,c,d=$(this.getElementDocument().body),e=d.data("windowManagerGlobalEvents")||0;return a=void 0===a?!!this.globalEvents:!!a,a?this.globalEvents||($(this.getElementWindow()).on({"orientationchange resize":this.onWindowResizeHandler}),0===e&&(b=window.innerWidth-document.documentElement.clientWidth,c=parseFloat(d.css("margin-right"))||0,d.css({overflow:"hidden","margin-right":c+b})),e++,this.globalEvents=!0):this.globalEvents&&($(this.getElementWindow()).off({"orientationchange resize":this.onWindowResizeHandler
}),e--,0===e&&d.css({overflow:"","margin-right":""}),this.globalEvents=!1),d.data("windowManagerGlobalEvents",e),this},a.ui.WindowManager.prototype.toggleAriaIsolation=function(a){return a=void 0===a?!this.$ariaHidden:!!a,a?this.$ariaHidden||(this.$ariaHidden=$("body").children().not(this.$element.parentsUntil("body").last()).attr("aria-hidden","")):this.$ariaHidden&&(this.$ariaHidden.removeAttr("aria-hidden"),this.$ariaHidden=null),this},a.ui.WindowManager.prototype.destroy=function(){this.toggleGlobalEvents(!1),this.toggleAriaIsolation(!1),this.clearWindows(),this.$element.remove()},a.ui.Error=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.message),c=c||{},this.message=b instanceof jQuery?b:String(b),this.recoverable=void 0===c.recoverable||!!c.recoverable,this.warning=!!c.warning},a.initClass(a.ui.Error),a.ui.Error.prototype.isRecoverable=function(){return this.recoverable},a.ui.Error.prototype.isWarning=function(){return this.warning},a.ui.Error.prototype.getMessage=function(){return this.message instanceof jQuery?this.message.clone():$("<div>").text(this.message).contents()},a.ui.Error.prototype.getMessageText=function(){return this.message instanceof jQuery?this.message.text():this.message},a.ui.HtmlSnippet=function(a){this.content=a},a.initClass(a.ui.HtmlSnippet),a.ui.HtmlSnippet.prototype.toString=function(){return this.content},a.ui.Process=function(a,b){this.steps=[],void 0!==a&&this.next(a,b)},a.initClass(a.ui.Process),a.ui.Process.prototype.execute=function(){function b(b){return function(){var c,d=b.callback.call(b.context);if(d===!1)return $.Deferred().reject([]).promise();if("number"==typeof d){if(0>d)throw new Error("Cannot go back in time: flux capacitor is out of service");return c=$.Deferred(),setTimeout(c.resolve,d),c.promise()}return d instanceof a.ui.Error?$.Deferred().reject([d]).promise():Array.isArray(d)&&d.length&&d[0]instanceof a.ui.Error?$.Deferred().reject(d).promise():d&&$.isFunction(d.promise)?d.promise():$.Deferred().resolve().promise()}}var c,d,e;if(this.steps.length)for(e=b(this.steps[0])(),c=1,d=this.steps.length;d>c;c++)e=e.then(b(this.steps[c]));else e=$.Deferred().resolve().promise();return e},a.ui.Process.prototype.createStep=function(a,b){if("number"==typeof a||$.isFunction(a.promise))return{callback:function(){return a},context:null};if($.isFunction(a))return{callback:a,context:b};throw new Error("Cannot create process step: number, promise or function expected")},a.ui.Process.prototype.first=function(a,b){return this.steps.unshift(this.createStep(a,b)),this},a.ui.Process.prototype.next=function(a,b){return this.steps.push(this.createStep(a,b)),this},a.ui.ToolFactory=function(){a.ui.ToolFactory.parent.call(this)},a.inheritClass(a.ui.ToolFactory,a.Factory),a.ui.ToolFactory.prototype.getTools=function(b,c,d,e){var f,g,h,i,j,k=[],l={};for(h=a.simpleArrayDifference(this.extract(b),this.extract(c)),i=this.extract(d,l),j=this.extract(e,l),f=0,g=h.length;g>f;f++)l[h[f]]||k.push(h[f]);return i.concat(k).concat(j)},a.ui.ToolFactory.prototype.extract=function(b,c){var d,e,f,g,h,i=[];if("*"===b)for(g in this.registry)h=this.registry[g],!h["static"].autoAddToCatchall||c&&c[g]||(i.push(g),c&&(c[g]=!0));else if(Array.isArray(b))for(d=0,e=b.length;e>d;d++)if(f=b[d],"string"==typeof f&&(f={name:f}),a.isPlainObject(f))if(f.group)for(g in this.registry)h=this.registry[g],h["static"].group!==f.group||!h["static"].autoAddToGroup||c&&c[g]||(i.push(g),c&&(c[g]=!0));else!f.name||c&&c[f.name]||(i.push(f.name),c&&(c[f.name]=!0));return i},a.ui.ToolGroupFactory=function(){var b,c,d;for(a.Factory.call(this),d=this.constructor["static"].getDefaultClasses(),b=0,c=d.length;c>b;b++)this.register(d[b])},a.inheritClass(a.ui.ToolGroupFactory,a.Factory),a.ui.ToolGroupFactory["static"].getDefaultClasses=function(){return[a.ui.BarToolGroup,a.ui.ListToolGroup,a.ui.MenuToolGroup]},a.ui.Theme=function(a){a=a||{}},a.initClass(a.ui.Theme),a.ui.Theme.prototype.getElementClasses=function(){return{on:[],off:[]}},a.ui.Theme.prototype.updateElementClasses=function(a){var b=$([]),c=this.getElementClasses(a);a.$icon&&(b=b.add(a.$icon)),a.$indicator&&(b=b.add(a.$indicator)),b.removeClass(c.off.join(" ")).addClass(c.on.join(" "))},a.ui.mixin.RequestManager=function(){this.requestCache={},this.requestQuery=null,this.requestRequest=null},a.initClass(a.ui.mixin.RequestManager),a.ui.mixin.RequestManager.prototype.getRequestData=function(){var a,b=this,c=this.getRequestQuery(),d=$.Deferred();return this.abortRequest(),Object.prototype.hasOwnProperty.call(this.requestCache,c)?d.resolve(this.requestCache[c]):(this.pushPending&&this.pushPending(),this.requestQuery=c,a=this.requestRequest=this.getRequest(),a.always(function(){b.popPending&&b.popPending()}).done(function(e){a===b.requestRequest&&(b.requestQuery=null,b.requestRequest=null,b.requestCache[c]=b.getRequestCacheDataFromResponse(e),d.resolve(b.requestCache[c]))}).fail(function(){a===b.requestRequest&&(b.requestQuery=null,b.requestRequest=null,d.reject())})),d.promise()},a.ui.mixin.RequestManager.prototype.abortRequest=function(){var a=this.requestRequest;a&&(this.requestRequest=null,this.requestQuery=null,a.abort())},a.ui.mixin.RequestManager.prototype.getRequestQuery=null,a.ui.mixin.RequestManager.prototype.getRequest=null,a.ui.mixin.RequestManager.prototype.getRequestCacheDataFromResponse=null,a.ui.mixin.TabIndexedElement=function(a){a=$.extend({tabIndex:0},a),this.$tabIndexed=null,this.tabIndex=null,this.connect(this,{disable:"onTabIndexedElementDisable"}),this.setTabIndex(a.tabIndex),this.setTabIndexedElement(a.$tabIndexed||this.$element)},a.initClass(a.ui.mixin.TabIndexedElement),a.ui.mixin.TabIndexedElement.prototype.setTabIndexedElement=function(a){var b=this.tabIndex;return this.setTabIndex(null),this.$tabIndexed=a,this.tabIndex=b,this.updateTabIndex()},a.ui.mixin.TabIndexedElement.prototype.setTabIndex=function(a){return a="number"==typeof a?a:null,this.tabIndex!==a&&(this.tabIndex=a,this.updateTabIndex()),this},a.ui.mixin.TabIndexedElement.prototype.updateTabIndex=function(){return this.$tabIndexed&&(null!==this.tabIndex?this.$tabIndexed.attr({tabindex:this.isDisabled()?-1:this.tabIndex,"aria-disabled":this.isDisabled().toString()}):this.$tabIndexed.removeAttr("tabindex aria-disabled")),this},a.ui.mixin.TabIndexedElement.prototype.onTabIndexedElementDisable=function(){this.updateTabIndex()},a.ui.mixin.TabIndexedElement.prototype.getTabIndex=function(){return this.tabIndex},a.ui.mixin.ButtonElement=function(a){a=a||{},this.$button=null,this.framed=null,this.active=!1,this.onMouseUpHandler=this.onMouseUp.bind(this),this.onMouseDownHandler=this.onMouseDown.bind(this),this.onKeyDownHandler=this.onKeyDown.bind(this),this.onKeyUpHandler=this.onKeyUp.bind(this),this.onClickHandler=this.onClick.bind(this),this.onKeyPressHandler=this.onKeyPress.bind(this),this.$element.addClass("oo-ui-buttonElement"),this.toggleFramed(void 0===a.framed||a.framed),this.setButtonElement(a.$button||$("<a>"))},a.initClass(a.ui.mixin.ButtonElement),a.ui.mixin.ButtonElement["static"].cancelButtonMouseDownEvents=!0,a.ui.mixin.ButtonElement.prototype.setButtonElement=function(a){this.$button&&this.$button.removeClass("oo-ui-buttonElement-button").removeAttr("role accesskey").off({mousedown:this.onMouseDownHandler,keydown:this.onKeyDownHandler,click:this.onClickHandler,keypress:this.onKeyPressHandler}),this.$button=a.addClass("oo-ui-buttonElement-button").attr({role:"button"}).on({mousedown:this.onMouseDownHandler,keydown:this.onKeyDownHandler,click:this.onClickHandler,keypress:this.onKeyPressHandler})},a.ui.mixin.ButtonElement.prototype.onMouseDown=function(b){return this.isDisabled()||1!==b.which?void 0:(this.$element.addClass("oo-ui-buttonElement-pressed"),a.ui.addCaptureEventListener(this.getElementDocument(),"mouseup",this.onMouseUpHandler),this.constructor["static"].cancelButtonMouseDownEvents?!1:void 0)},a.ui.mixin.ButtonElement.prototype.onMouseUp=function(b){this.isDisabled()||1!==b.which||(this.$element.removeClass("oo-ui-buttonElement-pressed"),a.ui.removeCaptureEventListener(this.getElementDocument(),"mouseup",this.onMouseUpHandler))},a.ui.mixin.ButtonElement.prototype.onClick=function(a){return!this.isDisabled()&&1===a.which&&this.emit("click")?!1:void 0},a.ui.mixin.ButtonElement.prototype.onKeyDown=function(b){this.isDisabled()||b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER||(this.$element.addClass("oo-ui-buttonElement-pressed"),a.ui.addCaptureEventListener(this.getElementDocument(),"keyup",this.onKeyUpHandler))},a.ui.mixin.ButtonElement.prototype.onKeyUp=function(b){this.isDisabled()||b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER||(this.$element.removeClass("oo-ui-buttonElement-pressed"),a.ui.removeCaptureEventListener(this.getElementDocument(),"keyup",this.onKeyUpHandler))},a.ui.mixin.ButtonElement.prototype.onKeyPress=function(b){return this.isDisabled()||b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER||!this.emit("click")?void 0:!1},a.ui.mixin.ButtonElement.prototype.isFramed=function(){return this.framed},a.ui.mixin.ButtonElement.prototype.toggleFramed=function(a){return a=void 0===a?!this.framed:!!a,a!==this.framed&&(this.framed=a,this.$element.toggleClass("oo-ui-buttonElement-frameless",!a).toggleClass("oo-ui-buttonElement-framed",a),this.updateThemeClasses()),this},a.ui.mixin.ButtonElement.prototype.setActive=function(a){return this.active=!!a,this.$element.toggleClass("oo-ui-buttonElement-active",this.active),this},a.ui.mixin.ButtonElement.prototype.isActive=function(){return this.active},a.ui.mixin.GroupElement=function(a){a=a||{},this.$group=null,this.items=[],this.aggregateItemEvents={},this.setGroupElement(a.$group||$("<div>"))},a.ui.mixin.GroupElement.prototype.setGroupElement=function(a){var b,c;for(this.$group=a,b=0,c=this.items.length;c>b;b++)this.$group.append(this.items[b].$element)},a.ui.mixin.GroupElement.prototype.isEmpty=function(){return!this.items.length},a.ui.mixin.GroupElement.prototype.getItems=function(){return this.items.slice(0)},a.ui.mixin.GroupElement.prototype.getItemFromData=function(b){var c,d,e,f=a.getHash(b);for(c=0,d=this.items.length;d>c;c++)if(e=this.items[c],f===a.getHash(e.getData()))return e;return null},a.ui.mixin.GroupElement.prototype.getItemsFromData=function(b){var c,d,e,f=a.getHash(b),g=[];for(c=0,d=this.items.length;d>c;c++)e=this.items[c],f===a.getHash(e.getData())&&g.push(e);return g},a.ui.mixin.GroupElement.prototype.aggregate=function(a){var b,c,d,e,f,g,h;for(g in a){if(h=a[g],Object.prototype.hasOwnProperty.call(this.aggregateItemEvents,g)){if(h)throw new Error("Duplicate item event aggregation for "+g);for(b=0,c=this.items.length;c>b;b++)d=this.items[b],d.connect&&d.disconnect&&(f={},f[g]=["emit",this.aggregateItemEvents[g],d],d.disconnect(this,f));delete this.aggregateItemEvents[g]}if(h)for(this.aggregateItemEvents[g]=h,b=0,c=this.items.length;c>b;b++)d=this.items[b],d.connect&&d.disconnect&&(e={},e[g]=["emit",h,d],d.connect(this,e))}},a.ui.mixin.GroupElement.prototype.addItems=function(a,b){var c,d,e,f,g,h,i=[];for(c=0,d=a.length;d>c;c++){if(e=a[c],h=this.items.indexOf(e),h>=0&&(this.removeItems([e]),b>h&&b--),e.connect&&e.disconnect&&!$.isEmptyObject(this.aggregateItemEvents)){g={};for(f in this.aggregateItemEvents)g[f]=["emit",this.aggregateItemEvents[f],e];e.connect(this,g)}e.setElementGroup(this),i.push(e.$element.get(0))}return void 0===b||0>b||b>=this.items.length?(this.$group.append(i),this.items.push.apply(this.items,a)):0===b?(this.$group.prepend(i),this.items.unshift.apply(this.items,a)):(this.items[b].$element.before(i),this.items.splice.apply(this.items,[b,0].concat(a))),this},a.ui.mixin.GroupElement.prototype.removeItems=function(a){var b,c,d,e,f,g;for(b=0,c=a.length;c>b;b++)d=a[b],e=this.items.indexOf(d),-1!==e&&(d.connect&&d.disconnect&&!$.isEmptyObject(this.aggregateItemEvents)&&(f={},Object.prototype.hasOwnProperty.call(this.aggregateItemEvents,g)&&(f[g]=["emit",this.aggregateItemEvents[g],d]),d.disconnect(this,f)),d.setElementGroup(null),this.items.splice(e,1),d.$element.detach());return this},a.ui.mixin.GroupElement.prototype.clearItems=function(){var a,b,c,d,e;for(a=0,b=this.items.length;b>a;a++)c=this.items[a],c.connect&&c.disconnect&&!$.isEmptyObject(this.aggregateItemEvents)&&(d={},Object.prototype.hasOwnProperty.call(this.aggregateItemEvents,e)&&(d[e]=["emit",this.aggregateItemEvents[e],c]),c.disconnect(this,d)),c.setElementGroup(null),c.$element.detach();return this.items=[],this},a.ui.mixin.DraggableElement=function(){this.index=null,this.$element.attr("draggable",!0).addClass("oo-ui-draggableElement").on({dragstart:this.onDragStart.bind(this),dragover:this.onDragOver.bind(this),dragend:this.onDragEnd.bind(this),drop:this.onDrop.bind(this)})},a.initClass(a.ui.mixin.DraggableElement),a.ui.mixin.DraggableElement["static"].cancelButtonMouseDownEvents=!1,a.ui.mixin.DraggableElement.prototype.onDragStart=function(a){var b=a.originalEvent.dataTransfer;b.dropEffect="none",b.effectAllowed="move";try{b.setData("application-x/OOjs-UI-draggable",this.getIndex())}catch(c){}return this.$element.addClass("oo-ui-draggableElement-dragging"),this.emit("dragstart",this),!0},a.ui.mixin.DraggableElement.prototype.onDragEnd=function(){this.$element.removeClass("oo-ui-draggableElement-dragging"),this.emit("dragend")},a.ui.mixin.DraggableElement.prototype.onDrop=function(a){a.preventDefault(),this.emit("drop",a)},a.ui.mixin.DraggableElement.prototype.onDragOver=function(a){a.preventDefault()},a.ui.mixin.DraggableElement.prototype.setIndex=function(a){this.index!==a&&(this.index=a,this.$element.data("index",a))},a.ui.mixin.DraggableElement.prototype.getIndex=function(){return this.index},a.ui.mixin.DraggableGroupElement=function(b){b=b||{},a.ui.mixin.GroupElement.call(this,b),this.orientation=b.orientation||"vertical",this.dragItem=null,this.itemDragOver=null,this.itemKeys={},this.sideInsertion="",this.aggregate({dragstart:"itemDragStart",dragend:"itemDragEnd",drop:"itemDrop"}),this.connect(this,{itemDragStart:"onItemDragStart",itemDrop:"onItemDrop",itemDragEnd:"onItemDragEnd"}),this.$element.on({dragover:this.onDragOver.bind(this),dragleave:this.onDragLeave.bind(this)}),Array.isArray(b.items)&&this.addItems(b.items),this.$placeholder=$("<div>").addClass("oo-ui-draggableGroupElement-placeholder"),this.$element.addClass("oo-ui-draggableGroupElement").append(this.$status).toggleClass("oo-ui-draggableGroupElement-horizontal","horizontal"===this.orientation).prepend(this.$placeholder)},a.mixinClass(a.ui.mixin.DraggableGroupElement,a.ui.mixin.GroupElement),a.ui.mixin.DraggableGroupElement.prototype.onItemDragStart=function(a){var b,c;for(b=0,c=this.items.length;c>b;b++)this.items[b].setIndex(b);"horizontal"===this.orientation?this.$placeholder.css({height:a.$element.outerHeight(),width:2}):this.$placeholder.css({height:2,width:a.$element.outerWidth()}),this.setDragItem(a)},a.ui.mixin.DraggableGroupElement.prototype.onItemDragEnd=function(){return this.unsetDragItem(),!1},a.ui.mixin.DraggableGroupElement.prototype.onItemDrop=function(a){var b=a.getIndex();return this.getDragItem()&&("after"===this.sideInsertion&&b++,this.emit("reorder",this.getDragItem(),b)),this.unsetDragItem(),!1},a.ui.mixin.DraggableGroupElement.prototype.onDragLeave=function(){this.$placeholder.css("left",0).addClass("oo-ui-element-hidden")},a.ui.mixin.DraggableGroupElement.prototype.onDragOver=function(a){var b,c,d,e,f,g,h,i,j,k,l=a.originalEvent.clientX,m=a.originalEvent.clientY;b=this.getElementDocument().elementFromPoint(l,m),c=$(b).closest(".oo-ui-draggableElement"),c[0]&&(d=c.offset(),f=c[0].getBoundingClientRect(),k=c.position(),j=c.data("index")),d&&this.isDragging()&&j!==this.getDragItem().getIndex()?("horizontal"===this.orientation?(g=f.width,e=f.left+g/2,i=l,h={left:e>i?k.left:k.left+g,top:k.top}):(g=f.height,e=f.top+g/2,i=m,h={top:e>i?k.top:k.top+g,left:k.left}),"horizontal"===this.orientation&&"rtl"===this.$element.css("direction")?this.sideInsertion=e>i?"after":"before":this.sideInsertion=e>i?"before":"after",this.$placeholder.css(h).removeClass("oo-ui-element-hidden")):this.$placeholder.css("left",0).addClass("oo-ui-element-hidden"),a.preventDefault()},a.ui.mixin.DraggableGroupElement.prototype.setDragItem=function(a){this.dragItem=a},a.ui.mixin.DraggableGroupElement.prototype.unsetDragItem=function(){this.dragItem=null,this.itemDragOver=null,this.$placeholder.addClass("oo-ui-element-hidden"),this.sideInsertion=""},a.ui.mixin.DraggableGroupElement.prototype.getDragItem=function(){return this.dragItem},a.ui.mixin.DraggableGroupElement.prototype.isDragging=function(){return null!==this.getDragItem()},a.ui.mixin.IconElement=function(a){a=a||{},this.$icon=null,this.icon=null,this.iconTitle=null,this.setIcon(a.icon||this.constructor["static"].icon),this.setIconTitle(a.iconTitle||this.constructor["static"].iconTitle),this.setIconElement(a.$icon||$("<span>"))},a.initClass(a.ui.mixin.IconElement),a.ui.mixin.IconElement["static"].icon=null,a.ui.mixin.IconElement["static"].iconTitle=null,a.ui.mixin.IconElement.prototype.setIconElement=function(a){this.$icon&&this.$icon.removeClass("oo-ui-iconElement-icon oo-ui-icon-"+this.icon).removeAttr("title"),this.$icon=a.addClass("oo-ui-iconElement-icon").toggleClass("oo-ui-icon-"+this.icon,!!this.icon),null!==this.iconTitle&&this.$icon.attr("title",this.iconTitle),this.updateThemeClasses()},a.ui.mixin.IconElement.prototype.setIcon=function(b){return b=a.isPlainObject(b)?a.ui.getLocalValue(b,null,"default"):b,b="string"==typeof b&&b.trim().length?b.trim():null,this.icon!==b&&(this.$icon&&(null!==this.icon&&this.$icon.removeClass("oo-ui-icon-"+this.icon),null!==b&&this.$icon.addClass("oo-ui-icon-"+b)),this.icon=b),this.$element.toggleClass("oo-ui-iconElement",!!this.icon),this.updateThemeClasses(),this},a.ui.mixin.IconElement.prototype.setIconTitle=function(b){return b="function"==typeof b||"string"==typeof b&&b.length?a.ui.resolveMsg(b):null,this.iconTitle!==b&&(this.iconTitle=b,this.$icon&&(null!==this.iconTitle?this.$icon.attr("title",b):this.$icon.removeAttr("title"))),this},a.ui.mixin.IconElement.prototype.getIcon=function(){return this.icon},a.ui.mixin.IconElement.prototype.getIconTitle=function(){return this.iconTitle},a.ui.mixin.IndicatorElement=function(a){a=a||{},this.$indicator=null,this.indicator=null,this.indicatorTitle=null,this.setIndicator(a.indicator||this.constructor["static"].indicator),this.setIndicatorTitle(a.indicatorTitle||this.constructor["static"].indicatorTitle),this.setIndicatorElement(a.$indicator||$("<span>"))},a.initClass(a.ui.mixin.IndicatorElement),a.ui.mixin.IndicatorElement["static"].indicator=null,a.ui.mixin.IndicatorElement["static"].indicatorTitle=null,a.ui.mixin.IndicatorElement.prototype.setIndicatorElement=function(a){this.$indicator&&this.$indicator.removeClass("oo-ui-indicatorElement-indicator oo-ui-indicator-"+this.indicator).removeAttr("title"),this.$indicator=a.addClass("oo-ui-indicatorElement-indicator").toggleClass("oo-ui-indicator-"+this.indicator,!!this.indicator),null!==this.indicatorTitle&&this.$indicator.attr("title",this.indicatorTitle),this.updateThemeClasses()},a.ui.mixin.IndicatorElement.prototype.setIndicator=function(a){return a="string"==typeof a&&a.length?a.trim():null,this.indicator!==a&&(this.$indicator&&(null!==this.indicator&&this.$indicator.removeClass("oo-ui-indicator-"+this.indicator),null!==a&&this.$indicator.addClass("oo-ui-indicator-"+a)),this.indicator=a),this.$element.toggleClass("oo-ui-indicatorElement",!!this.indicator),this.updateThemeClasses(),this},a.ui.mixin.IndicatorElement.prototype.setIndicatorTitle=function(b){return b="function"==typeof b||"string"==typeof b&&b.length?a.ui.resolveMsg(b):null,this.indicatorTitle!==b&&(this.indicatorTitle=b,this.$indicator&&(null!==this.indicatorTitle?this.$indicator.attr("title",b):this.$indicator.removeAttr("title"))),this},a.ui.mixin.IndicatorElement.prototype.getIndicator=function(){return this.indicator},a.ui.mixin.IndicatorElement.prototype.getIndicatorTitle=function(){return this.indicatorTitle},a.ui.mixin.LabelElement=function(a){a=a||{},this.$label=null,this.label=null,this.autoFitLabel=void 0===a.autoFitLabel||!!a.autoFitLabel,this.setLabel(a.label||this.constructor["static"].label),this.setLabelElement(a.$label||$("<span>"))},a.initClass(a.ui.mixin.LabelElement),a.ui.mixin.LabelElement["static"].label=null,a.ui.mixin.LabelElement.prototype.setLabelElement=function(a){this.$label&&this.$label.removeClass("oo-ui-labelElement-label").empty(),this.$label=a.addClass("oo-ui-labelElement-label"),this.setLabelContent(this.label)},a.ui.mixin.LabelElement.prototype.setLabel=function(b){return b="function"==typeof b?a.ui.resolveMsg(b):b,b="string"==typeof b&&b.length||b instanceof jQuery||b instanceof a.ui.HtmlSnippet?b:null,this.$element.toggleClass("oo-ui-labelElement",!!b),this.label!==b&&(this.$label&&this.setLabelContent(b),this.label=b,this.emit("labelChange")),this},a.ui.mixin.LabelElement.prototype.getLabel=function(){return this.label},a.ui.mixin.LabelElement.prototype.fitLabel=function(){return this.$label&&this.$label.autoEllipsis&&this.autoFitLabel&&this.$label.autoEllipsis({hasSpan:!1,tooltip:!0}),this},a.ui.mixin.LabelElement.prototype.setLabelContent=function(b){"string"==typeof b?b.match(/^\s*$/)?this.$label.html("&nbsp;"):this.$label.text(b):b instanceof a.ui.HtmlSnippet?this.$label.html(b.toString()):b instanceof jQuery?this.$label.empty().append(b):this.$label.empty()},a.ui.mixin.LookupElement=function(b){b=$.extend({highlightFirst:!0},b),a.ui.mixin.RequestManager.call(this,b),this.$overlay=b.$overlay||this.$element,this.lookupMenu=new a.ui.FloatingMenuSelectWidget({widget:this,input:this,$container:b.$container||this.$element}),this.allowSuggestionsWhenEmpty=b.allowSuggestionsWhenEmpty||!1,this.lookupsDisabled=!1,this.lookupInputFocused=!1,this.lookupHighlightFirstItem=b.highlightFirst,this.$input.on({focus:this.onLookupInputFocus.bind(this),blur:this.onLookupInputBlur.bind(this),mousedown:this.onLookupInputMouseDown.bind(this)}),this.connect(this,{change:"onLookupInputChange"}),this.lookupMenu.connect(this,{toggle:"onLookupMenuToggle",choose:"onLookupMenuItemChoose"}),this.$element.addClass("oo-ui-lookupElement"),this.lookupMenu.$element.addClass("oo-ui-lookupElement-menu"),this.$overlay.append(this.lookupMenu.$element)},a.mixinClass(a.ui.mixin.LookupElement,a.ui.mixin.RequestManager),a.ui.mixin.LookupElement.prototype.onLookupInputFocus=function(){this.lookupInputFocused=!0,this.populateLookupMenu()},a.ui.mixin.LookupElement.prototype.onLookupInputBlur=function(){this.closeLookupMenu(),this.lookupInputFocused=!1},a.ui.mixin.LookupElement.prototype.onLookupInputMouseDown=function(){this.lookupInputFocused&&!this.lookupMenu.isVisible()&&this.populateLookupMenu()},a.ui.mixin.LookupElement.prototype.onLookupInputChange=function(){this.lookupInputFocused&&this.populateLookupMenu()},a.ui.mixin.LookupElement.prototype.onLookupMenuToggle=function(a){a||(this.abortLookupRequest(),this.lookupMenu.clearItems())},a.ui.mixin.LookupElement.prototype.onLookupMenuItemChoose=function(a){this.setValue(a.getData())},a.ui.mixin.LookupElement.prototype.getLookupMenu=function(){return this.lookupMenu},a.ui.mixin.LookupElement.prototype.setLookupsDisabled=function(a){this.lookupsDisabled=!!a},a.ui.mixin.LookupElement.prototype.openLookupMenu=function(){return this.lookupMenu.isEmpty()||this.lookupMenu.toggle(!0),this},a.ui.mixin.LookupElement.prototype.closeLookupMenu=function(){return this.lookupMenu.toggle(!1),this.abortLookupRequest(),this.lookupMenu.clearItems(),this},a.ui.mixin.LookupElement.prototype.populateLookupMenu=function(){var a=this,b=this.getValue();if(!this.lookupsDisabled&&!this.isReadOnly())return this.allowSuggestionsWhenEmpty||""!==b?b!==this.lookupQuery&&this.getLookupMenuItems().done(function(b){a.lookupMenu.clearItems(),b.length?(a.lookupMenu.addItems(b).toggle(!0),a.initializeLookupMenuSelection()):a.lookupMenu.toggle(!1)}).fail(function(){a.lookupMenu.clearItems()}):this.closeLookupMenu(),this},a.ui.mixin.LookupElement.prototype.initializeLookupMenuSelection=function(){this.lookupHighlightFirstItem&&!this.lookupMenu.getSelectedItem()&&this.lookupMenu.highlightItem(this.lookupMenu.getFirstSelectableItem())},a.ui.mixin.LookupElement.prototype.getLookupMenuItems=function(){return this.getRequestData().then(function(a){return this.getLookupMenuOptionsFromData(a)}.bind(this))},a.ui.mixin.LookupElement.prototype.abortLookupRequest=function(){this.abortRequest()},a.ui.mixin.LookupElement.prototype.getLookupRequest=null,a.ui.mixin.LookupElement.prototype.getLookupCacheDataFromResponse=null,a.ui.mixin.LookupElement.prototype.getLookupMenuOptionsFromData=null,a.ui.mixin.LookupElement.prototype.setReadOnly=function(b){return a.ui.TextInputWidget.prototype.setReadOnly.call(this,b),this.isReadOnly()&&this.lookupMenu&&this.closeLookupMenu(),this},a.ui.mixin.LookupElement.prototype.getRequestQuery=function(){return this.getValue()},a.ui.mixin.LookupElement.prototype.getRequest=function(){return this.getLookupRequest()},a.ui.mixin.LookupElement.prototype.getRequestCacheDataFromResponse=function(a){return this.getLookupCacheDataFromResponse(a)},a.ui.mixin.PopupElement=function(b){b=b||{},this.popup=new a.ui.PopupWidget($.extend({autoClose:!0},b.popup,{$autoCloseIgnore:this.$element}))},a.ui.mixin.PopupElement.prototype.getPopup=function(){return this.popup},a.ui.mixin.FlaggedElement=function(a){a=a||{},this.flags={},this.$flagged=null,this.setFlags(a.flags),this.setFlaggedElement(a.$flagged||this.$element)},a.ui.mixin.FlaggedElement.prototype.setFlaggedElement=function(a){var b=Object.keys(this.flags).map(function(a){return"oo-ui-flaggedElement-"+a}).join(" ");this.$flagged&&this.$flagged.removeClass(b),this.$flagged=a.addClass(b)},a.ui.mixin.FlaggedElement.prototype.hasFlag=function(a){return this.flags&&a in this.flags},a.ui.mixin.FlaggedElement.prototype.getFlags=function(){return Object.keys(this.flags||{})},a.ui.mixin.FlaggedElement.prototype.clearFlags=function(){var a,b,c={},d=[],e="oo-ui-flaggedElement-";for(a in this.flags)b=e+a,c[a]=!1,delete this.flags[a],d.push(b);return this.$flagged&&this.$flagged.removeClass(d.join(" ")),this.updateThemeClasses(),this.emit("flag",c),this},a.ui.mixin.FlaggedElement.prototype.setFlags=function(b){var c,d,e,f,g={},h=[],i=[],j="oo-ui-flaggedElement-";if("string"==typeof b)f=j+b,this.flags[b]||(this.flags[b]=!0,h.push(f));else if(Array.isArray(b))for(c=0,d=b.length;d>c;c++)e=b[c],f=j+e,this.flags[e]||(g[e]=!0,this.flags[e]=!0,h.push(f));else if(a.isPlainObject(b))for(e in b)f=j+e,b[e]?this.flags[e]||(g[e]=!0,this.flags[e]=!0,h.push(f)):this.flags[e]&&(g[e]=!1,delete this.flags[e],i.push(f));return this.$flagged&&this.$flagged.addClass(h.join(" ")).removeClass(i.join(" ")),this.updateThemeClasses(),this.emit("flag",g),this},a.ui.mixin.TitledElement=function(a){a=a||{},this.$titled=null,this.title=null,this.setTitle(a.title||this.constructor["static"].title),this.setTitledElement(a.$titled||this.$element)},a.initClass(a.ui.mixin.TitledElement),a.ui.mixin.TitledElement["static"].title=null,a.ui.mixin.TitledElement.prototype.setTitledElement=function(a){this.$titled&&this.$titled.removeAttr("title"),this.$titled=a,this.title&&this.$titled.attr("title",this.title)},a.ui.mixin.TitledElement.prototype.setTitle=function(b){return b="function"==typeof b?a.ui.resolveMsg(b):b,b="string"==typeof b&&b.length?b:null,this.title!==b&&(this.$titled&&(null!==b?this.$titled.attr("title",b):this.$titled.removeAttr("title")),this.title=b),this},a.ui.mixin.TitledElement.prototype.getTitle=function(){return this.title},a.ui.mixin.ClippableElement=function(a){a=a||{},this.$clippable=null,this.$clippableContainer=null,this.clipping=!1,this.clippedHorizontally=!1,this.clippedVertically=!1,this.$clippableScrollableContainer=null,this.$clippableScroller=null,this.$clippableWindow=null,this.idealWidth=null,this.idealHeight=null,this.onClippableScrollHandler=this.clip.bind(this),this.onClippableWindowResizeHandler=this.clip.bind(this),a.$clippableContainer&&this.setClippableContainer(a.$clippableContainer),this.setClippableElement(a.$clippable||this.$element)},a.ui.mixin.ClippableElement.prototype.setClippableElement=function(b){this.$clippable&&(this.$clippable.removeClass("oo-ui-clippableElement-clippable"),this.$clippable.css({width:"",height:"",overflowX:"",overflowY:""}),a.ui.Element["static"].reconsiderScrollbars(this.$clippable[0])),this.$clippable=b.addClass("oo-ui-clippableElement-clippable"),this.clip()},a.ui.mixin.ClippableElement.prototype.setClippableContainer=function(a){this.$clippableContainer=a,this.$clippable&&this.clip()},a.ui.mixin.ClippableElement.prototype.toggleClipping=function(b){return b=void 0===b?!this.clipping:!!b,this.clipping!==b&&(this.clipping=b,b?(this.$clippableScrollableContainer=$(this.getClosestScrollableElementContainer()),this.$clippableScroller=this.$clippableScrollableContainer.is("html, body")?$(a.ui.Element["static"].getWindow(this.$clippableScrollableContainer)):this.$clippableScrollableContainer,this.$clippableScroller.on("scroll",this.onClippableScrollHandler),this.$clippableWindow=$(this.getElementWindow()).on("resize",this.onClippableWindowResizeHandler),this.clip()):(this.$clippable.css({width:"",height:"",overflowX:"",overflowY:""}),a.ui.Element["static"].reconsiderScrollbars(this.$clippable[0]),this.$clippableScrollableContainer=null,this.$clippableScroller.off("scroll",this.onClippableScrollHandler),this.$clippableScroller=null,this.$clippableWindow.off("resize",this.onClippableWindowResizeHandler),this.$clippableWindow=null)),this},a.ui.mixin.ClippableElement.prototype.isClipping=function(){return this.clipping},a.ui.mixin.ClippableElement.prototype.isClipped=function(){return this.clippedHorizontally||this.clippedVertically},a.ui.mixin.ClippableElement.prototype.isClippedHorizontally=function(){return this.clippedHorizontally},a.ui.mixin.ClippableElement.prototype.isClippedVertically=function(){return this.clippedVertically},a.ui.mixin.ClippableElement.prototype.setIdealSize=function(a,b){this.idealWidth=a,this.idealHeight=b,this.clipping||this.$clippable.css({width:a,height:b})},a.ui.mixin.ClippableElement.prototype.clip=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=7;return this.clipping?(b=this.$clippableContainer||this.$clippable,c=b.outerHeight()-this.$clippable.outerHeight(),d=b.outerWidth()-this.$clippable.outerWidth(),e=b.offset(),f=this.$clippableScrollableContainer.is("html, body")?this.$clippableWindow:this.$clippableScrollableContainer,g=f.offset()||{top:0,left:0},h=f.innerHeight()-v,i=f.innerWidth()-v,j=b.outerWidth()+v,k=this.$clippableScroller[0]===this.$clippableWindow[0],l=k?this.$clippableScroller.scrollTop():0,m=k?this.$clippableScroller.scrollLeft():0,n=e.left<0?j+e.left:g.left+m+i-e.left,o=g.top+l+h-e.top,p=n-d,q=o-c,r=this.$clippable.prop("scrollWidth"),s=this.$clippable.prop("scrollHeight"),t=r>p,u=s>q,t?this.$clippable.css({overflowX:"scroll",width:Math.max(0,p)}):this.$clippable.css({width:this.idealWidth?this.idealWidth-d:"",overflowX:""}),u?this.$clippable.css({overflowY:"scroll",height:Math.max(0,q)}):this.$clippable.css({height:this.idealHeight?this.idealHeight-c:"",overflowY:""}),(this.clippedHorizontally&&!t||this.clippedVertically&&!u)&&a.ui.Element["static"].reconsiderScrollbars(this.$clippable[0]),this.clippedHorizontally=t,this.clippedVertically=u,this):this},a.ui.mixin.FloatableElement=function(a){a=a||{},this.$floatable=null,this.$floatableContainer=null,this.$floatableWindow=null,this.$floatableClosestScrollable=null,this.onFloatableScrollHandler=this.position.bind(this),this.onFloatableWindowResizeHandler=this.position.bind(this),this.setFloatableContainer(a.$floatableContainer),this.setFloatableElement(a.$floatable||this.$element)},a.ui.mixin.FloatableElement.prototype.setFloatableElement=function(a){this.$floatable&&(this.$floatable.removeClass("oo-ui-floatableElement-floatable"),this.$floatable.css({left:"",top:""})),
this.$floatable=a.addClass("oo-ui-floatableElement-floatable"),this.position()},a.ui.mixin.FloatableElement.prototype.setFloatableContainer=function(a){this.$floatableContainer=a,this.$floatable&&this.position()},a.ui.mixin.FloatableElement.prototype.togglePositioning=function(b){var c,d;return b=void 0===b?!this.positioning:!!b,this.positioning!==b&&(this.positioning=b,c=a.ui.Element["static"].getClosestScrollableContainer(this.$floatableContainer[0]),d=a.ui.Element["static"].getClosestScrollableContainer(this.$floatable[0]),c!==d&&$(c).is("html, body")&&(c=a.ui.Element["static"].getWindow(c)),b?(this.$floatableWindow=$(this.getElementWindow()),this.$floatableWindow.on("resize",this.onFloatableWindowResizeHandler),c!==d&&(this.$floatableClosestScrollable=$(c),this.$floatableClosestScrollable.on("scroll",this.onFloatableScrollHandler)),this.position()):(this.$floatableWindow&&(this.$floatableWindow.off("resize",this.onFloatableWindowResizeHandler),this.$floatableWindow=null),this.$floatableClosestScrollable&&(this.$floatableClosestScrollable.off("scroll",this.onFloatableScrollHandler),this.$floatableClosestScrollable=null),this.$floatable.css({left:"",top:""}))),this},a.ui.mixin.FloatableElement.prototype.position=function(){var b;return this.positioning?(b=a.ui.Element["static"].getRelativePosition(this.$floatableContainer,this.$floatable.offsetParent()),b.top+=this.$floatableContainer.height(),this.$floatable.css(b),this.clip&&this.clip(),this):this},a.ui.mixin.AccessKeyedElement=function(a){a=a||{},this.$accessKeyed=null,this.accessKey=null,this.setAccessKey(a.accessKey||null),this.setAccessKeyedElement(a.$accessKeyed||this.$element)},a.initClass(a.ui.mixin.AccessKeyedElement),a.ui.mixin.AccessKeyedElement["static"].accessKey=null,a.ui.mixin.AccessKeyedElement.prototype.setAccessKeyedElement=function(a){this.$accessKeyed&&this.$accessKeyed.removeAttr("accesskey"),this.$accessKeyed=a,this.accessKey&&this.$accessKeyed.attr("accesskey",this.accessKey)},a.ui.mixin.AccessKeyedElement.prototype.setAccessKey=function(b){return b="string"==typeof b?a.ui.resolveMsg(b):null,this.accessKey!==b&&(this.$accessKeyed&&(null!==b?this.$accessKeyed.attr("accesskey",b):this.$accessKeyed.removeAttr("accesskey")),this.accessKey=b),this},a.ui.mixin.AccessKeyedElement.prototype.getAccessKey=function(){return this.accessKey},a.ui.Tool=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.toolGroup),c=c||{},a.ui.Tool.parent.call(this,c),this.toolGroup=b,this.toolbar=this.toolGroup.getToolbar(),this.active=!1,this.$title=$("<span>"),this.$accel=$("<span>"),this.$link=$("<a>"),this.title=null,a.ui.mixin.IconElement.call(this,c),a.ui.mixin.FlaggedElement.call(this,c),a.ui.mixin.TabIndexedElement.call(this,$.extend({},c,{$tabIndexed:this.$link})),this.toolbar.connect(this,{updateState:"onUpdateState"}),this.$title.addClass("oo-ui-tool-title"),this.$accel.addClass("oo-ui-tool-accel").prop({dir:"ltr",lang:"en"}),this.$link.addClass("oo-ui-tool-link").append(this.$icon,this.$title,this.$accel).attr("role","button"),this.$element.data("oo-ui-tool",this).addClass("oo-ui-tool oo-ui-tool-name-"+this.constructor["static"].name.replace(/^([^\/]+)\/([^\/]+).*$/,"$1-$2")).toggleClass("oo-ui-tool-with-label",this.constructor["static"].displayBothIconAndLabel).append(this.$link),this.setTitle(c.title||this.constructor["static"].title)},a.inheritClass(a.ui.Tool,a.ui.Widget),a.mixinClass(a.ui.Tool,a.ui.mixin.IconElement),a.mixinClass(a.ui.Tool,a.ui.mixin.FlaggedElement),a.mixinClass(a.ui.Tool,a.ui.mixin.TabIndexedElement),a.ui.Tool["static"].tagName="span",a.ui.Tool["static"].name="",a.ui.Tool["static"].group="",a.ui.Tool["static"].title="",a.ui.Tool["static"].displayBothIconAndLabel=!1,a.ui.Tool["static"].autoAddToCatchall=!0,a.ui.Tool["static"].autoAddToGroup=!0,a.ui.Tool["static"].isCompatibleWith=function(){return!1},a.ui.Tool.prototype.onUpdateState=null,a.ui.Tool.prototype.onSelect=null,a.ui.Tool.prototype.isActive=function(){return this.active},a.ui.Tool.prototype.setActive=function(a){this.active=!!a,this.active?this.$element.addClass("oo-ui-tool-active"):this.$element.removeClass("oo-ui-tool-active")},a.ui.Tool.prototype.setTitle=function(b){return this.title=a.ui.resolveMsg(b),this.updateTitle(),this},a.ui.Tool.prototype.getTitle=function(){return this.title},a.ui.Tool.prototype.getName=function(){return this.constructor["static"].name},a.ui.Tool.prototype.updateTitle=function(){var a=this.toolGroup.constructor["static"].titleTooltips,b=this.toolGroup.constructor["static"].accelTooltips,c=this.toolbar.getToolAccelerator(this.constructor["static"].name),d=[];this.$title.text(this.title),this.$accel.text(c),a&&"string"==typeof this.title&&this.title.length&&d.push(this.title),b&&"string"==typeof c&&c.length&&d.push(c),d.length?this.$link.attr("title",d.join(" ")):this.$link.removeAttr("title")},a.ui.Tool.prototype.destroy=function(){this.toolbar.disconnect(this),this.$element.remove()},a.ui.Toolbar=function(b,c,d){a.isPlainObject(b)&&void 0===d&&(d=b,b=d.toolFactory,c=d.toolGroupFactory),d=d||{},a.ui.Toolbar.parent.call(this,d),a.EventEmitter.call(this),a.ui.mixin.GroupElement.call(this,d),this.toolFactory=b,this.toolGroupFactory=c,this.groups=[],this.tools={},this.$bar=$("<div>"),this.$actions=$("<div>"),this.initialized=!1,this.onWindowResizeHandler=this.onWindowResize.bind(this),this.$element.add(this.$bar).add(this.$group).add(this.$actions).on("mousedown keydown",this.onPointerDown.bind(this)),this.$group.addClass("oo-ui-toolbar-tools"),d.actions&&this.$bar.append(this.$actions.addClass("oo-ui-toolbar-actions")),this.$bar.addClass("oo-ui-toolbar-bar").append(this.$group,'<div style="clear:both"></div>'),d.shadow&&this.$bar.append('<div class="oo-ui-toolbar-shadow"></div>'),this.$element.addClass("oo-ui-toolbar").append(this.$bar)},a.inheritClass(a.ui.Toolbar,a.ui.Element),a.mixinClass(a.ui.Toolbar,a.EventEmitter),a.mixinClass(a.ui.Toolbar,a.ui.mixin.GroupElement),a.ui.Toolbar.prototype.getToolFactory=function(){return this.toolFactory},a.ui.Toolbar.prototype.getToolGroupFactory=function(){return this.toolGroupFactory},a.ui.Toolbar.prototype.onPointerDown=function(a){var b=$(a.target).closest(".oo-ui-widget"),c=this.$element.closest(".oo-ui-widget");return b.length&&b[0]!==c[0]?void 0:!1},a.ui.Toolbar.prototype.onWindowResize=function(){this.$element.toggleClass("oo-ui-toolbar-narrow",this.$bar.width()<=this.narrowThreshold)},a.ui.Toolbar.prototype.initialize=function(){this.initialized||(this.initialized=!0,this.narrowThreshold=this.$group.width()+this.$actions.width(),$(this.getElementWindow()).on("resize",this.onWindowResizeHandler),this.onWindowResize())},a.ui.Toolbar.prototype.setup=function(b){var c,d,e,f,g=[],h="bar";for(this.reset(),c=0,d=b.length;d>c;c++)f=b[c],"*"===f.include&&(void 0===f.type&&(f.type="list"),void 0===f.label&&(f.label=a.ui.msg("ooui-toolbar-more"))),e=this.getToolGroupFactory().lookup(f.type)?f.type:h,g.push(this.getToolGroupFactory().create(e,this,f));this.addItems(g)},a.ui.Toolbar.prototype.reset=function(){var a,b;for(this.groups=[],this.tools={},a=0,b=this.items.length;b>a;a++)this.items[a].destroy();this.clearItems()},a.ui.Toolbar.prototype.destroy=function(){$(this.getElementWindow()).off("resize",this.onWindowResizeHandler),this.reset(),this.$element.remove()},a.ui.Toolbar.prototype.isToolAvailable=function(a){return!this.tools[a]},a.ui.Toolbar.prototype.reserveTool=function(a){this.tools[a.getName()]=a},a.ui.Toolbar.prototype.releaseTool=function(a){delete this.tools[a.getName()]},a.ui.Toolbar.prototype.getToolAccelerator=function(){return void 0},a.ui.ToolGroup=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.toolbar),c=c||{},a.ui.ToolGroup.parent.call(this,c),a.ui.mixin.GroupElement.call(this,c),this.toolbar=b,this.tools={},this.pressed=null,this.autoDisabled=!1,this.include=c.include||[],this.exclude=c.exclude||[],this.promote=c.promote||[],this.demote=c.demote||[],this.onCapturedMouseKeyUpHandler=this.onCapturedMouseKeyUp.bind(this),this.$element.on({mousedown:this.onMouseKeyDown.bind(this),mouseup:this.onMouseKeyUp.bind(this),keydown:this.onMouseKeyDown.bind(this),keyup:this.onMouseKeyUp.bind(this),focus:this.onMouseOverFocus.bind(this),blur:this.onMouseOutBlur.bind(this),mouseover:this.onMouseOverFocus.bind(this),mouseout:this.onMouseOutBlur.bind(this)}),this.toolbar.getToolFactory().connect(this,{register:"onToolFactoryRegister"}),this.aggregate({disable:"itemDisable"}),this.connect(this,{itemDisable:"updateDisabled"}),this.$group.addClass("oo-ui-toolGroup-tools"),this.$element.addClass("oo-ui-toolGroup").append(this.$group),this.populate()},a.inheritClass(a.ui.ToolGroup,a.ui.Widget),a.mixinClass(a.ui.ToolGroup,a.ui.mixin.GroupElement),a.ui.ToolGroup["static"].titleTooltips=!1,a.ui.ToolGroup["static"].accelTooltips=!1,a.ui.ToolGroup["static"].autoDisable=!0,a.ui.ToolGroup.prototype.isDisabled=function(){return this.autoDisabled||a.ui.ToolGroup.parent.prototype.isDisabled.apply(this,arguments)},a.ui.ToolGroup.prototype.updateDisabled=function(){var b,c,d=!0;if(this.constructor["static"].autoDisable){for(b=this.items.length-1;b>=0;b--)if(c=this.items[b],!c.isDisabled()){d=!1;break}this.autoDisabled=d}a.ui.ToolGroup.parent.prototype.updateDisabled.apply(this,arguments)},a.ui.ToolGroup.prototype.onMouseKeyDown=function(b){return this.isDisabled()||1!==b.which&&b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER?void 0:(this.pressed=this.getTargetTool(b),this.pressed&&(this.pressed.setActive(!0),a.ui.addCaptureEventListener(this.getElementDocument(),"mouseup",this.onCapturedMouseKeyUpHandler),a.ui.addCaptureEventListener(this.getElementDocument(),"keyup",this.onCapturedMouseKeyUpHandler)),!1)},a.ui.ToolGroup.prototype.onCapturedMouseKeyUp=function(b){a.ui.removeCaptureEventListener(this.getElementDocument(),"mouseup",this.onCapturedMouseKeyUpHandler),a.ui.removeCaptureEventListener(this.getElementDocument(),"keyup",this.onCapturedMouseKeyUpHandler),this.onMouseKeyUp(b)},a.ui.ToolGroup.prototype.onMouseKeyUp=function(b){var c=this.getTargetTool(b);return this.isDisabled()||!this.pressed||this.pressed!==c||1!==b.which&&b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER?void(this.pressed=null):(this.pressed.onSelect(),this.pressed=null,!1)},a.ui.ToolGroup.prototype.onMouseOverFocus=function(a){var b=this.getTargetTool(a);this.pressed&&this.pressed===b&&this.pressed.setActive(!0)},a.ui.ToolGroup.prototype.onMouseOutBlur=function(a){var b=this.getTargetTool(a);this.pressed&&this.pressed===b&&this.pressed.setActive(!1)},a.ui.ToolGroup.prototype.getTargetTool=function(a){var b,c=$(a.target).closest(".oo-ui-tool-link");return c.length&&(b=c.parent().data("oo-ui-tool")),b&&!b.isDisabled()?b:null},a.ui.ToolGroup.prototype.onToolFactoryRegister=function(){this.populate()},a.ui.ToolGroup.prototype.getToolbar=function(){return this.toolbar},a.ui.ToolGroup.prototype.populate=function(){var a,b,c,d,e=this.toolbar.getToolFactory(),f={},g=[],h=[],i=this.toolbar.getToolFactory().getTools(this.include,this.exclude,this.promote,this.demote);for(a=0,b=i.length;b>a;a++)c=i[a],e.lookup(c)&&(this.toolbar.isToolAvailable(c)||this.tools[c])&&(this.toolbar.tools[c]=!0,d=this.tools[c],d||(this.tools[c]=d=e.create(c,this),d.updateTitle()),this.toolbar.reserveTool(d),g.push(d),f[c]=!0);for(c in this.tools)f[c]||(this.tools[c].destroy(),this.toolbar.releaseTool(this.tools[c]),h.push(this.tools[c]),delete this.tools[c]);h.length&&this.removeItems(h),g.length?this.$element.removeClass("oo-ui-toolGroup-empty"):this.$element.addClass("oo-ui-toolGroup-empty"),this.addItems(g),this.updateDisabled()},a.ui.ToolGroup.prototype.destroy=function(){var a;this.clearItems(),this.toolbar.getToolFactory().disconnect(this);for(a in this.tools)this.toolbar.releaseTool(this.tools[a]),this.tools[a].disconnect(this).destroy(),delete this.tools[a];this.$element.remove()},a.ui.MessageDialog=function(b){a.ui.MessageDialog.parent.call(this,b),this.verticalActionLayout=null,this.$element.addClass("oo-ui-messageDialog")},a.inheritClass(a.ui.MessageDialog,a.ui.Dialog),a.ui.MessageDialog["static"].name="message",a.ui.MessageDialog["static"].size="small",a.ui.MessageDialog["static"].verbose=!1,a.ui.MessageDialog["static"].title=null,a.ui.MessageDialog["static"].message=null,a.ui.MessageDialog["static"].actions=[{action:"accept",label:a.ui.deferMsg("ooui-dialog-message-accept"),flags:"primary"},{action:"reject",label:a.ui.deferMsg("ooui-dialog-message-reject"),flags:"safe"}],a.ui.MessageDialog.prototype.setManager=function(b){return a.ui.MessageDialog.parent.prototype.setManager.call(this,b),this.manager.connect(this,{resize:"onResize"}),this},a.ui.MessageDialog.prototype.onActionResize=function(b){return this.fitActions(),a.ui.MessageDialog.parent.prototype.onActionResize.call(this,b)},a.ui.MessageDialog.prototype.onResize=function(){var a=this;a.fitActions(),setTimeout(function(){a.fitActions()},300)},a.ui.MessageDialog.prototype.toggleVerticalActionLayout=function(a){return a=void 0===a?!this.verticalActionLayout:!!a,a!==this.verticalActionLayout&&(this.verticalActionLayout=a,this.$actions.toggleClass("oo-ui-messageDialog-actions-vertical",a).toggleClass("oo-ui-messageDialog-actions-horizontal",!a)),this},a.ui.MessageDialog.prototype.getActionProcess=function(b){return b?new a.ui.Process(function(){this.close({action:b})},this):a.ui.MessageDialog.parent.prototype.getActionProcess.call(this,b)},a.ui.MessageDialog.prototype.getSetupProcess=function(b){return b=b||{},a.ui.MessageDialog.parent.prototype.getSetupProcess.call(this,b).next(function(){this.title.setLabel(void 0!==b.title?b.title:this.constructor["static"].title),this.message.setLabel(void 0!==b.message?b.message:this.constructor["static"].message),this.message.$element.toggleClass("oo-ui-messageDialog-message-verbose",void 0!==b.verbose?b.verbose:this.constructor["static"].verbose)},this)},a.ui.MessageDialog.prototype.getReadyProcess=function(b){return b=b||{},a.ui.MessageDialog.parent.prototype.getReadyProcess.call(this,b).next(function(){var a=this.actions.get();a=a.filter(function(a){return a.getFlags().indexOf("primary")>-1}),a.length>0&&a[0].$button.focus()},this)},a.ui.MessageDialog.prototype.getBodyHeight=function(){var b,c,d=this.container.$element;return c=d[0].style.overflow,d[0].style.overflow="hidden",a.ui.Element["static"].reconsiderScrollbars(d[0]),b=this.text.$element.outerHeight(!0),d[0].style.overflow=c,b},a.ui.MessageDialog.prototype.setDimensions=function(b){var c=this.container.$element;return a.ui.MessageDialog.parent.prototype.setDimensions.call(this,b),setTimeout(function(){var b=c[0].style.overflow;c[0].style.overflow="hidden",a.ui.Element["static"].reconsiderScrollbars(c[0]),c[0].style.overflow=b},300),this},a.ui.MessageDialog.prototype.initialize=function(){a.ui.MessageDialog.parent.prototype.initialize.call(this),this.$actions=$("<div>"),this.container=new a.ui.PanelLayout({scrollable:!0,classes:["oo-ui-messageDialog-container"]}),this.text=new a.ui.PanelLayout({padded:!0,expanded:!1,classes:["oo-ui-messageDialog-text"]}),this.message=new a.ui.LabelWidget({classes:["oo-ui-messageDialog-message"]}),this.title.$element.addClass("oo-ui-messageDialog-title"),this.$content.addClass("oo-ui-messageDialog-content"),this.container.$element.append(this.text.$element),this.text.$element.append(this.title.$element,this.message.$element),this.$body.append(this.container.$element),this.$actions.addClass("oo-ui-messageDialog-actions"),this.$foot.append(this.$actions)},a.ui.MessageDialog.prototype.attachActions=function(){var b,c,d,e,f;if(a.ui.MessageDialog.parent.prototype.attachActions.call(this),e=this.actions.getSpecial(),f=this.actions.getOthers(),e.safe&&(this.$actions.append(e.safe.$element),e.safe.toggleFramed(!1)),f.length)for(b=0,c=f.length;c>b;b++)d=f[b],this.$actions.append(d.$element),d.toggleFramed(!1);e.primary&&(this.$actions.append(e.primary.$element),e.primary.toggleFramed(!1)),this.isOpening()||this.updateSize()},a.ui.MessageDialog.prototype.fitActions=function(){var a,b,c,d=this.verticalActionLayout,e=this.actions.get();for(this.toggleVerticalActionLayout(!1),a=0,b=e.length;b>a;a++)if(c=e[a],c.$element.innerWidth()<c.$label.outerWidth(!0)){this.toggleVerticalActionLayout(!0);break}this.$body.css("bottom",this.$foot.outerHeight(!0)),this.verticalActionLayout!==d&&this.updateSize()},a.ui.ProcessDialog=function(b){a.ui.ProcessDialog.parent.call(this,b),this.fitOnOpen=!1,this.$element.addClass("oo-ui-processDialog")},a.inheritClass(a.ui.ProcessDialog,a.ui.Dialog),a.ui.ProcessDialog.prototype.onDismissErrorButtonClick=function(){this.hideErrors()},a.ui.ProcessDialog.prototype.onRetryButtonClick=function(){this.hideErrors(),this.executeAction(this.currentAction)},a.ui.ProcessDialog.prototype.onActionResize=function(b){return this.actions.isSpecial(b)&&this.fitLabel(),a.ui.ProcessDialog.parent.prototype.onActionResize.call(this,b)},a.ui.ProcessDialog.prototype.initialize=function(){a.ui.ProcessDialog.parent.prototype.initialize.call(this),this.$navigation=$("<div>"),this.$location=$("<div>"),this.$safeActions=$("<div>"),this.$primaryActions=$("<div>"),this.$otherActions=$("<div>"),this.dismissButton=new a.ui.ButtonWidget({label:a.ui.msg("ooui-dialog-process-dismiss")}),this.retryButton=new a.ui.ButtonWidget,this.$errors=$("<div>"),this.$errorsTitle=$("<div>"),this.dismissButton.connect(this,{click:"onDismissErrorButtonClick"}),this.retryButton.connect(this,{click:"onRetryButtonClick"}),this.title.$element.addClass("oo-ui-processDialog-title"),this.$location.append(this.title.$element).addClass("oo-ui-processDialog-location"),this.$safeActions.addClass("oo-ui-processDialog-actions-safe"),this.$primaryActions.addClass("oo-ui-processDialog-actions-primary"),this.$otherActions.addClass("oo-ui-processDialog-actions-other"),this.$errorsTitle.addClass("oo-ui-processDialog-errors-title").text(a.ui.msg("ooui-dialog-process-error")),this.$errors.addClass("oo-ui-processDialog-errors oo-ui-element-hidden").append(this.$errorsTitle,this.dismissButton.$element,this.retryButton.$element),this.$content.addClass("oo-ui-processDialog-content").append(this.$errors),this.$navigation.addClass("oo-ui-processDialog-navigation").append(this.$safeActions,this.$location,this.$primaryActions),this.$head.append(this.$navigation),this.$foot.append(this.$otherActions)},a.ui.ProcessDialog.prototype.getActionWidgets=function(b){var c,d,e=[];for(c=0,d=b.length;d>c;c++)e.push(new a.ui.ActionWidget($.extend({framed:!0},b[c])));return e},a.ui.ProcessDialog.prototype.attachActions=function(){var b,c,d,e,f;for(a.ui.ProcessDialog.parent.prototype.attachActions.call(this),e=this.actions.getSpecial(),f=this.actions.getOthers(),e.primary&&this.$primaryActions.append(e.primary.$element),b=0,c=f.length;c>b;b++)d=f[b],this.$otherActions.append(d.$element);e.safe&&this.$safeActions.append(e.safe.$element),this.fitLabel(),this.$body.css("bottom",this.$foot.outerHeight(!0))},a.ui.ProcessDialog.prototype.executeAction=function(b){var c=this;return a.ui.ProcessDialog.parent.prototype.executeAction.call(this,b).fail(function(a){c.showErrors(a||[])})},a.ui.ProcessDialog.prototype.setDimensions=function(){a.ui.ProcessDialog.parent.prototype.setDimensions.apply(this,arguments),this.fitLabel()},a.ui.ProcessDialog.prototype.fitLabel=function(){var a,b,c,d,e,f,g,h=this.getSizeProperties();if("number"!=typeof h.width){if(!this.isOpened())return this.isOpening()?void(this.fitOnOpen||(this.manager.opening.done(this.fitLabel.bind(this)),this.fitOnOpen=!0)):void 0;e=this.$head.width()-20}else e=h.width-20;return a=this.$safeActions.is(":visible")?this.$safeActions.width():0,b=this.$primaryActions.is(":visible")?this.$primaryActions.width():0,c=Math.max(a,b),d=this.title.$element.width(),e>2*c+d?f=g=c:"ltr"===this.getDir()?(f=a,g=b):(f=b,g=a),this.$location.css({paddingLeft:f,paddingRight:g}),this},a.ui.ProcessDialog.prototype.showErrors=function(b){var c,d,e,f,g=[],h={},i=!0,j=!1;for(b instanceof a.ui.Error&&(b=[b]),c=0,d=b.length;d>c;c++)b[c].isRecoverable()||(i=!1),b[c].isWarning()&&(j=!0),e=$("<div>").addClass("oo-ui-processDialog-error").append(b[c].getMessage()),g.push(e[0]);this.$errorItems=$(g),i?(h[this.currentAction]=!0,f=this.actions.get({actions:this.currentAction}),f.length&&this.retryButton.clearFlags().setFlags(f[0].getFlags())):(h[this.currentAction]=!1,this.actions.setAbilities(h)),j?this.retryButton.setLabel(a.ui.msg("ooui-dialog-process-continue")):this.retryButton.setLabel(a.ui.msg("ooui-dialog-process-retry")),this.retryButton.toggle(i),this.$errorsTitle.after(this.$errorItems),this.$errors.removeClass("oo-ui-element-hidden").scrollTop(0)},a.ui.ProcessDialog.prototype.hideErrors=function(){this.$errors.addClass("oo-ui-element-hidden"),this.$errorItems&&(this.$errorItems.remove(),this.$errorItems=null)},a.ui.ProcessDialog.prototype.getTeardownProcess=function(b){return a.ui.ProcessDialog.parent.prototype.getTeardownProcess.call(this,b).first(function(){this.hideErrors(),this.fitOnOpen=!1},this)},a.ui.FieldLayout=function(b,c){var d,e;if(a.isPlainObject(b)&&void 0===c&&(c=b,b=c.fieldWidget),void 0===b)throw new Error("Widget not found");d=b.constructor["static"].supportsSimpleLabel,c=$.extend({align:"left"},c),a.ui.FieldLayout.parent.call(this,c),a.ui.mixin.LabelElement.call(this,c),a.ui.mixin.TitledElement.call(this,$.extend({},c,{$titled:this.$label})),this.fieldWidget=b,this.errors=[],this.notices=[],this.$field=$("<div>"),this.$messages=$("<ul>"),this.$body=$("<"+(d?"label":"div")+">"),this.align=null,c.help?(this.popupButtonWidget=new a.ui.PopupButtonWidget({classes:["oo-ui-fieldLayout-help"],framed:!1,icon:"info"}),e=$("<div>"),c.help instanceof a.ui.HtmlSnippet?e.html(c.help.toString()):e.text(c.help),this.popupButtonWidget.getPopup().$body.append(e.addClass("oo-ui-fieldLayout-help-content")),this.$help=this.popupButtonWidget.$element):this.$help=$([]),d&&this.$label.on("click",this.onLabelClick.bind(this)),this.fieldWidget.connect(this,{disable:"onFieldDisable"}),this.$element.addClass("oo-ui-fieldLayout").append(this.$help,this.$body),this.$body.addClass("oo-ui-fieldLayout-body"),this.$messages.addClass("oo-ui-fieldLayout-messages"),this.$field.addClass("oo-ui-fieldLayout-field").toggleClass("oo-ui-fieldLayout-disable",this.fieldWidget.isDisabled()).append(this.fieldWidget.$element),this.setErrors(c.errors||[]),this.setNotices(c.notices||[]),this.setAlignment(c.align)},a.inheritClass(a.ui.FieldLayout,a.ui.Layout),a.mixinClass(a.ui.FieldLayout,a.ui.mixin.LabelElement),a.mixinClass(a.ui.FieldLayout,a.ui.mixin.TitledElement),a.ui.FieldLayout.prototype.onFieldDisable=function(a){this.$element.toggleClass("oo-ui-fieldLayout-disabled",a)},a.ui.FieldLayout.prototype.onLabelClick=function(){return this.fieldWidget.simulateLabelClick(),!1},a.ui.FieldLayout.prototype.getField=function(){return this.fieldWidget},a.ui.FieldLayout.prototype.makeMessage=function(b,c){var d,e,f;return d=$("<li>"),e="error"===b?new a.ui.IconWidget({icon:"alert",flags:["warning"]}).$element:"notice"===b?new a.ui.IconWidget({icon:"info"}).$element:"",f=new a.ui.LabelWidget({label:c}),d.append(e,f.$element).addClass("oo-ui-fieldLayout-messages-"+b),d},a.ui.FieldLayout.prototype.setAlignment=function(a){return a!==this.align&&(-1===["left","right","top","inline"].indexOf(a)&&(a="left"),"inline"===a?this.$body.append(this.$field,this.$label):this.$body.append(this.$label,this.$field),this.align&&this.$element.removeClass("oo-ui-fieldLayout-align-"+this.align),this.$element.addClass("oo-ui-fieldLayout-align-"+a),this.align=a),this},a.ui.FieldLayout.prototype.setErrors=function(a){return this.errors=a.slice(),this.updateMessages(),this},a.ui.FieldLayout.prototype.setNotices=function(a){return this.notices=a.slice(),this.updateMessages(),this},a.ui.FieldLayout.prototype.updateMessages=function(){var a;if(this.$messages.empty(),!this.errors.length&&!this.notices.length)return void this.$messages.remove();for(this.$body.after(this.$messages),a=0;a<this.notices.length;a++)this.$messages.append(this.makeMessage("notice",this.notices[a]));for(a=0;a<this.errors.length;a++)this.$messages.append(this.makeMessage("error",this.errors[a]))},a.ui.ActionFieldLayout=function(b,c,d){a.isPlainObject(b)&&void 0===d&&(d=b,b=d.fieldWidget,c=d.buttonWidget),a.ui.ActionFieldLayout.parent.call(this,b,d),this.buttonWidget=c,this.$button=$("<div>"),this.$input=$("<div>"),this.$element.addClass("oo-ui-actionFieldLayout"),this.$button.addClass("oo-ui-actionFieldLayout-button").append(this.buttonWidget.$element),this.$input.addClass("oo-ui-actionFieldLayout-input").append(this.fieldWidget.$element),this.$field.append(this.$input,this.$button)},a.inheritClass(a.ui.ActionFieldLayout,a.ui.FieldLayout),a.ui.FieldsetLayout=function(b){b=b||{},a.ui.FieldsetLayout.parent.call(this,b),a.ui.mixin.IconElement.call(this,b),a.ui.mixin.LabelElement.call(this,b),a.ui.mixin.GroupElement.call(this,b),b.help?(this.popupButtonWidget=new a.ui.PopupButtonWidget({classes:["oo-ui-fieldsetLayout-help"],framed:!1,icon:"info"}),this.popupButtonWidget.getPopup().$body.append($("<div>").text(b.help).addClass("oo-ui-fieldsetLayout-help-content")),this.$help=this.popupButtonWidget.$element):this.$help=$([]),this.$element.addClass("oo-ui-fieldsetLayout").prepend(this.$help,this.$icon,this.$label,this.$group),Array.isArray(b.items)&&this.addItems(b.items)},a.inheritClass(a.ui.FieldsetLayout,a.ui.Layout),a.mixinClass(a.ui.FieldsetLayout,a.ui.mixin.IconElement),a.mixinClass(a.ui.FieldsetLayout,a.ui.mixin.LabelElement),a.mixinClass(a.ui.FieldsetLayout,a.ui.mixin.GroupElement),a.ui.FormLayout=function(b){if(b=b||{},a.ui.FormLayout.parent.call(this,b),a.ui.mixin.GroupElement.call(this,$.extend({},b,{$group:this.$element})),this.$element.on("submit",this.onFormSubmit.bind(this)),void 0!==b.action&&!a.ui.isSafeUrl(b.action))throw new Error("Potentially unsafe action provided: "+b.action);this.$element.addClass("oo-ui-formLayout").attr({method:b.method,action:b.action,enctype:b.enctype}),Array.isArray(b.items)&&this.addItems(b.items)},a.inheritClass(a.ui.FormLayout,a.ui.Layout),a.mixinClass(a.ui.FormLayout,a.ui.mixin.GroupElement),a.ui.FormLayout["static"].tagName="form",a.ui.FormLayout.prototype.onFormSubmit=function(){return this.emit("submit")?!1:void 0},a.ui.MenuLayout=function(b){b=$.extend({showMenu:!0,menuPosition:"before"},b),a.ui.MenuLayout.parent.call(this,b),this.$menu=$("<div>"),this.$content=$("<div>"),this.$menu.addClass("oo-ui-menuLayout-menu"),this.$content.addClass("oo-ui-menuLayout-content"),this.$element.addClass("oo-ui-menuLayout").append(this.$content,this.$menu),this.setMenuPosition(b.menuPosition),this.toggleMenu(b.showMenu)},a.inheritClass(a.ui.MenuLayout,a.ui.Layout),a.ui.MenuLayout.prototype.toggleMenu=function(a){return a=void 0===a?!this.showMenu:!!a,this.showMenu!==a&&(this.showMenu=a,this.$element.toggleClass("oo-ui-menuLayout-showMenu",this.showMenu).toggleClass("oo-ui-menuLayout-hideMenu",!this.showMenu)),this},a.ui.MenuLayout.prototype.isMenuVisible=function(){return this.showMenu},a.ui.MenuLayout.prototype.setMenuPosition=function(a){return this.$element.removeClass("oo-ui-menuLayout-"+this.menuPosition),this.menuPosition=a,this.$element.addClass("oo-ui-menuLayout-"+a),this},a.ui.MenuLayout.prototype.getMenuPosition=function(){return this.menuPosition},a.ui.BookletLayout=function(b){b=b||{},a.ui.BookletLayout.parent.call(this,b),this.currentPageName=null,this.pages={},this.ignoreFocus=!1,this.stackLayout=new a.ui.StackLayout({continuous:!!b.continuous}),this.$content.append(this.stackLayout.$element),this.autoFocus=void 0===b.autoFocus||!!b.autoFocus,this.outlineVisible=!1,this.outlined=!!b.outlined,this.outlined&&(this.editable=!!b.editable,this.outlineControlsWidget=null,this.outlineSelectWidget=new a.ui.OutlineSelectWidget,this.outlinePanel=new a.ui.PanelLayout({scrollable:!0}),this.$menu.append(this.outlinePanel.$element),this.outlineVisible=!0,this.editable&&(this.outlineControlsWidget=new a.ui.OutlineControlsWidget(this.outlineSelectWidget))),this.toggleMenu(this.outlined),this.stackLayout.connect(this,{set:"onStackLayoutSet"}),this.outlined&&(this.outlineSelectWidget.connect(this,{select:"onOutlineSelectWidgetSelect"}),this.scrolling=!1,this.stackLayout.connect(this,{visibleItemChange:"onStackLayoutVisibleItemChange"})),this.autoFocus&&this.stackLayout.$element.on("focusin",this.onStackLayoutFocus.bind(this)),this.$element.addClass("oo-ui-bookletLayout"),this.stackLayout.$element.addClass("oo-ui-bookletLayout-stackLayout"),this.outlined&&(this.outlinePanel.$element.addClass("oo-ui-bookletLayout-outlinePanel").append(this.outlineSelectWidget.$element),this.editable&&this.outlinePanel.$element.addClass("oo-ui-bookletLayout-outlinePanel-editable").append(this.outlineControlsWidget.$element))},a.inheritClass(a.ui.BookletLayout,a.ui.MenuLayout),a.ui.BookletLayout.prototype.onStackLayoutFocus=function(a){var b,c;c=$(a.target).closest(".oo-ui-pageLayout");for(b in this.pages)if(this.pages[b].$element[0]===c[0]&&b!==this.currentPageName){this.setPage(b);break}},a.ui.BookletLayout.prototype.onStackLayoutVisibleItemChange=function(a){this.scrolling=!0,this.outlineSelectWidget.selectItemByData(a.getName()),this.scrolling=!1},a.ui.BookletLayout.prototype.onStackLayoutSet=function(a){var b=this;!this.scrolling&&a&&a.scrollElementIntoView({complete:function(){b.autoFocus&&b.focus()}})},a.ui.BookletLayout.prototype.focus=function(b){var c,d=this.stackLayout.getItems();c=void 0!==b&&d[b]?d[b]:this.stackLayout.getCurrentItem(),!c&&this.outlined&&(this.selectFirstSelectablePage(),c=this.stackLayout.getCurrentItem()),c&&(a.ui.contains(c.$element[0],this.getElementDocument().activeElement,!0)||c.focus())},a.ui.BookletLayout.prototype.focusFirstFocusable=function(){a.ui.findFocusable(this.stackLayout.$element).focus()},a.ui.BookletLayout.prototype.onOutlineSelectWidgetSelect=function(a){a&&this.setPage(a.getData())},a.ui.BookletLayout.prototype.isOutlined=function(){return this.outlined},a.ui.BookletLayout.prototype.isEditable=function(){return this.editable},a.ui.BookletLayout.prototype.isOutlineVisible=function(){return this.outlined&&this.outlineVisible},a.ui.BookletLayout.prototype.toggleOutline=function(a){return this.outlined&&(a=void 0===a?!this.outlineVisible:!!a,this.outlineVisible=a,this.toggleMenu(a)),this},a.ui.BookletLayout.prototype.getClosestPage=function(a){var b,c,d,e=this.stackLayout.getItems(),f=e.indexOf(a);if(-1!==f&&(b=e[f+1],c=e[f-1],this.outlined)){if(d=this.outlineSelectWidget.getItemFromData(a.getName()).getLevel(),c&&d===this.outlineSelectWidget.getItemFromData(c.getName()).getLevel())return c;if(b&&d===this.outlineSelectWidget.getItemFromData(b.getName()).getLevel())return b}return c||b||null},a.ui.BookletLayout.prototype.getOutline=function(){return this.outlineSelectWidget},a.ui.BookletLayout.prototype.getOutlineControls=function(){return this.outlineControlsWidget},a.ui.BookletLayout.prototype.getPage=function(a){return this.pages[a]},a.ui.BookletLayout.prototype.getCurrentPage=function(){var a=this.getCurrentPageName();return a?this.getPage(a):void 0},a.ui.BookletLayout.prototype.getCurrentPageName=function(){return this.currentPageName},a.ui.BookletLayout.prototype.addPages=function(b,c){var d,e,f,g,h,i,j=this.stackLayout.getItems(),k=[],l=[];for(d=0,e=b.length;e>d;d++)g=b[d],f=g.getName(),Object.prototype.hasOwnProperty.call(this.pages,f)&&(i=j.indexOf(this.pages[f]),-1!==i&&c>i+1&&c--,k.push(this.pages[f]));for(k.length&&this.removePages(k),d=0,e=b.length;e>d;d++)g=b[d],f=g.getName(),this.pages[g.getName()]=g,this.outlined&&(h=new a.ui.OutlineOptionWidget({data:f}),g.setOutlineItem(h),l.push(h));return this.outlined&&l.length&&(this.outlineSelectWidget.addItems(l,c),this.selectFirstSelectablePage()),this.stackLayout.addItems(b,c),this.emit("add",b,c),this},a.ui.BookletLayout.prototype.removePages=function(a){var b,c,d,e,f=[];for(b=0,c=a.length;c>b;b++)e=a[b],d=e.getName(),delete this.pages[d],this.outlined&&(f.push(this.outlineSelectWidget.getItemFromData(d)),
e.setOutlineItem(null));return this.outlined&&f.length&&(this.outlineSelectWidget.removeItems(f),this.selectFirstSelectablePage()),this.stackLayout.removeItems(a),this.emit("remove",a),this},a.ui.BookletLayout.prototype.clearPages=function(){var a,b,c=this.stackLayout.getItems();if(this.pages={},this.currentPageName=null,this.outlined)for(this.outlineSelectWidget.clearItems(),a=0,b=c.length;b>a;a++)c[a].setOutlineItem(null);return this.stackLayout.clearItems(),this.emit("remove",c),this},a.ui.BookletLayout.prototype.setPage=function(b){var c,d,e=this.pages[b],f=this.currentPageName&&this.pages[this.currentPageName];b!==this.currentPageName&&(this.outlined&&(c=this.outlineSelectWidget.getSelectedItem(),c&&c.getData()!==b&&this.outlineSelectWidget.selectItemByData(b)),e&&(f&&(f.setActive(!1),this.autoFocus&&this.stackLayout.continuous&&0!==a.ui.findFocusable(e.$element).length&&(d=f.$element.find(":focus"),d.length&&d[0].blur())),this.currentPageName=b,e.setActive(!0),this.stackLayout.setItem(e),!this.stackLayout.continuous&&f&&(d=f.$element.find(":focus"),d.length&&d[0].blur()),this.emit("set",e)))},a.ui.BookletLayout.prototype.selectFirstSelectablePage=function(){return this.outlineSelectWidget.getSelectedItem()||this.outlineSelectWidget.selectItem(this.outlineSelectWidget.getFirstSelectableItem()),this},a.ui.IndexLayout=function(b){b=$.extend({},b,{menuPosition:"top"}),a.ui.IndexLayout.parent.call(this,b),this.currentCardName=null,this.cards={},this.ignoreFocus=!1,this.stackLayout=new a.ui.StackLayout({continuous:!!b.continuous,expanded:b.expanded}),this.$content.append(this.stackLayout.$element),this.autoFocus=void 0===b.autoFocus||!!b.autoFocus,this.tabSelectWidget=new a.ui.TabSelectWidget,this.tabPanel=new a.ui.PanelLayout,this.$menu.append(this.tabPanel.$element),this.toggleMenu(!0),this.stackLayout.connect(this,{set:"onStackLayoutSet"}),this.tabSelectWidget.connect(this,{select:"onTabSelectWidgetSelect"}),this.autoFocus&&this.stackLayout.$element.on("focusin",this.onStackLayoutFocus.bind(this)),this.$element.addClass("oo-ui-indexLayout"),this.stackLayout.$element.addClass("oo-ui-indexLayout-stackLayout"),this.tabPanel.$element.addClass("oo-ui-indexLayout-tabPanel").append(this.tabSelectWidget.$element)},a.inheritClass(a.ui.IndexLayout,a.ui.MenuLayout),a.ui.IndexLayout.prototype.onStackLayoutFocus=function(a){var b,c;c=$(a.target).closest(".oo-ui-cardLayout");for(b in this.cards)if(this.cards[b].$element[0]===c[0]&&b!==this.currentCardName){this.setCard(b);break}},a.ui.IndexLayout.prototype.onStackLayoutSet=function(a){var b=this;a&&a.scrollElementIntoView({complete:function(){b.autoFocus&&b.focus()}})},a.ui.IndexLayout.prototype.focus=function(b){var c,d=this.stackLayout.getItems();c=void 0!==b&&d[b]?d[b]:this.stackLayout.getCurrentItem(),c||(this.selectFirstSelectableCard(),c=this.stackLayout.getCurrentItem()),c&&(a.ui.contains(c.$element[0],this.getElementDocument().activeElement,!0)||c.focus())},a.ui.IndexLayout.prototype.focusFirstFocusable=function(){a.ui.findFocusable(this.stackLayout.$element).focus()},a.ui.IndexLayout.prototype.onTabSelectWidgetSelect=function(a){a&&this.setCard(a.getData())},a.ui.IndexLayout.prototype.getClosestCard=function(a){var b,c,d,e=this.stackLayout.getItems(),f=e.indexOf(a);if(-1!==f){if(b=e[f+1],c=e[f-1],d=this.tabSelectWidget.getItemFromData(a.getName()).getLevel(),c&&d===this.tabSelectWidget.getItemFromData(c.getName()).getLevel())return c;if(b&&d===this.tabSelectWidget.getItemFromData(b.getName()).getLevel())return b}return c||b||null},a.ui.IndexLayout.prototype.getTabs=function(){return this.tabSelectWidget},a.ui.IndexLayout.prototype.getCard=function(a){return this.cards[a]},a.ui.IndexLayout.prototype.getCurrentCard=function(){var a=this.getCurrentCardName();return a?this.getCard(a):void 0},a.ui.IndexLayout.prototype.getCurrentCardName=function(){return this.currentCardName},a.ui.IndexLayout.prototype.addCards=function(b,c){var d,e,f,g,h,i,j=this.stackLayout.getItems(),k=[],l=[];for(d=0,e=b.length;e>d;d++)g=b[d],f=g.getName(),Object.prototype.hasOwnProperty.call(this.cards,f)&&(i=j.indexOf(this.cards[f]),-1!==i&&c>i+1&&c--,k.push(this.cards[f]));for(k.length&&this.removeCards(k),d=0,e=b.length;e>d;d++)g=b[d],f=g.getName(),this.cards[g.getName()]=g,h=new a.ui.TabOptionWidget({data:f}),g.setTabItem(h),l.push(h);return l.length&&(this.tabSelectWidget.addItems(l,c),this.selectFirstSelectableCard()),this.stackLayout.addItems(b,c),this.emit("add",b,c),this},a.ui.IndexLayout.prototype.removeCards=function(a){var b,c,d,e,f=[];for(b=0,c=a.length;c>b;b++)e=a[b],d=e.getName(),delete this.cards[d],f.push(this.tabSelectWidget.getItemFromData(d)),e.setTabItem(null);return f.length&&(this.tabSelectWidget.removeItems(f),this.selectFirstSelectableCard()),this.stackLayout.removeItems(a),this.emit("remove",a),this},a.ui.IndexLayout.prototype.clearCards=function(){var a,b,c=this.stackLayout.getItems();for(this.cards={},this.currentCardName=null,this.tabSelectWidget.clearItems(),a=0,b=c.length;b>a;a++)c[a].setTabItem(null);return this.stackLayout.clearItems(),this.emit("remove",c),this},a.ui.IndexLayout.prototype.setCard=function(b){var c,d,e=this.cards[b],f=this.currentCardName&&this.cards[this.currentCardName];b!==this.currentCardName&&(c=this.tabSelectWidget.getSelectedItem(),c&&c.getData()!==b&&this.tabSelectWidget.selectItemByData(b),e&&(f&&(f.setActive(!1),this.autoFocus&&this.stackLayout.continuous&&0!==a.ui.findFocusable(e.$element).length&&(d=f.$element.find(":focus"),d.length&&d[0].blur())),this.currentCardName=b,e.setActive(!0),this.stackLayout.setItem(e),!this.stackLayout.continuous&&f&&(d=f.$element.find(":focus"),d.length&&d[0].blur()),this.emit("set",e)))},a.ui.IndexLayout.prototype.selectFirstSelectableCard=function(){return this.tabSelectWidget.getSelectedItem()||this.tabSelectWidget.selectItem(this.tabSelectWidget.getFirstSelectableItem()),this},a.ui.PanelLayout=function(b){b=$.extend({scrollable:!1,padded:!1,expanded:!0,framed:!1},b),a.ui.PanelLayout.parent.call(this,b),this.$element.addClass("oo-ui-panelLayout"),b.scrollable&&this.$element.addClass("oo-ui-panelLayout-scrollable"),b.padded&&this.$element.addClass("oo-ui-panelLayout-padded"),b.expanded&&this.$element.addClass("oo-ui-panelLayout-expanded"),b.framed&&this.$element.addClass("oo-ui-panelLayout-framed")},a.inheritClass(a.ui.PanelLayout,a.ui.Layout),a.ui.PanelLayout.prototype.focus=function(){a.ui.findFocusable(this.$element).focus()},a.ui.CardLayout=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.name),c=$.extend({scrollable:!0},c),a.ui.CardLayout.parent.call(this,c),this.name=b,this.label=c.label,this.tabItem=null,this.active=!1,this.$element.addClass("oo-ui-cardLayout")},a.inheritClass(a.ui.CardLayout,a.ui.PanelLayout),a.ui.CardLayout.prototype.getName=function(){return this.name},a.ui.CardLayout.prototype.isActive=function(){return this.active},a.ui.CardLayout.prototype.getTabItem=function(){return this.tabItem},a.ui.CardLayout.prototype.setTabItem=function(a){return this.tabItem=a||null,a&&this.setupTabItem(),this},a.ui.CardLayout.prototype.setupTabItem=function(){return this.label&&this.tabItem.setLabel(this.label),this},a.ui.CardLayout.prototype.setActive=function(a){a=!!a,a!==this.active&&(this.active=a,this.$element.toggleClass("oo-ui-cardLayout-active",this.active),this.emit("active",this.active))},a.ui.PageLayout=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.name),c=$.extend({scrollable:!0},c),a.ui.PageLayout.parent.call(this,c),this.name=b,this.outlineItem=null,this.active=!1,this.$element.addClass("oo-ui-pageLayout")},a.inheritClass(a.ui.PageLayout,a.ui.PanelLayout),a.ui.PageLayout.prototype.getName=function(){return this.name},a.ui.PageLayout.prototype.isActive=function(){return this.active},a.ui.PageLayout.prototype.getOutlineItem=function(){return this.outlineItem},a.ui.PageLayout.prototype.setOutlineItem=function(a){return this.outlineItem=a||null,a&&this.setupOutlineItem(),this},a.ui.PageLayout.prototype.setupOutlineItem=function(){return this},a.ui.PageLayout.prototype.setActive=function(a){a=!!a,a!==this.active&&(this.active=a,this.$element.toggleClass("oo-ui-pageLayout-active",a),this.emit("active",this.active))},a.ui.StackLayout=function(b){b=$.extend({scrollable:!0},b),a.ui.StackLayout.parent.call(this,b),a.ui.mixin.GroupElement.call(this,$.extend({},b,{$group:this.$element})),this.currentItem=null,this.continuous=!!b.continuous,this.$element.addClass("oo-ui-stackLayout"),this.continuous&&(this.$element.addClass("oo-ui-stackLayout-continuous"),this.$element.on("scroll",a.ui.debounce(this.onScroll.bind(this),250))),Array.isArray(b.items)&&this.addItems(b.items)},a.inheritClass(a.ui.StackLayout,a.ui.PanelLayout),a.mixinClass(a.ui.StackLayout,a.ui.mixin.GroupElement),a.ui.StackLayout.prototype.onScroll=function(){function a(a){return a.$element[0].getBoundingClientRect()}function b(b){var c=a(b);return c.bottom>g.top&&c.top<g.bottom}var c,d=this.items.length,e=this.items.indexOf(this.currentItem),f=e,g=this.$element[0].getBoundingClientRect();if(g&&(g.top||g.bottom)){if(c=a(this.currentItem),c.bottom<g.top)for(;++f<d&&!b(this.items[f]););else if(c.top>g.bottom)for(;--f>=0&&!b(this.items[f]););f!==e&&this.emit("visibleItemChange",this.items[f])}},a.ui.StackLayout.prototype.getCurrentItem=function(){return this.currentItem},a.ui.StackLayout.prototype.unsetCurrentItem=function(){var a=this.currentItem;null!==a&&(this.currentItem=null,this.emit("set",null))},a.ui.StackLayout.prototype.addItems=function(b,c){return this.updateHiddenState(b,this.currentItem),a.ui.mixin.GroupElement.prototype.addItems.call(this,b,c),!this.currentItem&&b.length&&this.setItem(b[0]),this},a.ui.StackLayout.prototype.removeItems=function(b){return a.ui.mixin.GroupElement.prototype.removeItems.call(this,b),-1!==b.indexOf(this.currentItem)&&(this.items.length?this.setItem(this.items[0]):this.unsetCurrentItem()),this},a.ui.StackLayout.prototype.clearItems=function(){return this.unsetCurrentItem(),a.ui.mixin.GroupElement.prototype.clearItems.call(this),this},a.ui.StackLayout.prototype.setItem=function(a){return a!==this.currentItem&&(this.updateHiddenState(this.items,a),-1!==this.items.indexOf(a)?(this.currentItem=a,this.emit("set",a)):this.unsetCurrentItem()),this},a.ui.StackLayout.prototype.updateHiddenState=function(a,b){var c,d;if(!this.continuous){for(c=0,d=a.length;d>c;c++)b&&b===a[c]||a[c].$element.addClass("oo-ui-element-hidden");b&&b.$element.removeClass("oo-ui-element-hidden")}},a.ui.HorizontalLayout=function(b){b=b||{},a.ui.HorizontalLayout.parent.call(this,b),a.ui.mixin.GroupElement.call(this,$.extend({},b,{$group:this.$element})),this.$element.addClass("oo-ui-horizontalLayout"),Array.isArray(b.items)&&this.addItems(b.items)},a.inheritClass(a.ui.HorizontalLayout,a.ui.Layout),a.mixinClass(a.ui.HorizontalLayout,a.ui.mixin.GroupElement),a.ui.BarToolGroup=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.toolbar),a.ui.BarToolGroup.parent.call(this,b,c),this.$element.addClass("oo-ui-barToolGroup")},a.inheritClass(a.ui.BarToolGroup,a.ui.ToolGroup),a.ui.BarToolGroup["static"].titleTooltips=!0,a.ui.BarToolGroup["static"].accelTooltips=!0,a.ui.BarToolGroup["static"].name="bar",a.ui.PopupToolGroup=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.toolbar),c=c||{},a.ui.PopupToolGroup.parent.call(this,b,c),this.active=!1,this.dragging=!1,this.onBlurHandler=this.onBlur.bind(this),this.$handle=$("<span>"),a.ui.mixin.IconElement.call(this,c),a.ui.mixin.IndicatorElement.call(this,c),a.ui.mixin.LabelElement.call(this,c),a.ui.mixin.TitledElement.call(this,c),a.ui.mixin.ClippableElement.call(this,$.extend({},c,{$clippable:this.$group})),a.ui.mixin.TabIndexedElement.call(this,$.extend({},c,{$tabIndexed:this.$handle})),this.$handle.on({keydown:this.onHandleMouseKeyDown.bind(this),keyup:this.onHandleMouseKeyUp.bind(this),mousedown:this.onHandleMouseKeyDown.bind(this),mouseup:this.onHandleMouseKeyUp.bind(this)}),this.$handle.addClass("oo-ui-popupToolGroup-handle").append(this.$icon,this.$label,this.$indicator),void 0!==c.header&&this.$group.prepend($("<span>").addClass("oo-ui-popupToolGroup-header").text(c.header)),this.$element.addClass("oo-ui-popupToolGroup").prepend(this.$handle)},a.inheritClass(a.ui.PopupToolGroup,a.ui.ToolGroup),a.mixinClass(a.ui.PopupToolGroup,a.ui.mixin.IconElement),a.mixinClass(a.ui.PopupToolGroup,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.PopupToolGroup,a.ui.mixin.LabelElement),a.mixinClass(a.ui.PopupToolGroup,a.ui.mixin.TitledElement),a.mixinClass(a.ui.PopupToolGroup,a.ui.mixin.ClippableElement),a.mixinClass(a.ui.PopupToolGroup,a.ui.mixin.TabIndexedElement),a.ui.PopupToolGroup.prototype.setDisabled=function(){a.ui.PopupToolGroup.parent.prototype.setDisabled.apply(this,arguments),this.isDisabled()&&this.isElementAttached()&&this.setActive(!1)},a.ui.PopupToolGroup.prototype.onBlur=function(a){$(a.target).closest(".oo-ui-popupToolGroup")[0]!==this.$element[0]&&this.setActive(!1)},a.ui.PopupToolGroup.prototype.onMouseKeyUp=function(b){return this.isDisabled()||!this.pressed||this.pressed!==this.getTargetTool(b)||1!==b.which&&b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER||this.setActive(!1),a.ui.PopupToolGroup.parent.prototype.onMouseKeyUp.call(this,b)},a.ui.PopupToolGroup.prototype.onHandleMouseKeyUp=function(b){return this.isDisabled()||1!==b.which&&b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER?void 0:!1},a.ui.PopupToolGroup.prototype.onHandleMouseKeyDown=function(b){return this.isDisabled()||1!==b.which&&b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER?void 0:(this.setActive(!this.active),!1)},a.ui.PopupToolGroup.prototype.setActive=function(b){var c,d;b=!!b,this.active!==b&&(this.active=b,b?(a.ui.addCaptureEventListener(this.getElementDocument(),"mouseup",this.onBlurHandler),a.ui.addCaptureEventListener(this.getElementDocument(),"keyup",this.onBlurHandler),this.$clippable.css("left",""),this.$element.addClass("oo-ui-popupToolGroup-active oo-ui-popupToolGroup-left"),this.toggleClipping(!0),this.isClippedHorizontally()&&(this.toggleClipping(!1),this.$element.removeClass("oo-ui-popupToolGroup-left").addClass("oo-ui-popupToolGroup-right"),this.toggleClipping(!0)),this.isClippedHorizontally()&&(c=this.$clippableScrollableContainer.width(),d=this.$clippableScrollableContainer.offset().left,this.toggleClipping(!1),this.$element.removeClass("oo-ui-popupToolGroup-right"),this.$clippable.css({left:-(this.$element.offset().left-d),width:c}))):(a.ui.removeCaptureEventListener(this.getElementDocument(),"mouseup",this.onBlurHandler),a.ui.removeCaptureEventListener(this.getElementDocument(),"keyup",this.onBlurHandler),this.$element.removeClass("oo-ui-popupToolGroup-active oo-ui-popupToolGroup-left  oo-ui-popupToolGroup-right"),this.toggleClipping(!1)))},a.ui.ListToolGroup=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.toolbar),c=c||{},this.allowCollapse=c.allowCollapse,this.forceExpand=c.forceExpand,this.expanded=void 0!==c.expanded?c.expanded:!1,this.collapsibleTools=[],a.ui.ListToolGroup.parent.call(this,b,c),this.$element.addClass("oo-ui-listToolGroup")},a.inheritClass(a.ui.ListToolGroup,a.ui.PopupToolGroup),a.ui.ListToolGroup["static"].name="list",a.ui.ListToolGroup.prototype.populate=function(){var b,c,d=[];for(a.ui.ListToolGroup.parent.prototype.populate.call(this),void 0!==this.allowCollapse?d=this.allowCollapse:void 0!==this.forceExpand&&(d=a.simpleArrayDifference(Object.keys(this.tools),this.forceExpand)),this.collapsibleTools=[],b=0,c=d.length;c>b;b++)void 0!==this.tools[d[b]]&&this.collapsibleTools.push(this.tools[d[b]]);this.$group.append(this.getExpandCollapseTool().$element),this.getExpandCollapseTool().toggle(0!==this.collapsibleTools.length),this.updateCollapsibleState()},a.ui.ListToolGroup.prototype.getExpandCollapseTool=function(){var b;return void 0===this.expandCollapseTool&&(b=function(){b.parent.apply(this,arguments)},a.inheritClass(b,a.ui.Tool),b.prototype.onSelect=function(){this.toolGroup.expanded=!this.toolGroup.expanded,this.toolGroup.updateCollapsibleState(),this.setActive(!1)},b.prototype.onUpdateState=function(){},b["static"].name="more-fewer",this.expandCollapseTool=new b(this)),this.expandCollapseTool},a.ui.ListToolGroup.prototype.onMouseKeyUp=function(b){return!$(b.target).closest(".oo-ui-tool-name-more-fewer").length||1!==b.which&&b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER?a.ui.ListToolGroup.parent.prototype.onMouseKeyUp.call(this,b):a.ui.ListToolGroup.parent.parent.prototype.onMouseKeyUp.call(this,b)},a.ui.ListToolGroup.prototype.updateCollapsibleState=function(){var b,c;for(this.getExpandCollapseTool().setIcon(this.expanded?"collapse":"expand").setTitle(a.ui.msg(this.expanded?"ooui-toolgroup-collapse":"ooui-toolgroup-expand")),b=0,c=this.collapsibleTools.length;c>b;b++)this.collapsibleTools[b].toggle(this.expanded)},a.ui.MenuToolGroup=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.toolbar),c=c||{},a.ui.MenuToolGroup.parent.call(this,b,c),this.toolbar.connect(this,{updateState:"onUpdateState"}),this.$element.addClass("oo-ui-menuToolGroup")},a.inheritClass(a.ui.MenuToolGroup,a.ui.PopupToolGroup),a.ui.MenuToolGroup["static"].name="menu",a.ui.MenuToolGroup.prototype.onUpdateState=function(){var a,b=[];for(a in this.tools)this.tools[a].isActive()&&b.push(this.tools[a].getTitle());this.setLabel(b.join(", ")||" ")},a.ui.PopupTool=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.toolGroup),a.ui.PopupTool.parent.call(this,b,c),a.ui.mixin.PopupElement.call(this,c),this.$element.addClass("oo-ui-popupTool").append(this.popup.$element)},a.inheritClass(a.ui.PopupTool,a.ui.Tool),a.mixinClass(a.ui.PopupTool,a.ui.mixin.PopupElement),a.ui.PopupTool.prototype.onSelect=function(){return this.isDisabled()||this.popup.toggle(),this.setActive(!1),!1},a.ui.PopupTool.prototype.onUpdateState=function(){this.setActive(!1)},a.ui.ToolGroupTool=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.toolGroup),a.ui.ToolGroupTool.parent.call(this,b,c),this.innerToolGroup=this.createGroup(this.constructor["static"].groupConfig),this.innerToolGroup.connect(this,{disable:"onToolGroupDisable"}),this.$link.remove(),this.$element.addClass("oo-ui-toolGroupTool").append(this.innerToolGroup.$element)},a.inheritClass(a.ui.ToolGroupTool,a.ui.Tool),a.ui.ToolGroupTool["static"].groupConfig={},a.ui.ToolGroupTool.prototype.onSelect=function(){return this.innerToolGroup.setActive(!this.innerToolGroup.active),!1},a.ui.ToolGroupTool.prototype.onToolGroupDisable=function(a){this.setDisabled(a)},a.ui.ToolGroupTool.prototype.onUpdateState=function(){this.setActive(!1)},a.ui.ToolGroupTool.prototype.createGroup=function(b){return"*"===b.include&&void 0===b.label&&(b.label=a.ui.msg("ooui-toolbar-more")),this.toolbar.getToolGroupFactory().create("list",this.toolbar,b)},a.ui.mixin.GroupWidget=function(b){a.ui.mixin.GroupWidget.parent.call(this,b)},a.inheritClass(a.ui.mixin.GroupWidget,a.ui.mixin.GroupElement),a.ui.mixin.GroupWidget.prototype.setDisabled=function(b){var c,d;if(a.ui.Widget.prototype.setDisabled.call(this,b),this.items)for(c=0,d=this.items.length;d>c;c++)this.items[c].updateDisabled();return this},a.ui.mixin.ItemWidget=function(){},a.ui.mixin.ItemWidget.prototype.isDisabled=function(){return this.disabled||this.elementGroup instanceof a.ui.Widget&&this.elementGroup.isDisabled()},a.ui.mixin.ItemWidget.prototype.setElementGroup=function(b){return a.ui.Element.prototype.setElementGroup.call(this,b),this.updateDisabled(),this},a.ui.OutlineControlsWidget=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.outline),c=$.extend({icon:"add"},c),a.ui.OutlineControlsWidget.parent.call(this,c),a.ui.mixin.GroupElement.call(this,c),a.ui.mixin.IconElement.call(this,c),this.outline=b,this.$movers=$("<div>"),this.upButton=new a.ui.ButtonWidget({framed:!1,icon:"collapse",title:a.ui.msg("ooui-outline-control-move-up")}),this.downButton=new a.ui.ButtonWidget({framed:!1,icon:"expand",title:a.ui.msg("ooui-outline-control-move-down")}),this.removeButton=new a.ui.ButtonWidget({framed:!1,icon:"remove",title:a.ui.msg("ooui-outline-control-remove")}),this.abilities={move:!0,remove:!0},b.connect(this,{select:"onOutlineChange",add:"onOutlineChange",remove:"onOutlineChange"}),this.upButton.connect(this,{click:["emit","move",-1]}),this.downButton.connect(this,{click:["emit","move",1]}),this.removeButton.connect(this,{click:["emit","remove"]}),this.$element.addClass("oo-ui-outlineControlsWidget"),this.$group.addClass("oo-ui-outlineControlsWidget-items"),this.$movers.addClass("oo-ui-outlineControlsWidget-movers").append(this.removeButton.$element,this.upButton.$element,this.downButton.$element),this.$element.append(this.$icon,this.$group,this.$movers),this.setAbilities(c.abilities||{})},a.inheritClass(a.ui.OutlineControlsWidget,a.ui.Widget),a.mixinClass(a.ui.OutlineControlsWidget,a.ui.mixin.GroupElement),a.mixinClass(a.ui.OutlineControlsWidget,a.ui.mixin.IconElement),a.ui.OutlineControlsWidget.prototype.setAbilities=function(a){var b;for(b in this.abilities)void 0!==a[b]&&(this.abilities[b]=!!a[b]);this.onOutlineChange()},a.ui.OutlineControlsWidget.prototype.onOutlineChange=function(){var a,b,c,d,e=this.outline.getItems(),f=this.outline.getSelectedItem(),g=this.abilities.move&&f&&f.isMovable(),h=this.abilities.remove&&f&&f.isRemovable();if(g){for(a=-1,b=e.length;++a<b;)if(e[a].isMovable()){c=e[a];break}for(a=b;a--;)if(e[a].isMovable()){d=e[a];break}}this.upButton.setDisabled(!g||f===c),this.downButton.setDisabled(!g||f===d),this.removeButton.setDisabled(!h)},a.ui.ToggleWidget=function(b){b=b||{},a.ui.ToggleWidget.parent.call(this,b),this.value=null,this.$element.addClass("oo-ui-toggleWidget"),this.setValue(!!b.value)},a.inheritClass(a.ui.ToggleWidget,a.ui.Widget),a.ui.ToggleWidget.prototype.getValue=function(){return this.value},a.ui.ToggleWidget.prototype.setValue=function(a){return a=!!a,this.value!==a&&(this.value=a,this.emit("change",a),this.$element.toggleClass("oo-ui-toggleWidget-on",a),this.$element.toggleClass("oo-ui-toggleWidget-off",!a),this.$element.attr("aria-checked",a.toString())),this},a.ui.ButtonGroupWidget=function(b){b=b||{},a.ui.ButtonGroupWidget.parent.call(this,b),a.ui.mixin.GroupElement.call(this,$.extend({},b,{$group:this.$element})),this.$element.addClass("oo-ui-buttonGroupWidget"),Array.isArray(b.items)&&this.addItems(b.items)},a.inheritClass(a.ui.ButtonGroupWidget,a.ui.Widget),a.mixinClass(a.ui.ButtonGroupWidget,a.ui.mixin.GroupElement),a.ui.ButtonWidget=function(b){b=b||{},a.ui.ButtonWidget.parent.call(this,b),a.ui.mixin.ButtonElement.call(this,b),a.ui.mixin.IconElement.call(this,b),a.ui.mixin.IndicatorElement.call(this,b),a.ui.mixin.LabelElement.call(this,b),a.ui.mixin.TitledElement.call(this,$.extend({},b,{$titled:this.$button})),a.ui.mixin.FlaggedElement.call(this,b),a.ui.mixin.TabIndexedElement.call(this,$.extend({},b,{$tabIndexed:this.$button})),a.ui.mixin.AccessKeyedElement.call(this,$.extend({},b,{$accessKeyed:this.$button})),this.href=null,this.target=null,this.noFollow=!1,this.connect(this,{disable:"onDisable"}),this.$button.append(this.$icon,this.$label,this.$indicator),this.$element.addClass("oo-ui-buttonWidget").append(this.$button),this.setHref(b.href),this.setTarget(b.target),this.setNoFollow(b.noFollow)},a.inheritClass(a.ui.ButtonWidget,a.ui.Widget),a.mixinClass(a.ui.ButtonWidget,a.ui.mixin.ButtonElement),a.mixinClass(a.ui.ButtonWidget,a.ui.mixin.IconElement),a.mixinClass(a.ui.ButtonWidget,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.ButtonWidget,a.ui.mixin.LabelElement),a.mixinClass(a.ui.ButtonWidget,a.ui.mixin.TitledElement),a.mixinClass(a.ui.ButtonWidget,a.ui.mixin.FlaggedElement),a.mixinClass(a.ui.ButtonWidget,a.ui.mixin.TabIndexedElement),a.mixinClass(a.ui.ButtonWidget,a.ui.mixin.AccessKeyedElement),a.ui.ButtonWidget.prototype.onMouseDown=function(b){return this.isDisabled()||this.$button.removeAttr("tabindex"),a.ui.mixin.ButtonElement.prototype.onMouseDown.call(this,b)},a.ui.ButtonWidget.prototype.onMouseUp=function(b){return this.isDisabled()||this.$button.attr("tabindex",this.tabIndex),a.ui.mixin.ButtonElement.prototype.onMouseUp.call(this,b)},a.ui.ButtonWidget.prototype.getHref=function(){return this.href},a.ui.ButtonWidget.prototype.getTarget=function(){return this.target},a.ui.ButtonWidget.prototype.getNoFollow=function(){return this.noFollow},a.ui.ButtonWidget.prototype.setHref=function(b){if(b="string"==typeof b?b:null,null!==b&&!a.ui.isSafeUrl(b))throw new Error("Potentially unsafe href provided: "+b);return b!==this.href&&(this.href=b,this.updateHref()),this},a.ui.ButtonWidget.prototype.updateHref=function(){return null===this.href||this.isDisabled()?this.$button.removeAttr("href"):this.$button.attr("href",this.href),this},a.ui.ButtonWidget.prototype.onDisable=function(){this.updateHref()},a.ui.ButtonWidget.prototype.setTarget=function(a){return a="string"==typeof a?a:null,a!==this.target&&(this.target=a,null!==a?this.$button.attr("target",a):this.$button.removeAttr("target")),this},a.ui.ButtonWidget.prototype.setNoFollow=function(a){return a="boolean"==typeof a?a:!0,a!==this.noFollow&&(this.noFollow=a,a?this.$button.attr("rel","nofollow"):this.$button.removeAttr("rel")),this},a.ui.ActionWidget=function(b){b=$.extend({framed:!1},b),a.ui.ActionWidget.parent.call(this,b),a.ui.mixin.PendingElement.call(this,b),this.action=b.action||"",this.modes=b.modes||[],this.width=0,this.height=0,this.$element.addClass("oo-ui-actionWidget")},a.inheritClass(a.ui.ActionWidget,a.ui.ButtonWidget),a.mixinClass(a.ui.ActionWidget,a.ui.mixin.PendingElement),a.ui.ActionWidget.prototype.hasMode=function(a){return-1!==this.modes.indexOf(a)},a.ui.ActionWidget.prototype.getAction=function(){return this.action},a.ui.ActionWidget.prototype.getModes=function(){return this.modes.slice()},a.ui.ActionWidget.prototype.propagateResize=function(){var a,b;return this.isElementAttached()&&(a=this.$element.width(),b=this.$element.height(),(a!==this.width||b!==this.height)&&(this.width=a,this.height=b,this.emit("resize"))),this},a.ui.ActionWidget.prototype.setIcon=function(){return a.ui.mixin.IconElement.prototype.setIcon.apply(this,arguments),this.propagateResize(),this},a.ui.ActionWidget.prototype.setLabel=function(){return a.ui.mixin.LabelElement.prototype.setLabel.apply(this,arguments),this.propagateResize(),this},a.ui.ActionWidget.prototype.setFlags=function(){return a.ui.mixin.FlaggedElement.prototype.setFlags.apply(this,arguments),this.propagateResize(),this},a.ui.ActionWidget.prototype.clearFlags=function(){return a.ui.mixin.FlaggedElement.prototype.clearFlags.apply(this,arguments),this.propagateResize(),this},a.ui.ActionWidget.prototype.toggle=function(){return a.ui.ActionWidget.parent.prototype.toggle.apply(this,arguments),this.propagateResize(),this},a.ui.PopupButtonWidget=function(b){a.ui.PopupButtonWidget.parent.call(this,b),a.ui.mixin.PopupElement.call(this,b),this.connect(this,{click:"onAction"}),this.$element.addClass("oo-ui-popupButtonWidget").attr("aria-haspopup","true").append(this.popup.$element)},a.inheritClass(a.ui.PopupButtonWidget,a.ui.ButtonWidget),a.mixinClass(a.ui.PopupButtonWidget,a.ui.mixin.PopupElement),a.ui.PopupButtonWidget.prototype.onAction=function(){this.popup.toggle()},a.ui.ToggleButtonWidget=function(b){b=b||{},a.ui.ToggleButtonWidget.parent.call(this,b),a.ui.mixin.ButtonElement.call(this,b),a.ui.mixin.IconElement.call(this,b),a.ui.mixin.IndicatorElement.call(this,b),a.ui.mixin.LabelElement.call(this,b),a.ui.mixin.TitledElement.call(this,$.extend({},b,{$titled:this.$button})),a.ui.mixin.FlaggedElement.call(this,b),a.ui.mixin.TabIndexedElement.call(this,$.extend({},b,{$tabIndexed:this.$button})),this.connect(this,{click:"onAction"}),this.$button.append(this.$icon,this.$label,this.$indicator),this.$element.addClass("oo-ui-toggleButtonWidget").append(this.$button)},a.inheritClass(a.ui.ToggleButtonWidget,a.ui.ToggleWidget),a.mixinClass(a.ui.ToggleButtonWidget,a.ui.mixin.ButtonElement),a.mixinClass(a.ui.ToggleButtonWidget,a.ui.mixin.IconElement),a.mixinClass(a.ui.ToggleButtonWidget,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.ToggleButtonWidget,a.ui.mixin.LabelElement),a.mixinClass(a.ui.ToggleButtonWidget,a.ui.mixin.TitledElement),a.mixinClass(a.ui.ToggleButtonWidget,a.ui.mixin.FlaggedElement),a.mixinClass(a.ui.ToggleButtonWidget,a.ui.mixin.TabIndexedElement),a.ui.ToggleButtonWidget.prototype.onAction=function(){this.setValue(!this.value)},a.ui.ToggleButtonWidget.prototype.setValue=function(b){return b=!!b,b!==this.value&&(this.$button&&this.$button.attr("aria-pressed",b.toString()),this.setActive(b)),a.ui.ToggleButtonWidget.parent.prototype.setValue.call(this,b),this},a.ui.ToggleButtonWidget.prototype.setButtonElement=function(b){this.$button&&this.$button.removeAttr("aria-pressed"),a.ui.mixin.ButtonElement.prototype.setButtonElement.call(this,b),this.$button.attr("aria-pressed",this.value.toString())},a.ui.CapsuleMultiSelectWidget=function(b){var c;b=b||{},a.ui.CapsuleMultiSelectWidget.parent.call(this,b),this.$input=b.popup?null:$("<input>"),this.$handle=$("<div>"),a.ui.mixin.GroupElement.call(this,b),b.popup?(b.popup=$.extend({},b.popup,{align:"forwards",anchor:!1}),a.ui.mixin.PopupElement.call(this,b),c=$("<span>"),a.ui.mixin.TabIndexedElement.call(this,$.extend({},b,{$tabIndexed:c}))):(this.popup=null,c=null,a.ui.mixin.TabIndexedElement.call(this,$.extend({},b,{$tabIndexed:this.$input}))),a.ui.mixin.IndicatorElement.call(this,b),a.ui.mixin.IconElement.call(this,b),this.allowArbitrary=!!b.allowArbitrary,this.$overlay=b.$overlay||this.$element,this.menu=new a.ui.FloatingMenuSelectWidget($.extend({widget:this,$input:this.$input,$container:this.$element,filterFromInput:!0,disabled:this.isDisabled()},b.menu)),this.popup?(c.on({focus:this.onFocusForPopup.bind(this)}),this.popup.$element.on("focusout",this.onPopupFocusOut.bind(this)),this.popup.$autoCloseIgnore&&this.popup.$autoCloseIgnore.on("focusout",this.onPopupFocusOut.bind(this)),this.popup.connect(this,{toggle:function(a){c.toggle(!a)}})):this.$input.on({focus:this.onInputFocus.bind(this),blur:this.onInputBlur.bind(this),"propertychange change click mouseup keydown keyup input cut paste select":this.onInputChange.bind(this),keydown:this.onKeyDown.bind(this),keypress:this.onKeyPress.bind(this)}),this.menu.connect(this,{choose:"onMenuChoose",add:"onMenuItemsChange",remove:"onMenuItemsChange"}),this.$handle.on({click:this.onClick.bind(this)}),this.$input&&(this.$input.prop("disabled",this.isDisabled()),this.$input.attr({role:"combobox","aria-autocomplete":"list"}),this.$input.width("1em")),b.data&&this.setItemsFromData(b.data),this.$group.addClass("oo-ui-capsuleMultiSelectWidget-group"),this.$handle.addClass("oo-ui-capsuleMultiSelectWidget-handle").append(this.$indicator,this.$icon,this.$group),this.$element.addClass("oo-ui-capsuleMultiSelectWidget").append(this.$handle),this.popup?(this.$handle.append(c),this.$overlay.append(this.popup.$element)):(this.$handle.append(this.$input),this.$overlay.append(this.menu.$element)),this.onMenuItemsChange()},a.inheritClass(a.ui.CapsuleMultiSelectWidget,a.ui.Widget),a.mixinClass(a.ui.CapsuleMultiSelectWidget,a.ui.mixin.GroupElement),a.mixinClass(a.ui.CapsuleMultiSelectWidget,a.ui.mixin.PopupElement),a.mixinClass(a.ui.CapsuleMultiSelectWidget,a.ui.mixin.TabIndexedElement),a.mixinClass(a.ui.CapsuleMultiSelectWidget,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.CapsuleMultiSelectWidget,a.ui.mixin.IconElement),a.ui.CapsuleMultiSelectWidget.prototype.createItemWidget=function(b,c){return new a.ui.CapsuleItemWidget({data:b,label:c})},a.ui.CapsuleMultiSelectWidget.prototype.getItemsData=function(){return $.map(this.getItems(),function(a){return a.data})},a.ui.CapsuleMultiSelectWidget.prototype.setItemsFromData=function(a){var b=this,c=this.menu,d=this.getItems();return $.each(a,function(a,e){var f,g,h=c.getItemFromData(e);if(h)g=h.label;else{if(!b.allowArbitrary)return;g=String(e)}for(h=null,f=0;f<d.length;f++)if(d[f].data===e&&d[f].label===g){h=d[f],d.splice(f,1);break}h||(h=b.createItemWidget(e,g)),b.addItems([h],a);
}),d.length&&b.removeItems(d),this},a.ui.CapsuleMultiSelectWidget.prototype.addItemsFromData=function(a){var b=this,c=this.menu,d=[];return $.each(a,function(a,e){var f;b.getItemFromData(e)||(f=c.getItemFromData(e),f?d.push(b.createItemWidget(e,f.label)):b.allowArbitrary&&d.push(b.createItemWidget(e,String(e))))}),d.length&&this.addItems(d),this},a.ui.CapsuleMultiSelectWidget.prototype.removeItemsFromData=function(a){var b=this,c=[];return $.each(a,function(a,d){var e=b.getItemFromData(d);e&&c.push(e)}),c.length&&this.removeItems(c),this},a.ui.CapsuleMultiSelectWidget.prototype.addItems=function(b){var c,d,e,f=this.items.slice();if(a.ui.mixin.GroupElement.prototype.addItems.call(this,b),this.items.length!==f.length)c=!1;else for(c=!0,d=0,e=f.length;c&&e>d;d++)c=c&&this.items[d]===f[d];return c||this.emit("change",this.getItemsData()),this},a.ui.CapsuleMultiSelectWidget.prototype.removeItems=function(b){var c,d,e,f=this.items.slice();if(a.ui.mixin.GroupElement.prototype.removeItems.call(this,b),this.items.length!==f.length)c=!1;else for(c=!0,d=0,e=f.length;c&&e>d;d++)c=c&&this.items[d]===f[d];return c||this.emit("change",this.getItemsData()),this},a.ui.CapsuleMultiSelectWidget.prototype.clearItems=function(){return this.items.length&&(a.ui.mixin.GroupElement.prototype.clearItems.call(this),this.emit("change",this.getItemsData())),this},a.ui.CapsuleMultiSelectWidget.prototype.getMenu=function(){return this.menu},a.ui.CapsuleMultiSelectWidget.prototype.onInputFocus=function(){this.isDisabled()||this.menu.toggle(!0)},a.ui.CapsuleMultiSelectWidget.prototype.onInputBlur=function(){this.allowArbitrary&&""!==this.$input.val().trim()&&this.addItemsFromData([this.$input.val()]),this.clearInput()},a.ui.CapsuleMultiSelectWidget.prototype.onFocusForPopup=function(){this.isDisabled()||(this.popup.setSize(this.$handle.width()),this.popup.toggle(!0),this.popup.$element.find("*").filter(function(){return a.ui.isFocusableElement($(this),!0)}).first().focus())},a.ui.CapsuleMultiSelectWidget.prototype.onPopupFocusOut=function(){var b=this.popup;setTimeout(function(){!b.isVisible()||a.ui.contains(b.$element[0],document.activeElement,!0)||b.$autoCloseIgnore&&b.$autoCloseIgnore.has(document.activeElement).length||b.toggle(!1)})},a.ui.CapsuleMultiSelectWidget.prototype.onClick=function(a){return 1===a.which?(this.focus(),!1):void 0},a.ui.CapsuleMultiSelectWidget.prototype.onKeyPress=function(b){var c;if(!this.isDisabled()){if(b.which===a.ui.Keys.ESCAPE)return this.clearInput(),!1;if(!this.popup){if(this.menu.toggle(!0),b.which===a.ui.Keys.ENTER)return c=this.menu.getItemFromLabel(this.$input.val(),!0),c?(this.addItemsFromData([c.data]),this.clearInput()):this.allowArbitrary&&""!==this.$input.val().trim()&&(this.addItemsFromData([this.$input.val()]),this.clearInput()),!1;setTimeout(this.onInputChange.bind(this),0)}}},a.ui.CapsuleMultiSelectWidget.prototype.onKeyDown=function(b){return this.isDisabled()||b.keyCode!==a.ui.Keys.BACKSPACE||""!==this.$input.val()?void 0:(this.items.length&&this.removeItems(this.items.slice(-1)),!1)},a.ui.CapsuleMultiSelectWidget.prototype.onInputChange=function(){this.isDisabled()||this.$input.width(this.$input.val().length+"em")},a.ui.CapsuleMultiSelectWidget.prototype.onMenuChoose=function(a){a&&a.isVisible()&&(this.addItemsFromData([a.getData()]),this.clearInput())},a.ui.CapsuleMultiSelectWidget.prototype.onMenuItemsChange=function(){this.setItemsFromData(this.getItemsData()),this.$element.toggleClass("oo-ui-capsuleMultiSelectWidget-empty",this.menu.isEmpty())},a.ui.CapsuleMultiSelectWidget.prototype.clearInput=function(){this.$input&&(this.$input.val(""),this.$input.width("1em")),this.popup&&this.popup.toggle(!1),this.menu.toggle(!1),this.menu.selectItem(),this.menu.highlightItem()},a.ui.CapsuleMultiSelectWidget.prototype.setDisabled=function(b){var c,d;if(a.ui.CapsuleMultiSelectWidget.parent.prototype.setDisabled.call(this,b),this.$input&&this.$input.prop("disabled",this.isDisabled()),this.menu&&this.menu.setDisabled(this.isDisabled()),this.popup&&this.popup.setDisabled(this.isDisabled()),this.items)for(c=0,d=this.items.length;d>c;c++)this.items[c].updateDisabled();return this},a.ui.CapsuleMultiSelectWidget.prototype.focus=function(){return this.isDisabled()||(this.popup?(this.popup.setSize(this.$handle.width()),this.popup.toggle(!0),this.popup.$element.find("*").filter(function(){return a.ui.isFocusableElement($(this),!0)}).first().focus()):(this.menu.toggle(!0),this.$input.focus())),this},a.ui.CapsuleItemWidget=function(b){b=b||{},a.ui.CapsuleItemWidget.parent.call(this,b),this.$indicator=$("<span>"),a.ui.mixin.ItemWidget.call(this),a.ui.mixin.IndicatorElement.call(this,$.extend({},b,{$indicator:this.$indicator,indicator:"clear"})),a.ui.mixin.LabelElement.call(this,b),a.ui.mixin.FlaggedElement.call(this,b),a.ui.mixin.TabIndexedElement.call(this,$.extend({},b,{$tabIndexed:this.$indicator})),this.$indicator.on({keydown:this.onCloseKeyDown.bind(this),click:this.onCloseClick.bind(this)}),this.$element.addClass("oo-ui-capsuleItemWidget").append(this.$indicator,this.$label)},a.inheritClass(a.ui.CapsuleItemWidget,a.ui.Widget),a.mixinClass(a.ui.CapsuleItemWidget,a.ui.mixin.ItemWidget),a.mixinClass(a.ui.CapsuleItemWidget,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.CapsuleItemWidget,a.ui.mixin.LabelElement),a.mixinClass(a.ui.CapsuleItemWidget,a.ui.mixin.FlaggedElement),a.mixinClass(a.ui.CapsuleItemWidget,a.ui.mixin.TabIndexedElement),a.ui.CapsuleItemWidget.prototype.onCloseClick=function(){var a=this.getElementGroup();!this.isDisabled()&&a&&$.isFunction(a.removeItems)&&(a.removeItems([this]),a.focus())},a.ui.CapsuleItemWidget.prototype.onCloseKeyDown=function(b){if(!this.isDisabled()&&$.isFunction(this.getElementGroup().removeItems))switch(b.which){case a.ui.Keys.ENTER:case a.ui.Keys.BACKSPACE:case a.ui.Keys.SPACE:return this.getElementGroup().removeItems([this]),!1}},a.ui.DropdownWidget=function(b){b=$.extend({indicator:"down"},b),a.ui.DropdownWidget.parent.call(this,b),this.$handle=this.$("<span>"),this.$overlay=b.$overlay||this.$element,a.ui.mixin.IconElement.call(this,b),a.ui.mixin.IndicatorElement.call(this,b),a.ui.mixin.LabelElement.call(this,b),a.ui.mixin.TitledElement.call(this,$.extend({},b,{$titled:this.$label})),a.ui.mixin.TabIndexedElement.call(this,$.extend({},b,{$tabIndexed:this.$handle})),this.menu=new a.ui.FloatingMenuSelectWidget($.extend({widget:this,$container:this.$element},b.menu)),this.$handle.on({click:this.onClick.bind(this),keypress:this.onKeyPress.bind(this)}),this.menu.connect(this,{select:"onMenuSelect"}),this.$handle.addClass("oo-ui-dropdownWidget-handle").append(this.$icon,this.$label,this.$indicator),this.$element.addClass("oo-ui-dropdownWidget").append(this.$handle),this.$overlay.append(this.menu.$element)},a.inheritClass(a.ui.DropdownWidget,a.ui.Widget),a.mixinClass(a.ui.DropdownWidget,a.ui.mixin.IconElement),a.mixinClass(a.ui.DropdownWidget,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.DropdownWidget,a.ui.mixin.LabelElement),a.mixinClass(a.ui.DropdownWidget,a.ui.mixin.TitledElement),a.mixinClass(a.ui.DropdownWidget,a.ui.mixin.TabIndexedElement),a.ui.DropdownWidget.prototype.getMenu=function(){return this.menu},a.ui.DropdownWidget.prototype.onMenuSelect=function(a){var b;return a?(b=a.getLabel(),b instanceof jQuery&&(b=b.clone()),void this.setLabel(b)):void this.setLabel(null)},a.ui.DropdownWidget.prototype.onClick=function(a){return this.isDisabled()||1!==a.which||this.menu.toggle(),!1},a.ui.DropdownWidget.prototype.onKeyPress=function(b){return this.isDisabled()||(b.which!==a.ui.Keys.SPACE||this.menu.isVisible())&&b.which!==a.ui.Keys.ENTER?void 0:(this.menu.toggle(),!1)},a.ui.SelectFileWidget=function(b){var c;b&&b.dragDropUI&&(b.showDropTarget=!0),b=$.extend({accept:null,placeholder:a.ui.msg("ooui-selectfile-placeholder"),notsupported:a.ui.msg("ooui-selectfile-not-supported"),droppable:!0,showDropTarget:!1},b),a.ui.SelectFileWidget.parent.call(this,b),a.ui.mixin.IconElement.call(this,b),a.ui.mixin.IndicatorElement.call(this,b),a.ui.mixin.PendingElement.call(this,$.extend({},b,{$pending:this.$info})),a.ui.mixin.LabelElement.call(this,$.extend({},b,{autoFitLabel:!0})),this.$info=$("<span>"),this.showDropTarget=b.showDropTarget,this.isSupported=this.constructor["static"].isSupported(),this.currentFile=null,Array.isArray(b.accept)?this.accept=b.accept:this.accept=null,this.placeholder=b.placeholder,this.notsupported=b.notsupported,this.onFileSelectedHandler=this.onFileSelected.bind(this),this.selectButton=new a.ui.ButtonWidget({classes:["oo-ui-selectFileWidget-selectButton"],label:"Select a file",disabled:this.disabled||!this.isSupported}),this.clearButton=new a.ui.ButtonWidget({classes:["oo-ui-selectFileWidget-clearButton"],framed:!1,icon:"remove",disabled:this.disabled}),this.selectButton.$button.on({keypress:this.onKeyPress.bind(this)}),this.clearButton.connect(this,{click:"onClearClick"}),b.droppable&&(c=this.onDragEnterOrOver.bind(this),this.$element.on({dragenter:c,dragover:c,dragleave:this.onDragLeave.bind(this),drop:this.onDrop.bind(this)})),this.addInput(),this.updateUI(),this.$label.addClass("oo-ui-selectFileWidget-label"),this.$info.addClass("oo-ui-selectFileWidget-info").append(this.$icon,this.$label,this.clearButton.$element,this.$indicator),this.$element.addClass("oo-ui-selectFileWidget").append(this.$info,this.selectButton.$element),b.droppable&&b.showDropTarget&&(this.$dropTarget=$("<div>").addClass("oo-ui-selectFileWidget-dropTarget").text(a.ui.msg("ooui-selectfile-dragdrop-placeholder")).on({click:this.onDropTargetClick.bind(this)}),this.$element.prepend(this.$dropTarget))},a.inheritClass(a.ui.SelectFileWidget,a.ui.Widget),a.mixinClass(a.ui.SelectFileWidget,a.ui.mixin.IconElement),a.mixinClass(a.ui.SelectFileWidget,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.SelectFileWidget,a.ui.mixin.PendingElement),a.mixinClass(a.ui.SelectFileWidget,a.ui.mixin.LabelElement),a.ui.SelectFileWidget["static"].isSupported=function(){var b;return null===a.ui.SelectFileWidget["static"].isSupportedCache&&(b=$('<input type="file">'),a.ui.SelectFileWidget["static"].isSupportedCache=void 0!==b[0].files),a.ui.SelectFileWidget["static"].isSupportedCache},a.ui.SelectFileWidget["static"].isSupportedCache=null,a.ui.SelectFileWidget.prototype.getValue=function(){return this.currentFile},a.ui.SelectFileWidget.prototype.setValue=function(a){this.currentFile!==a&&(this.currentFile=a,this.updateUI(),this.emit("change",this.currentFile))},a.ui.SelectFileWidget.prototype.focus=function(){return this.selectButton.$button[0].focus(),this},a.ui.SelectFileWidget.prototype.updateUI=function(){var a;this.isSupported?(this.$element.addClass("oo-ui-selectFileWidget-supported"),this.currentFile?(this.$element.removeClass("oo-ui-selectFileWidget-empty"),a=$([]),""!==this.currentFile.type&&(a=a.add($("<span>").addClass("oo-ui-selectFileWidget-fileType").text(this.currentFile.type))),a=a.add($("<span>").text(this.currentFile.name)),this.setLabel(a)):(this.$element.addClass("oo-ui-selectFileWidget-empty"),this.setLabel(this.placeholder))):(this.$element.addClass("oo-ui-selectFileWidget-notsupported"),this.$element.removeClass("oo-ui-selectFileWidget-empty"),this.setLabel(this.notsupported)),this.$input&&this.$input.attr("title",this.getLabel())},a.ui.SelectFileWidget.prototype.addInput=function(){return this.$input&&this.$input.remove(),this.isSupported?(this.$input=$('<input type="file">'),this.$input.on("change",this.onFileSelectedHandler),this.$input.attr({tabindex:-1,title:this.getLabel()}),this.accept&&this.$input.attr("accept",this.accept.join(", ")),void this.selectButton.$button.append(this.$input)):void(this.$input=null)},a.ui.SelectFileWidget.prototype.isAllowedType=function(a){var b,c;if(!this.accept||!a)return!0;for(b=0;b<this.accept.length;b++){if(c=this.accept[b],c===a)return!0;if("/*"===c.substr(-2)&&(c=c.substr(0,c.length-1),a.substr(0,c.length)===c))return!0}return!1},a.ui.SelectFileWidget.prototype.onFileSelected=function(b){var c=a.getProp(b.target,"files",0)||null;c&&!this.isAllowedType(c.type)&&(c=null),this.setValue(c),this.addInput()},a.ui.SelectFileWidget.prototype.onClearClick=function(){return this.setValue(null),!1},a.ui.SelectFileWidget.prototype.onKeyPress=function(b){return!this.isSupported||this.isDisabled()||!this.$input||b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER?void 0:(this.$input.click(),!1)},a.ui.SelectFileWidget.prototype.onDropTargetClick=function(){return this.isSupported&&!this.isDisabled()&&this.$input?(this.$input.click(),!1):void 0},a.ui.SelectFileWidget.prototype.onDragEnterOrOver=function(b){var c,d=!1,e=b.originalEvent.dataTransfer;return b.preventDefault(),b.stopPropagation(),this.isDisabled()||!this.isSupported?(this.$element.removeClass("oo-ui-selectFileWidget-canDrop"),e.dropEffect="none",!1):(c=a.getProp(e,"items",0)||a.getProp(e,"files",0),c?this.isAllowedType(c.type)&&(d=!0):-1!==Array.prototype.indexOf.call(a.getProp(e,"types")||[],"Files")&&(d=!0),this.$element.toggleClass("oo-ui-selectFileWidget-canDrop",d),d||(e.dropEffect="none"),!1)},a.ui.SelectFileWidget.prototype.onDragLeave=function(){this.$element.removeClass("oo-ui-selectFileWidget-canDrop")},a.ui.SelectFileWidget.prototype.onDrop=function(b){var c=null,d=b.originalEvent.dataTransfer;return b.preventDefault(),b.stopPropagation(),this.$element.removeClass("oo-ui-selectFileWidget-canDrop"),this.isDisabled()||!this.isSupported?!1:(c=a.getProp(d,"files",0),c&&!this.isAllowedType(c.type)&&(c=null),c&&this.setValue(c),!1)},a.ui.SelectFileWidget.prototype.setDisabled=function(b){return a.ui.SelectFileWidget.parent.prototype.setDisabled.call(this,b),this.selectButton&&this.selectButton.setDisabled(b),this.clearButton&&this.clearButton.setDisabled(b),this},a.ui.IconWidget=function(b){b=b||{},a.ui.IconWidget.parent.call(this,b),a.ui.mixin.IconElement.call(this,$.extend({},b,{$icon:this.$element})),a.ui.mixin.TitledElement.call(this,$.extend({},b,{$titled:this.$element})),a.ui.mixin.FlaggedElement.call(this,$.extend({},b,{$flagged:this.$element})),this.$element.addClass("oo-ui-iconWidget")},a.inheritClass(a.ui.IconWidget,a.ui.Widget),a.mixinClass(a.ui.IconWidget,a.ui.mixin.IconElement),a.mixinClass(a.ui.IconWidget,a.ui.mixin.TitledElement),a.mixinClass(a.ui.IconWidget,a.ui.mixin.FlaggedElement),a.ui.IconWidget["static"].tagName="span",a.ui.IndicatorWidget=function(b){b=b||{},a.ui.IndicatorWidget.parent.call(this,b),a.ui.mixin.IndicatorElement.call(this,$.extend({},b,{$indicator:this.$element})),a.ui.mixin.TitledElement.call(this,$.extend({},b,{$titled:this.$element})),this.$element.addClass("oo-ui-indicatorWidget")},a.inheritClass(a.ui.IndicatorWidget,a.ui.Widget),a.mixinClass(a.ui.IndicatorWidget,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.IndicatorWidget,a.ui.mixin.TitledElement),a.ui.IndicatorWidget["static"].tagName="span",a.ui.InputWidget=function(b){b=b||{},a.ui.InputWidget.parent.call(this,b),this.$input=this.getInputElement(b),this.value="",this.inputFilter=b.inputFilter,a.ui.mixin.FlaggedElement.call(this,b),a.ui.mixin.TabIndexedElement.call(this,$.extend({},b,{$tabIndexed:this.$input})),a.ui.mixin.TitledElement.call(this,$.extend({},b,{$titled:this.$input})),a.ui.mixin.AccessKeyedElement.call(this,$.extend({},b,{$accessKeyed:this.$input})),this.$input.on("keydown mouseup cut paste change input select",this.onEdit.bind(this)),this.$input.addClass("oo-ui-inputWidget-input").attr("name",b.name).prop("disabled",this.isDisabled()),this.$element.addClass("oo-ui-inputWidget").append(this.$input),this.setValue(b.value),this.setAccessKey(b.accessKey),b.dir&&this.setDir(b.dir)},a.inheritClass(a.ui.InputWidget,a.ui.Widget),a.mixinClass(a.ui.InputWidget,a.ui.mixin.FlaggedElement),a.mixinClass(a.ui.InputWidget,a.ui.mixin.TabIndexedElement),a.mixinClass(a.ui.InputWidget,a.ui.mixin.TitledElement),a.mixinClass(a.ui.InputWidget,a.ui.mixin.AccessKeyedElement),a.ui.InputWidget["static"].supportsSimpleLabel=!0,a.ui.InputWidget["static"].reusePreInfuseDOM=function(b,c){return c=a.ui.InputWidget.parent["static"].reusePreInfuseDOM(b,c),c.$input=$(b).find(".oo-ui-inputWidget-input"),c},a.ui.InputWidget["static"].gatherPreInfuseState=function(b,c){var d=a.ui.InputWidget.parent["static"].gatherPreInfuseState(b,c);return d.value=c.$input.val(),d.focus=c.$input.is(":focus"),d},a.ui.InputWidget.prototype.getInputElement=function(a){return a.$input||$("<input>")},a.ui.InputWidget.prototype.onEdit=function(){var a=this;this.isDisabled()||setTimeout(function(){a.setValue(a.$input.val())})},a.ui.InputWidget.prototype.getValue=function(){var a=this.$input.val();return this.value!==a&&this.setValue(a),this.value},a.ui.InputWidget.prototype.setRTL=function(a){return this.setDir(a?"rtl":"ltr"),this},a.ui.InputWidget.prototype.setDir=function(a){return this.$input.prop("dir",a),this},a.ui.InputWidget.prototype.setValue=function(a){return a=this.cleanUpValue(a),this.$input.val()!==a&&this.$input.val(a),this.value!==a&&(this.value=a,this.emit("change",this.value)),this},a.ui.InputWidget.prototype.setAccessKey=function(a){return a="string"==typeof a&&a.length?a:null,this.accessKey!==a&&(this.$input&&(null!==a?this.$input.attr("accesskey",a):this.$input.removeAttr("accesskey")),this.accessKey=a),this},a.ui.InputWidget.prototype.cleanUpValue=function(a){return void 0===a||null===a?"":this.inputFilter?this.inputFilter(String(a)):String(a)},a.ui.InputWidget.prototype.simulateLabelClick=function(){this.isDisabled()||(this.$input.is(":checkbox, :radio")&&this.$input.click(),this.$input.is(":input")&&this.$input[0].focus())},a.ui.InputWidget.prototype.setDisabled=function(b){return a.ui.InputWidget.parent.prototype.setDisabled.call(this,b),this.$input&&this.$input.prop("disabled",this.isDisabled()),this},a.ui.InputWidget.prototype.focus=function(){return this.$input[0].focus(),this},a.ui.InputWidget.prototype.blur=function(){return this.$input[0].blur(),this},a.ui.InputWidget.prototype.restorePreInfuseState=function(b){a.ui.InputWidget.parent.prototype.restorePreInfuseState.call(this,b),void 0!==b.value&&b.value!==this.getValue()&&this.setValue(b.value),b.focus&&this.focus()},a.ui.ButtonInputWidget=function(b){b=$.extend({type:"button",useInputTag:!1},b),this.useInputTag=b.useInputTag,a.ui.ButtonInputWidget.parent.call(this,b),a.ui.mixin.ButtonElement.call(this,$.extend({},b,{$button:this.$input})),a.ui.mixin.IconElement.call(this,b),a.ui.mixin.IndicatorElement.call(this,b),a.ui.mixin.LabelElement.call(this,b),a.ui.mixin.TitledElement.call(this,$.extend({},b,{$titled:this.$input})),b.useInputTag||this.$input.append(this.$icon,this.$label,this.$indicator),this.$element.addClass("oo-ui-buttonInputWidget")},a.inheritClass(a.ui.ButtonInputWidget,a.ui.InputWidget),a.mixinClass(a.ui.ButtonInputWidget,a.ui.mixin.ButtonElement),a.mixinClass(a.ui.ButtonInputWidget,a.ui.mixin.IconElement),a.mixinClass(a.ui.ButtonInputWidget,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.ButtonInputWidget,a.ui.mixin.LabelElement),a.mixinClass(a.ui.ButtonInputWidget,a.ui.mixin.TitledElement),a.ui.ButtonInputWidget["static"].supportsSimpleLabel=!1,a.ui.ButtonInputWidget.prototype.getInputElement=function(a){var b;return a.$input?a.$input.empty():(b=-1!==["button","submit","reset"].indexOf(a.type)?a.type:"button",$("<"+(a.useInputTag?"input":"button")+' type="'+b+'">'))},a.ui.ButtonInputWidget.prototype.setLabel=function(b){return a.ui.mixin.LabelElement.prototype.setLabel.call(this,b),this.useInputTag&&("function"==typeof b&&(b=a.ui.resolveMsg(b)),b instanceof jQuery&&(b=b.text()),b||(b=""),this.$input.val(b)),this},a.ui.ButtonInputWidget.prototype.setValue=function(b){return this.useInputTag||a.ui.ButtonInputWidget.parent.prototype.setValue.call(this,b),this},a.ui.CheckboxInputWidget=function(b){b=b||{},a.ui.CheckboxInputWidget.parent.call(this,b),this.$element.addClass("oo-ui-checkboxInputWidget").append($("<span>")),this.setSelected(void 0!==b.selected?b.selected:!1)},a.inheritClass(a.ui.CheckboxInputWidget,a.ui.InputWidget),a.ui.CheckboxInputWidget["static"].gatherPreInfuseState=function(b,c){var d=a.ui.CheckboxInputWidget.parent["static"].gatherPreInfuseState(b,c);return d.checked=c.$input.prop("checked"),d},a.ui.CheckboxInputWidget.prototype.getInputElement=function(){return $('<input type="checkbox" />')},a.ui.CheckboxInputWidget.prototype.onEdit=function(){var a=this;this.isDisabled()||setTimeout(function(){a.setSelected(a.$input.prop("checked"))})},a.ui.CheckboxInputWidget.prototype.setSelected=function(a){return a=!!a,this.selected!==a&&(this.selected=a,this.$input.prop("checked",this.selected),this.emit("change",this.selected)),this},a.ui.CheckboxInputWidget.prototype.isSelected=function(){var a=this.$input.prop("checked");return this.selected!==a&&this.setSelected(a),this.selected},a.ui.CheckboxInputWidget.prototype.restorePreInfuseState=function(b){a.ui.CheckboxInputWidget.parent.prototype.restorePreInfuseState.call(this,b),void 0!==b.checked&&b.checked!==this.isSelected()&&this.setSelected(b.checked)},a.ui.DropdownInputWidget=function(b){b=b||{},this.dropdownWidget=new a.ui.DropdownWidget(b.dropdown),a.ui.DropdownInputWidget.parent.call(this,b),a.ui.mixin.TitledElement.call(this,b),this.dropdownWidget.getMenu().connect(this,{select:"onMenuSelect"}),this.setOptions(b.options||[]),this.$element.addClass("oo-ui-dropdownInputWidget").append(this.dropdownWidget.$element)},a.inheritClass(a.ui.DropdownInputWidget,a.ui.InputWidget),a.mixinClass(a.ui.DropdownInputWidget,a.ui.mixin.TitledElement),a.ui.DropdownInputWidget.prototype.getInputElement=function(a){return a.$input?a.$input.addClass("oo-ui-element-hidden"):$('<input type="hidden">')},a.ui.DropdownInputWidget.prototype.onMenuSelect=function(a){this.setValue(a.getData())},a.ui.DropdownInputWidget.prototype.setValue=function(b){return b=this.cleanUpValue(b),this.dropdownWidget.getMenu().selectItemByData(b),a.ui.DropdownInputWidget.parent.prototype.setValue.call(this,b),this},a.ui.DropdownInputWidget.prototype.setDisabled=function(b){return this.dropdownWidget.setDisabled(b),a.ui.DropdownInputWidget.parent.prototype.setDisabled.call(this,b),this},a.ui.DropdownInputWidget.prototype.setOptions=function(b){var c=this.getValue(),d=this;return this.dropdownWidget.getMenu().clearItems().addItems(b.map(function(b){var c=d.cleanUpValue(b.data);return new a.ui.MenuOptionWidget({data:c,label:void 0!==b.label?b.label:c})})),this.dropdownWidget.getMenu().getItemFromData(c)?this.setValue(c):b.length&&this.setValue(b[0].data),this},a.ui.DropdownInputWidget.prototype.focus=function(){return this.dropdownWidget.getMenu().toggle(!0),this},a.ui.DropdownInputWidget.prototype.blur=function(){return this.dropdownWidget.getMenu().toggle(!1),this},a.ui.RadioInputWidget=function(b){b=b||{},a.ui.RadioInputWidget.parent.call(this,b),this.$element.addClass("oo-ui-radioInputWidget").append($("<span>")),this.setSelected(void 0!==b.selected?b.selected:!1)},a.inheritClass(a.ui.RadioInputWidget,a.ui.InputWidget),a.ui.RadioInputWidget["static"].gatherPreInfuseState=function(b,c){var d=a.ui.RadioInputWidget.parent["static"].gatherPreInfuseState(b,c);return d.checked=c.$input.prop("checked"),d},a.ui.RadioInputWidget.prototype.getInputElement=function(){return $('<input type="radio" />')},a.ui.RadioInputWidget.prototype.onEdit=function(){},a.ui.RadioInputWidget.prototype.setSelected=function(a){return this.$input.prop("checked",a),this},a.ui.RadioInputWidget.prototype.isSelected=function(){return this.$input.prop("checked")},a.ui.RadioInputWidget.prototype.restorePreInfuseState=function(b){a.ui.RadioInputWidget.parent.prototype.restorePreInfuseState.call(this,b),void 0!==b.checked&&b.checked!==this.isSelected()&&this.setSelected(b.checked)},a.ui.RadioSelectInputWidget=function(b){b=b||{},this.radioSelectWidget=new a.ui.RadioSelectWidget,a.ui.RadioSelectInputWidget.parent.call(this,b),this.radioSelectWidget.connect(this,{select:"onMenuSelect"}),this.setOptions(b.options||[]),this.$element.addClass("oo-ui-radioSelectInputWidget").append(this.radioSelectWidget.$element)},a.inheritClass(a.ui.RadioSelectInputWidget,a.ui.InputWidget),a.ui.RadioSelectInputWidget["static"].supportsSimpleLabel=!1,a.ui.RadioSelectInputWidget["static"].gatherPreInfuseState=function(b,c){var d=a.ui.RadioSelectInputWidget.parent["static"].gatherPreInfuseState(b,c);return d.value=$(b).find(".oo-ui-radioInputWidget .oo-ui-inputWidget-input:checked").val(),d},a.ui.RadioSelectInputWidget.prototype.getInputElement=function(){return $('<input type="hidden">')},a.ui.RadioSelectInputWidget.prototype.onMenuSelect=function(a){this.setValue(a.getData())},a.ui.RadioSelectInputWidget.prototype.setValue=function(b){return b=this.cleanUpValue(b),this.radioSelectWidget.selectItemByData(b),a.ui.RadioSelectInputWidget.parent.prototype.setValue.call(this,b),this},a.ui.RadioSelectInputWidget.prototype.setDisabled=function(b){return this.radioSelectWidget.setDisabled(b),a.ui.RadioSelectInputWidget.parent.prototype.setDisabled.call(this,b),this},a.ui.RadioSelectInputWidget.prototype.setOptions=function(b){var c=this.getValue(),d=this;return this.radioSelectWidget.clearItems().addItems(b.map(function(b){var c=d.cleanUpValue(b.data);return new a.ui.RadioOptionWidget({data:c,label:void 0!==b.label?b.label:c})})),this.radioSelectWidget.getItemFromData(c)?this.setValue(c):b.length&&this.setValue(b[0].data),this},a.ui.TextInputWidget=function(b){b=$.extend({type:"text",labelPosition:"after"},b),"search"===b.type&&void 0===b.icon&&(b.icon="search"),b.required&&void 0===b.indicator&&(b.indicator="required"),a.ui.TextInputWidget.parent.call(this,b),a.ui.mixin.IconElement.call(this,b),a.ui.mixin.IndicatorElement.call(this,b),a.ui.mixin.PendingElement.call(this,$.extend({},b,{$pending:this.$input})),a.ui.mixin.LabelElement.call(this,b),this.type=this.getSaneType(b),this.readOnly=!1,this.multiline=!!b.multiline,this.autosize=!!b.autosize,this.minRows=void 0!==b.rows?b.rows:"",this.maxRows=b.maxRows||Math.max(2*(this.minRows||0),10),this.validate=null,this.styleHeight=null,this.scrollWidth=null,this.autosize&&(this.$clone=this.$input.clone().insertAfter(this.$input).attr("aria-hidden","true").addClass("oo-ui-element-hidden")),this.setValidation(b.validate),this.setLabelPosition(b.labelPosition),this.$input.on({keypress:this.onKeyPress.bind(this),blur:this.onBlur.bind(this)}),this.$input.one({focus:this.onElementAttach.bind(this)}),this.$icon.on("mousedown",this.onIconMouseDown.bind(this)),this.$indicator.on("mousedown",this.onIndicatorMouseDown.bind(this)),this.on("labelChange",this.updatePosition.bind(this)),this.connect(this,{change:"onChange",disable:"onDisable"}),this.$element.addClass("oo-ui-textInputWidget oo-ui-textInputWidget-type-"+this.type).append(this.$icon,this.$indicator),this.setReadOnly(!!b.readOnly),this.updateSearchIndicator(),b.placeholder&&this.$input.attr("placeholder",b.placeholder),void 0!==b.maxLength&&this.$input.attr("maxlength",b.maxLength),b.autofocus&&this.$input.attr("autofocus","autofocus"),b.required&&(this.$input.attr("required","required"),this.$input.attr("aria-required","true")),b.autocomplete===!1&&(this.$input.attr("autocomplete","off"),$(window).on({beforeunload:function(){this.$input.removeAttr("autocomplete")}.bind(this),pageshow:function(){this.$input.attr("autocomplete","off")}.bind(this)})),this.multiline&&b.rows&&this.$input.attr("rows",b.rows),(this.label||b.autosize)&&this.installParentChangeDetector()},a.inheritClass(a.ui.TextInputWidget,a.ui.InputWidget),a.mixinClass(a.ui.TextInputWidget,a.ui.mixin.IconElement),a.mixinClass(a.ui.TextInputWidget,a.ui.mixin.IndicatorElement),a.mixinClass(a.ui.TextInputWidget,a.ui.mixin.PendingElement),a.mixinClass(a.ui.TextInputWidget,a.ui.mixin.LabelElement),a.ui.TextInputWidget["static"].validationPatterns={"non-empty":/.+/,integer:/^\d+$/},a.ui.TextInputWidget["static"].gatherPreInfuseState=function(b,c){var d=a.ui.TextInputWidget.parent["static"].gatherPreInfuseState(b,c);return c.multiline&&(d.scrollTop=c.$input.scrollTop()),d},a.ui.TextInputWidget.prototype.onIconMouseDown=function(a){return 1===a.which?(this.$input[0].focus(),!1):void 0},a.ui.TextInputWidget.prototype.onIndicatorMouseDown=function(a){return 1===a.which?("search"===this.type&&this.setValue(""),this.$input[0].focus(),!1):void 0},a.ui.TextInputWidget.prototype.onKeyPress=function(b){b.which!==a.ui.Keys.ENTER||this.multiline||this.emit("enter",b)},a.ui.TextInputWidget.prototype.onBlur=function(){this.setValidityFlag()},a.ui.TextInputWidget.prototype.onElementAttach=function(){this.valCache=null,this.adjustSize(),this.positionLabel()},a.ui.TextInputWidget.prototype.onChange=function(){this.updateSearchIndicator(),this.setValidityFlag(),this.adjustSize()},a.ui.TextInputWidget.prototype.onDisable=function(){this.updateSearchIndicator()},a.ui.TextInputWidget.prototype.isReadOnly=function(){return this.readOnly},a.ui.TextInputWidget.prototype.setReadOnly=function(a){return this.readOnly=!!a,this.$input.prop("readOnly",this.readOnly),this.updateSearchIndicator(),this},a.ui.TextInputWidget.prototype.installParentChangeDetector=function(){var a,b,c,d,e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,f=this;if(e){if(this.$element.closest("html").length)return;for(c=this.$element[0];c.parentNode;)c=c.parentNode;a=new e(function(a){var d,e,f;for(d=0;d<a.length;d++)for(f=a[d].removedNodes,e=0;e<f.length;e++)if(f[e]===c)return void setTimeout(b,0)}),b=function(){f.$element.closest("html").length&&f.onElementAttach(),a.disconnect(),f.installParentChangeDetector()},d=$("<div>").append(c)[0],a.observe(d,{childList:!0})}else this.$element.on("DOMNodeInsertedIntoDocument",this.onElementAttach.bind(this))},a.ui.TextInputWidget.prototype.adjustSize=function(){var a,b,c,d,e,f,g,h,i;return this.multiline&&this.$input.val()!==this.valCache&&(this.autosize&&(this.$clone.val(this.$input.val()).attr("rows",this.minRows).css("height",0),this.$clone.removeClass("oo-ui-element-hidden"),this.valCache=this.$input.val(),a=this.$clone[0].scrollHeight,this.$clone.css("height",""),b=this.$clone.innerHeight(),c=this.$clone.outerHeight(),this.$clone.attr("rows",this.maxRows).css("height","auto").val(""),d=this.$clone.innerHeight(),e=d-this.$clone[0].scrollHeight,f=Math.min(d,a+e),this.$clone.addClass("oo-ui-element-hidden"),g=f>b?f+(c-b):"",g!==this.styleHeight&&(this.$input.css("height",g),this.styleHeight=g,this.emit("resize"))),h=this.$input[0].offsetWidth-this.$input[0].clientWidth,h!==this.scrollWidth&&(i="rtl"===this.$element.css("direction")?"left":"right",this.$label.css({right:"",left:""}),this.$indicator.css({right:"",left:""}),h&&(this.$indicator.css(i,h),"after"===this.labelPosition&&this.$label.css(i,h)),this.scrollWidth=h,this.positionLabel())),this},a.ui.TextInputWidget.prototype.getInputElement=function(a){return a.multiline?$("<textarea>"):$('<input type="'+this.getSaneType(a)+'" />')},a.ui.TextInputWidget.prototype.getSaneType=function(a){var b=-1!==["text","password","search","email","url"].indexOf(a.type)?a.type:"text";return a.multiline?"multiline":b},a.ui.TextInputWidget.prototype.isMultiline=function(){return!!this.multiline},a.ui.TextInputWidget.prototype.isAutosizing=function(){return!!this.autosize},a.ui.TextInputWidget.prototype.selectRange=function(a,b){var c,d,e,f,g=this.$input[0];return b=b||a,d=a>b,e=d?b:a,f=d?a:b,this.focus(),g.setSelectionRange?g.setSelectionRange(e,f,d?"backward":"forward"):g.createTextRange&&(c=g.createTextRange(),c.collapse(!0),c.moveStart("character",e),c.moveEnd("character",f-e),c.select()),this},a.ui.TextInputWidget.prototype.getRange=function(){var a=this.$input[0],b=a.selectionStart,c=a.selectionEnd,d="backward"===a.selectionDirection;return{from:d?c:b,to:d?b:c}},a.ui.TextInputWidget.prototype.getInputLength=function(){return this.$input[0].value.length},a.ui.TextInputWidget.prototype.select=function(){return this.selectRange(0,this.getInputLength())},a.ui.TextInputWidget.prototype.moveCursorToStart=function(){return this.selectRange(0)},a.ui.TextInputWidget.prototype.moveCursorToEnd=function(){
return this.selectRange(this.getInputLength())},a.ui.TextInputWidget.prototype.setValidation=function(a){a instanceof RegExp||a instanceof Function?this.validate=a:this.validate=this.constructor["static"].validationPatterns[a]||/.*/},a.ui.TextInputWidget.prototype.setValidityFlag=function(a){var b=this,c=function(a){a?b.$input.removeAttr("aria-invalid"):b.$input.attr("aria-invalid","true"),b.setFlags({invalid:!a})};void 0!==a?c(a):this.getValidity().then(function(){c(!0)},function(){c(!1)})},a.ui.TextInputWidget.prototype.isValid=function(){var a;return this.validate instanceof Function?(a=this.validate(this.getValue()),$.isFunction(a.promise)?a.promise():$.Deferred().resolve(!!a).promise()):$.Deferred().resolve(!!this.getValue().match(this.validate)).promise()},a.ui.TextInputWidget.prototype.getValidity=function(){function a(a){return a?$.Deferred().resolve().promise():$.Deferred().reject().promise()}var b,c;return this.validate instanceof Function?(b=this.validate(this.getValue()),$.isFunction(b.promise)?(c=$.Deferred(),b.then(function(a){a?c.resolve():c.reject()},function(){c.reject()}),c.promise()):a(b)):a(this.getValue().match(this.validate))},a.ui.TextInputWidget.prototype.setLabelPosition=function(a){return this.labelPosition=a,this.updatePosition(),this},a.ui.TextInputWidget.prototype.setPosition=a.ui.TextInputWidget.prototype.setLabelPosition,a.ui.TextInputWidget.prototype.updatePosition=function(){var a="after"===this.labelPosition;return this.$element.toggleClass("oo-ui-textInputWidget-labelPosition-after",!!this.label&&a).toggleClass("oo-ui-textInputWidget-labelPosition-before",!!this.label&&!a),this.valCache=null,this.scrollWidth=null,this.adjustSize(),this.positionLabel(),this},a.ui.TextInputWidget.prototype.updateSearchIndicator=function(){"search"===this.type&&(""===this.getValue()||this.isDisabled()||this.isReadOnly()?this.setIndicator(null):this.setIndicator("clear"))},a.ui.TextInputWidget.prototype.positionLabel=function(){var a,b,c;return this.$input.css({"padding-right":"","padding-left":""}),this.label?(this.$element.append(this.$label),a="after"===this.labelPosition,b="rtl"===this.$element.css("direction"),c=a===b?"padding-left":"padding-right",this.$input.css(c,this.$label.outerWidth(!0)+(a?this.scrollWidth:0)),this):void this.$label.detach()},a.ui.TextInputWidget.prototype.restorePreInfuseState=function(b){a.ui.TextInputWidget.parent.prototype.restorePreInfuseState.call(this,b),void 0!==b.scrollTop&&this.$input.scrollTop(b.scrollTop)},a.ui.ComboBoxInputWidget=function(b){b=$.extend({indicator:"down"},b),$.extend(b,b.input),a.ui.ComboBoxInputWidget.parent.call(this,b),this.$overlay=b.$overlay||this.$element,this.menu=new a.ui.FloatingMenuSelectWidget($.extend({widget:this,input:this,$container:this.$element,disabled:this.isDisabled()},b.menu)),this.input=this,this.$indicator.on({click:this.onIndicatorClick.bind(this),keypress:this.onIndicatorKeyPress.bind(this)}),this.connect(this,{change:"onInputChange",enter:"onInputEnter"}),this.menu.connect(this,{choose:"onMenuChoose",add:"onMenuItemsChange",remove:"onMenuItemsChange"}),this.$input.attr({role:"combobox","aria-autocomplete":"list"}),void 0!==b.options&&this.setOptions(b.options),this.$element.addClass("oo-ui-comboBoxInputWidget oo-ui-comboBoxWidget"),this.$overlay.append(this.menu.$element),this.onMenuItemsChange()},a.inheritClass(a.ui.ComboBoxInputWidget,a.ui.TextInputWidget),a.ui.ComboBoxInputWidget.prototype.getMenu=function(){return this.menu},a.ui.ComboBoxInputWidget.prototype.getInput=function(){return this},a.ui.ComboBoxInputWidget.prototype.onInputChange=function(a){var b=this.menu.getItemFromData(a);this.menu.selectItem(b),this.menu.getHighlightedItem()&&this.menu.highlightItem(b),this.isDisabled()||this.menu.toggle(!0)},a.ui.ComboBoxInputWidget.prototype.onIndicatorClick=function(a){return this.isDisabled()||1!==a.which||(this.menu.toggle(),this.$input[0].focus()),!1},a.ui.ComboBoxInputWidget.prototype.onIndicatorKeyPress=function(b){return this.isDisabled()||b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER?void 0:(this.menu.toggle(),this.$input[0].focus(),!1)},a.ui.ComboBoxInputWidget.prototype.onInputEnter=function(){this.isDisabled()||this.menu.toggle(!1)},a.ui.ComboBoxInputWidget.prototype.onMenuChoose=function(a){this.setValue(a.getData())},a.ui.ComboBoxInputWidget.prototype.onMenuItemsChange=function(){var a=this.menu.getItemFromData(this.getValue());this.menu.selectItem(a),this.menu.getHighlightedItem()&&this.menu.highlightItem(a),this.$element.toggleClass("oo-ui-comboBoxInputWidget-empty",this.menu.isEmpty())},a.ui.ComboBoxInputWidget.prototype.setDisabled=function(b){return a.ui.ComboBoxInputWidget.parent.prototype.setDisabled.call(this,b),this.menu&&this.menu.setDisabled(this.isDisabled()),this},a.ui.ComboBoxInputWidget.prototype.setOptions=function(b){return this.getMenu().clearItems().addItems(b.map(function(b){return new a.ui.MenuOptionWidget({data:b.data,label:void 0!==b.label?b.label:b.data})})),this},a.ui.ComboBoxWidget=a.ui.ComboBoxInputWidget,a.ui.LabelWidget=function(b){b=b||{},a.ui.LabelWidget.parent.call(this,b),a.ui.mixin.LabelElement.call(this,$.extend({},b,{$label:this.$element})),a.ui.mixin.TitledElement.call(this,b),this.input=b.input,this.input instanceof a.ui.InputWidget&&this.$element.on("click",this.onClick.bind(this)),this.$element.addClass("oo-ui-labelWidget")},a.inheritClass(a.ui.LabelWidget,a.ui.Widget),a.mixinClass(a.ui.LabelWidget,a.ui.mixin.LabelElement),a.mixinClass(a.ui.LabelWidget,a.ui.mixin.TitledElement),a.ui.LabelWidget["static"].tagName="span",a.ui.LabelWidget.prototype.onClick=function(){return this.input.simulateLabelClick(),!1},a.ui.OptionWidget=function(b){b=b||{},a.ui.OptionWidget.parent.call(this,b),a.ui.mixin.ItemWidget.call(this),a.ui.mixin.LabelElement.call(this,b),a.ui.mixin.FlaggedElement.call(this,b),this.selected=!1,this.highlighted=!1,this.pressed=!1,this.$element.data("oo-ui-optionWidget",this).attr("role","option").attr("aria-selected","false").addClass("oo-ui-optionWidget").append(this.$label)},a.inheritClass(a.ui.OptionWidget,a.ui.Widget),a.mixinClass(a.ui.OptionWidget,a.ui.mixin.ItemWidget),a.mixinClass(a.ui.OptionWidget,a.ui.mixin.LabelElement),a.mixinClass(a.ui.OptionWidget,a.ui.mixin.FlaggedElement),a.ui.OptionWidget["static"].selectable=!0,a.ui.OptionWidget["static"].highlightable=!0,a.ui.OptionWidget["static"].pressable=!0,a.ui.OptionWidget["static"].scrollIntoViewOnSelect=!1,a.ui.OptionWidget.prototype.isSelectable=function(){return this.constructor["static"].selectable&&!this.isDisabled()&&this.isVisible()},a.ui.OptionWidget.prototype.isHighlightable=function(){return this.constructor["static"].highlightable&&!this.isDisabled()&&this.isVisible()},a.ui.OptionWidget.prototype.isPressable=function(){return this.constructor["static"].pressable&&!this.isDisabled()&&this.isVisible()},a.ui.OptionWidget.prototype.isSelected=function(){return this.selected},a.ui.OptionWidget.prototype.isHighlighted=function(){return this.highlighted},a.ui.OptionWidget.prototype.isPressed=function(){return this.pressed},a.ui.OptionWidget.prototype.setSelected=function(a){return this.constructor["static"].selectable&&(this.selected=!!a,this.$element.toggleClass("oo-ui-optionWidget-selected",a).attr("aria-selected",a.toString()),a&&this.constructor["static"].scrollIntoViewOnSelect&&this.scrollElementIntoView(),this.updateThemeClasses()),this},a.ui.OptionWidget.prototype.setHighlighted=function(a){return this.constructor["static"].highlightable&&(this.highlighted=!!a,this.$element.toggleClass("oo-ui-optionWidget-highlighted",a),this.updateThemeClasses()),this},a.ui.OptionWidget.prototype.setPressed=function(a){return this.constructor["static"].pressable&&(this.pressed=!!a,this.$element.toggleClass("oo-ui-optionWidget-pressed",a),this.updateThemeClasses()),this},a.ui.DecoratedOptionWidget=function(b){a.ui.DecoratedOptionWidget.parent.call(this,b),a.ui.mixin.IconElement.call(this,b),a.ui.mixin.IndicatorElement.call(this,b),this.$element.addClass("oo-ui-decoratedOptionWidget").prepend(this.$icon).append(this.$indicator)},a.inheritClass(a.ui.DecoratedOptionWidget,a.ui.OptionWidget),a.mixinClass(a.ui.DecoratedOptionWidget,a.ui.mixin.IconElement),a.mixinClass(a.ui.DecoratedOptionWidget,a.ui.mixin.IndicatorElement),a.ui.ButtonOptionWidget=function(b){b=b||{},a.ui.ButtonOptionWidget.parent.call(this,b),a.ui.mixin.ButtonElement.call(this,b),a.ui.mixin.TitledElement.call(this,$.extend({},b,{$titled:this.$button})),a.ui.mixin.TabIndexedElement.call(this,$.extend({},b,{$tabIndexed:this.$button,tabIndex:-1})),this.$element.addClass("oo-ui-buttonOptionWidget"),this.$button.append(this.$element.contents()),this.$element.append(this.$button)},a.inheritClass(a.ui.ButtonOptionWidget,a.ui.DecoratedOptionWidget),a.mixinClass(a.ui.ButtonOptionWidget,a.ui.mixin.ButtonElement),a.mixinClass(a.ui.ButtonOptionWidget,a.ui.mixin.TitledElement),a.mixinClass(a.ui.ButtonOptionWidget,a.ui.mixin.TabIndexedElement),a.ui.ButtonOptionWidget["static"].cancelButtonMouseDownEvents=!1,a.ui.ButtonOptionWidget["static"].highlightable=!1,a.ui.ButtonOptionWidget.prototype.setSelected=function(b){return a.ui.ButtonOptionWidget.parent.prototype.setSelected.call(this,b),this.constructor["static"].selectable&&this.setActive(b),this},a.ui.RadioOptionWidget=function(b){b=b||{},this.radio=new a.ui.RadioInputWidget({value:b.data,tabIndex:-1}),a.ui.RadioOptionWidget.parent.call(this,b),this.radio.$input.on("focus",this.onInputFocus.bind(this)),this.radio.$input.attr("role","presentation"),this.$element.addClass("oo-ui-radioOptionWidget").attr("role","radio").attr("aria-checked","false").removeAttr("aria-selected").prepend(this.radio.$element)},a.inheritClass(a.ui.RadioOptionWidget,a.ui.OptionWidget),a.ui.RadioOptionWidget["static"].highlightable=!1,a.ui.RadioOptionWidget["static"].scrollIntoViewOnSelect=!0,a.ui.RadioOptionWidget["static"].pressable=!1,a.ui.RadioOptionWidget["static"].tagName="label",a.ui.RadioOptionWidget.prototype.onInputFocus=function(){this.radio.$input.blur(),this.$element.parent().focus()},a.ui.RadioOptionWidget.prototype.setSelected=function(b){return a.ui.RadioOptionWidget.parent.prototype.setSelected.call(this,b),this.radio.setSelected(b),this.$element.attr("aria-checked",b.toString()).removeAttr("aria-selected"),this},a.ui.RadioOptionWidget.prototype.setDisabled=function(b){return a.ui.RadioOptionWidget.parent.prototype.setDisabled.call(this,b),this.radio.setDisabled(this.isDisabled()),this},a.ui.MenuOptionWidget=function(b){b=$.extend({icon:"check"},b),a.ui.MenuOptionWidget.parent.call(this,b),this.$element.attr("role","menuitem").addClass("oo-ui-menuOptionWidget")},a.inheritClass(a.ui.MenuOptionWidget,a.ui.DecoratedOptionWidget),a.ui.MenuOptionWidget["static"].scrollIntoViewOnSelect=!0,a.ui.MenuSectionOptionWidget=function(b){a.ui.MenuSectionOptionWidget.parent.call(this,b),this.$element.addClass("oo-ui-menuSectionOptionWidget")},a.inheritClass(a.ui.MenuSectionOptionWidget,a.ui.DecoratedOptionWidget),a.ui.MenuSectionOptionWidget["static"].selectable=!1,a.ui.MenuSectionOptionWidget["static"].highlightable=!1,a.ui.OutlineOptionWidget=function(b){b=b||{},a.ui.OutlineOptionWidget.parent.call(this,b),this.level=0,this.movable=!!b.movable,this.removable=!!b.removable,this.$element.addClass("oo-ui-outlineOptionWidget"),this.setLevel(b.level)},a.inheritClass(a.ui.OutlineOptionWidget,a.ui.DecoratedOptionWidget),a.ui.OutlineOptionWidget["static"].highlightable=!1,a.ui.OutlineOptionWidget["static"].scrollIntoViewOnSelect=!0,a.ui.OutlineOptionWidget["static"].levelClass="oo-ui-outlineOptionWidget-level-",a.ui.OutlineOptionWidget["static"].levels=3,a.ui.OutlineOptionWidget.prototype.isMovable=function(){return this.movable},a.ui.OutlineOptionWidget.prototype.isRemovable=function(){return this.removable},a.ui.OutlineOptionWidget.prototype.getLevel=function(){return this.level},a.ui.OutlineOptionWidget.prototype.setMovable=function(a){return this.movable=!!a,this.updateThemeClasses(),this},a.ui.OutlineOptionWidget.prototype.setRemovable=function(a){return this.removable=!!a,this.updateThemeClasses(),this},a.ui.OutlineOptionWidget.prototype.setLevel=function(a){var b=this.constructor["static"].levels,c=this.constructor["static"].levelClass,d=b;for(this.level=a?Math.max(0,Math.min(b-1,a)):0;d--;)this.level===d?this.$element.addClass(c+d):this.$element.removeClass(c+d);return this.updateThemeClasses(),this},a.ui.TabOptionWidget=function(b){b=b||{},a.ui.TabOptionWidget.parent.call(this,b),this.$element.addClass("oo-ui-tabOptionWidget")},a.inheritClass(a.ui.TabOptionWidget,a.ui.OptionWidget),a.ui.TabOptionWidget["static"].highlightable=!1,a.ui.PopupWidget=function(b){b=b||{},a.ui.PopupWidget.parent.call(this,b),this.$body=$("<div>"),this.$popup=$("<div>"),a.ui.mixin.LabelElement.call(this,b),a.ui.mixin.ClippableElement.call(this,$.extend({},b,{$clippable:this.$body,$clippableContainer:this.$popup})),this.$head=$("<div>"),this.$footer=$("<div>"),this.$anchor=$("<div>"),this.$container=b.$container,this.containerPadding=void 0!==b.containerPadding?b.containerPadding:10,this.autoClose=!!b.autoClose,this.$autoCloseIgnore=b.$autoCloseIgnore,this.transitionTimeout=null,this.anchor=null,this.width=void 0!==b.width?b.width:320,this.height=void 0!==b.height?b.height:null,this.setAlignment(b.align),this.closeButton=new a.ui.ButtonWidget({framed:!1,icon:"close"}),this.onMouseDownHandler=this.onMouseDown.bind(this),this.onDocumentKeyDownHandler=this.onDocumentKeyDown.bind(this),this.closeButton.connect(this,{click:"onCloseButtonClick"}),this.toggleAnchor(void 0===b.anchor||b.anchor),this.$body.addClass("oo-ui-popupWidget-body"),this.$anchor.addClass("oo-ui-popupWidget-anchor"),this.$head.addClass("oo-ui-popupWidget-head").append(this.$label,this.closeButton.$element),this.$footer.addClass("oo-ui-popupWidget-footer"),b.head||this.$head.addClass("oo-ui-element-hidden"),b.$footer||this.$footer.addClass("oo-ui-element-hidden"),this.$popup.addClass("oo-ui-popupWidget-popup").append(this.$head,this.$body,this.$footer),this.$element.addClass("oo-ui-popupWidget").append(this.$popup,this.$anchor),b.$content instanceof jQuery&&this.$body.append(b.$content),b.$footer instanceof jQuery&&this.$footer.append(b.$footer),b.padded&&this.$body.addClass("oo-ui-popupWidget-body-padded"),this.visible=!1,this.$element.addClass("oo-ui-element-hidden")},a.inheritClass(a.ui.PopupWidget,a.ui.Widget),a.mixinClass(a.ui.PopupWidget,a.ui.mixin.LabelElement),a.mixinClass(a.ui.PopupWidget,a.ui.mixin.ClippableElement),a.ui.PopupWidget.prototype.onMouseDown=function(a){!this.isVisible()||$.contains(this.$element[0],a.target)||this.$autoCloseIgnore&&this.$autoCloseIgnore.has(a.target).length||this.toggle(!1)},a.ui.PopupWidget.prototype.bindMouseDownListener=function(){a.ui.addCaptureEventListener(this.getElementWindow(),"mousedown",this.onMouseDownHandler)},a.ui.PopupWidget.prototype.onCloseButtonClick=function(){this.isVisible()&&this.toggle(!1)},a.ui.PopupWidget.prototype.unbindMouseDownListener=function(){a.ui.removeCaptureEventListener(this.getElementWindow(),"mousedown",this.onMouseDownHandler)},a.ui.PopupWidget.prototype.onDocumentKeyDown=function(b){b.which===a.ui.Keys.ESCAPE&&this.isVisible()&&(this.toggle(!1),b.preventDefault(),b.stopPropagation())},a.ui.PopupWidget.prototype.bindKeyDownListener=function(){a.ui.addCaptureEventListener(this.getElementWindow(),"keydown",this.onDocumentKeyDownHandler)},a.ui.PopupWidget.prototype.unbindKeyDownListener=function(){a.ui.removeCaptureEventListener(this.getElementWindow(),"keydown",this.onDocumentKeyDownHandler)},a.ui.PopupWidget.prototype.toggleAnchor=function(a){a=void 0===a?!this.anchored:!!a,this.anchored!==a&&(a?this.$element.addClass("oo-ui-popupWidget-anchored"):this.$element.removeClass("oo-ui-popupWidget-anchored"),this.anchored=a)},a.ui.PopupWidget.prototype.hasAnchor=function(){return this.anchor},a.ui.PopupWidget.prototype.toggle=function(b){var c;return b=void 0===b?!this.isVisible():!!b,c=b!==this.isVisible(),a.ui.PopupWidget.parent.prototype.toggle.call(this,b),c&&(b?(this.autoClose&&(this.bindMouseDownListener(),this.bindKeyDownListener()),this.updateDimensions(),this.toggleClipping(!0)):(this.toggleClipping(!1),this.autoClose&&(this.unbindMouseDownListener(),this.unbindKeyDownListener()))),this},a.ui.PopupWidget.prototype.setSize=function(a,b,c){this.width=a,this.height=void 0!==b?b:null,this.isVisible()&&this.updateDimensions(c)},a.ui.PopupWidget.prototype.updateDimensions=function(a){var b,c,d,e,f,g,h,i,j,k,l=this.align,m=this;return this.$container||(this.$container=$(this.getClosestScrollableElementContainer())),this.$popup.css({width:this.width,height:null!==this.height?this.height:"auto"}),("forwards"===l||"backwards"===l)&&(l="rtl"===this.$container.css("direction")?{forwards:"force-left",backwards:"force-right"}[this.align]:{forwards:"force-right",backwards:"force-left"}[this.align]),b=this.width*{"force-left":-1,center:-.5,"force-right":0}[l],c=this.$element.offset().left,d=this.$container.offset().left,e=this.$container.innerWidth(),f=d+e,g=b-this.containerPadding,h=b+this.containerPadding+this.width+this.containerPadding,i=c+g-d,j=f-(c+h),0>j?b+=j:0>i&&(b-=i),k=2*this.$anchor[0].scrollWidth,b+this.width<k?b=k-this.width:k>-b&&(b=-k),clearTimeout(this.transitionTimeout),a&&this.$element.addClass("oo-ui-popupWidget-transitioning"),this.$popup.css("margin-left",b),a?this.transitionTimeout=setTimeout(function(){m.$element.removeClass("oo-ui-popupWidget-transitioning")},200):this.$element.removeClass("oo-ui-popupWidget-transitioning"),this.clip(),this},a.ui.PopupWidget.prototype.setAlignment=function(a){["left","right","force-left","force-right","backwards","forwards","center"].indexOf(a)>-1?this.align={left:"force-right",right:"force-left"}[a]||a:this.align="center"},a.ui.PopupWidget.prototype.getAlignment=function(){return this.align},a.ui.ProgressBarWidget=function(b){b=b||{},a.ui.ProgressBarWidget.parent.call(this,b),this.$bar=$("<div>"),this.progress=null,this.setProgress(void 0!==b.progress?b.progress:!1),this.$bar.addClass("oo-ui-progressBarWidget-bar"),this.$element.attr({role:"progressbar","aria-valuemin":0,"aria-valuemax":100}).addClass("oo-ui-progressBarWidget").append(this.$bar)},a.inheritClass(a.ui.ProgressBarWidget,a.ui.Widget),a.ui.ProgressBarWidget["static"].tagName="div",a.ui.ProgressBarWidget.prototype.getProgress=function(){return this.progress},a.ui.ProgressBarWidget.prototype.setProgress=function(a){this.progress=a,a!==!1?(this.$bar.css("width",this.progress+"%"),this.$element.attr("aria-valuenow",this.progress)):(this.$bar.css("width",""),this.$element.removeAttr("aria-valuenow")),this.$element.toggleClass("oo-ui-progressBarWidget-indeterminate",!a)},a.ui.SearchWidget=function(b){b=b||{},a.ui.SearchWidget.parent.call(this,b),this.query=new a.ui.TextInputWidget({icon:"search",placeholder:b.placeholder,value:b.value}),this.results=new a.ui.SelectWidget,this.$query=$("<div>"),this.$results=$("<div>"),this.query.connect(this,{change:"onQueryChange",enter:"onQueryEnter"}),this.query.$input.on("keydown",this.onQueryKeydown.bind(this)),this.$query.addClass("oo-ui-searchWidget-query").append(this.query.$element),this.$results.addClass("oo-ui-searchWidget-results").append(this.results.$element),this.$element.addClass("oo-ui-searchWidget").append(this.$results,this.$query)},a.inheritClass(a.ui.SearchWidget,a.ui.Widget),a.ui.SearchWidget.prototype.onQueryKeydown=function(b){var c,d,e=b.which===a.ui.Keys.DOWN?1:b.which===a.ui.Keys.UP?-1:0;e&&(c=this.results.getHighlightedItem(),c||(c=this.results.getSelectedItem()),d=this.results.getRelativeSelectableItem(c,e),this.results.highlightItem(d),d.scrollElementIntoView())},a.ui.SearchWidget.prototype.onQueryChange=function(){this.results.clearItems()},a.ui.SearchWidget.prototype.onQueryEnter=function(){var a=this.results.getHighlightedItem();a&&this.results.chooseItem(a)},a.ui.SearchWidget.prototype.getQuery=function(){return this.query},a.ui.SearchWidget.prototype.getResults=function(){return this.results},a.ui.SelectWidget=function(b){b=b||{},a.ui.SelectWidget.parent.call(this,b),a.ui.mixin.GroupWidget.call(this,$.extend({},b,{$group:this.$element})),this.pressed=!1,this.selecting=null,this.onMouseUpHandler=this.onMouseUp.bind(this),this.onMouseMoveHandler=this.onMouseMove.bind(this),this.onKeyDownHandler=this.onKeyDown.bind(this),this.onKeyPressHandler=this.onKeyPress.bind(this),this.keyPressBuffer="",this.keyPressBufferTimer=null,this.connect(this,{toggle:"onToggle"}),this.$element.on({mousedown:this.onMouseDown.bind(this),mouseover:this.onMouseOver.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.$element.addClass("oo-ui-selectWidget oo-ui-selectWidget-depressed").attr("role","listbox"),Array.isArray(b.items)&&this.addItems(b.items)},a.inheritClass(a.ui.SelectWidget,a.ui.Widget),a.mixinClass(a.ui.SelectWidget,a.ui.mixin.GroupElement),a.mixinClass(a.ui.SelectWidget,a.ui.mixin.GroupWidget),a.ui.SelectWidget["static"].passAllFilter=function(){return!0},a.ui.SelectWidget.prototype.onMouseDown=function(b){var c;return this.isDisabled()||1!==b.which||(this.togglePressed(!0),c=this.getTargetItem(b),c&&c.isSelectable()&&(this.pressItem(c),this.selecting=c,a.ui.addCaptureEventListener(this.getElementDocument(),"mouseup",this.onMouseUpHandler),a.ui.addCaptureEventListener(this.getElementDocument(),"mousemove",this.onMouseMoveHandler))),!1},a.ui.SelectWidget.prototype.onMouseUp=function(b){var c;return this.togglePressed(!1),this.selecting||(c=this.getTargetItem(b),c&&c.isSelectable()&&(this.selecting=c)),!this.isDisabled()&&1===b.which&&this.selecting&&(this.pressItem(null),this.chooseItem(this.selecting),this.selecting=null),a.ui.removeCaptureEventListener(this.getElementDocument(),"mouseup",this.onMouseUpHandler),a.ui.removeCaptureEventListener(this.getElementDocument(),"mousemove",this.onMouseMoveHandler),!1},a.ui.SelectWidget.prototype.onMouseMove=function(a){var b;return!this.isDisabled()&&this.pressed&&(b=this.getTargetItem(a),b&&b!==this.selecting&&b.isSelectable()&&(this.pressItem(b),this.selecting=b)),!1},a.ui.SelectWidget.prototype.onMouseOver=function(a){var b;return this.isDisabled()||(b=this.getTargetItem(a),this.highlightItem(b&&b.isHighlightable()?b:null)),!1},a.ui.SelectWidget.prototype.onMouseLeave=function(){return this.isDisabled()||this.highlightItem(null),!1},a.ui.SelectWidget.prototype.onKeyDown=function(b){var c,d=!1,e=this.getHighlightedItem()||this.getSelectedItem();if(!this.isDisabled()&&this.isVisible()){switch(b.keyCode){case a.ui.Keys.ENTER:e&&e.constructor["static"].highlightable&&(this.chooseItem(e),d=!0);break;case a.ui.Keys.UP:case a.ui.Keys.LEFT:this.clearKeyPressBuffer(),c=this.getRelativeSelectableItem(e,-1),d=!0;break;case a.ui.Keys.DOWN:case a.ui.Keys.RIGHT:this.clearKeyPressBuffer(),c=this.getRelativeSelectableItem(e,1),d=!0;break;case a.ui.Keys.ESCAPE:case a.ui.Keys.TAB:e&&e.constructor["static"].highlightable&&e.setHighlighted(!1),this.unbindKeyDownListener(),this.unbindKeyPressListener(),d=!1}c&&(c.constructor["static"].highlightable?this.highlightItem(c):this.chooseItem(c),c.scrollElementIntoView()),d&&(b.preventDefault(),b.stopPropagation())}},a.ui.SelectWidget.prototype.bindKeyDownListener=function(){a.ui.addCaptureEventListener(this.getElementWindow(),"keydown",this.onKeyDownHandler)},a.ui.SelectWidget.prototype.unbindKeyDownListener=function(){a.ui.removeCaptureEventListener(this.getElementWindow(),"keydown",this.onKeyDownHandler)},a.ui.SelectWidget.prototype.clearKeyPressBuffer=function(){this.keyPressBufferTimer&&(clearTimeout(this.keyPressBufferTimer),this.keyPressBufferTimer=null),this.keyPressBuffer=""},a.ui.SelectWidget.prototype.onKeyPress=function(b){var c,d,e;{if(b.charCode)return c=String.fromCodePoint?String.fromCodePoint(b.charCode):String.fromCharCode(b.charCode),this.keyPressBufferTimer&&clearTimeout(this.keyPressBufferTimer),this.keyPressBufferTimer=setTimeout(this.clearKeyPressBuffer.bind(this),1500),e=this.getHighlightedItem()||this.getSelectedItem(),this.keyPressBuffer===c?e&&(e=this.getRelativeSelectableItem(e,1)):this.keyPressBuffer+=c,d=this.getItemMatcher(this.keyPressBuffer,!1),e&&d(e)||(e=this.getRelativeSelectableItem(e,1,d)),e&&(e.constructor["static"].highlightable?this.highlightItem(e):this.chooseItem(e),e.scrollElementIntoView()),!1;if(b.keyCode===a.ui.Keys.BACKSPACE&&""!==this.keyPressBuffer)return this.keyPressBuffer=this.keyPressBuffer.substr(0,this.keyPressBuffer.length-1),!1}},a.ui.SelectWidget.prototype.getItemMatcher=function(a,b){var c;return a.normalize&&(a=a.normalize()),a=b?a.trim():a.replace(/^\s+/,""),c="^\\s*"+a.replace(/([\\{}()|.?*+\-\^$\[\]])/g,"\\$1").replace(/\s+/g,"\\s+"),b&&(c+="\\s*$"),c=new RegExp(c,"i"),function(a){var b=a.getLabel();return"string"!=typeof b&&(b=a.$label.text()),b.normalize&&(b=b.normalize()),c.test(b)}},a.ui.SelectWidget.prototype.bindKeyPressListener=function(){a.ui.addCaptureEventListener(this.getElementWindow(),"keypress",this.onKeyPressHandler)},a.ui.SelectWidget.prototype.unbindKeyPressListener=function(){a.ui.removeCaptureEventListener(this.getElementWindow(),"keypress",this.onKeyPressHandler),this.clearKeyPressBuffer()},a.ui.SelectWidget.prototype.onToggle=function(a){a||this.clearKeyPressBuffer()},a.ui.SelectWidget.prototype.getTargetItem=function(a){return $(a.target).closest(".oo-ui-optionWidget").data("oo-ui-optionWidget")||null},a.ui.SelectWidget.prototype.getSelectedItem=function(){var a,b;for(a=0,b=this.items.length;b>a;a++)if(this.items[a].isSelected())return this.items[a];return null},a.ui.SelectWidget.prototype.getHighlightedItem=function(){var a,b;for(a=0,b=this.items.length;b>a;a++)if(this.items[a].isHighlighted())return this.items[a];return null},a.ui.SelectWidget.prototype.togglePressed=function(a){void 0===a&&(a=!this.pressed),a!==this.pressed&&(this.$element.toggleClass("oo-ui-selectWidget-pressed",a).toggleClass("oo-ui-selectWidget-depressed",!a),this.pressed=a)},a.ui.SelectWidget.prototype.highlightItem=function(a){var b,c,d,e=!1;for(b=0,c=this.items.length;c>b;b++)d=this.items[b]===a,this.items[b].isHighlighted()!==d&&(this.items[b].setHighlighted(d),e=!0);return e&&this.emit("highlight",a),this},a.ui.SelectWidget.prototype.getItemFromLabel=function(b,c){var d,e,f,g=this.items.length,h=this.getItemMatcher(b,!0);for(d=0;g>d;d++)if(e=this.items[d],e instanceof a.ui.OptionWidget&&e.isSelectable()&&h(e))return e;if(c){for(f=null,h=this.getItemMatcher(b,!1),d=0;g>d;d++)if(e=this.items[d],e instanceof a.ui.OptionWidget&&e.isSelectable()&&h(e)){if(f)return null;f=e}if(f)return f}return null},a.ui.SelectWidget.prototype.selectItemByLabel=function(a,b){var c=this.getItemFromLabel(a,!!b);return void 0!==a&&c?this.selectItem(c):this.selectItem()},a.ui.SelectWidget.prototype.selectItemByData=function(a){var b=this.getItemFromData(a);return void 0!==a&&b?this.selectItem(b):this.selectItem()},a.ui.SelectWidget.prototype.selectItem=function(a){var b,c,d,e=!1;for(b=0,c=this.items.length;c>b;b++)d=this.items[b]===a,this.items[b].isSelected()!==d&&(this.items[b].setSelected(d),e=!0);return e&&this.emit("select",a),this},a.ui.SelectWidget.prototype.pressItem=function(a){var b,c,d,e=!1;for(b=0,c=this.items.length;c>b;b++)d=this.items[b]===a,this.items[b].isPressed()!==d&&(this.items[b].setPressed(d),e=!0);return e&&this.emit("press",a),this},a.ui.SelectWidget.prototype.chooseItem=function(a){return a&&(this.selectItem(a),this.emit("choose",a)),this},a.ui.SelectWidget.prototype.getRelativeSelectableItem=function(b,c,d){var e,f,g,h=c>0?1:-1,i=this.items.length;for($.isFunction(d)||(d=a.ui.SelectWidget["static"].passAllFilter),b instanceof a.ui.OptionWidget?(e=this.items.indexOf(b),f=(e+h+i)%i):f=c>0?0:i-1,g=0;i>g;g++){if(b=this.items[f],b instanceof a.ui.OptionWidget&&b.isSelectable()&&d(b))return b;f=(f+h+i)%i}return null},a.ui.SelectWidget.prototype.getFirstSelectableItem=function(){var b,c,d;for(b=0,c=this.items.length;c>b;b++)if(d=this.items[b],d instanceof a.ui.OptionWidget&&d.isSelectable())return d;return null},a.ui.SelectWidget.prototype.addItems=function(b,c){return a.ui.mixin.GroupWidget.prototype.addItems.call(this,b,c),this.emit("add",b,void 0===c?this.items.length-b.length-1:c),this},a.ui.SelectWidget.prototype.removeItems=function(b){var c,d,e;for(c=0,d=b.length;d>c;c++)e=b[c],e.isSelected()&&this.selectItem(null);return a.ui.mixin.GroupWidget.prototype.removeItems.call(this,b),this.emit("remove",b),this},a.ui.SelectWidget.prototype.clearItems=function(){var b=this.items.slice();return a.ui.mixin.GroupWidget.prototype.clearItems.call(this),this.selectItem(null),this.emit("remove",b),this},a.ui.ButtonSelectWidget=function(b){a.ui.ButtonSelectWidget.parent.call(this,b),a.ui.mixin.TabIndexedElement.call(this,b),this.$element.on({focus:this.bindKeyDownListener.bind(this),blur:this.unbindKeyDownListener.bind(this)}),this.$element.addClass("oo-ui-buttonSelectWidget")},a.inheritClass(a.ui.ButtonSelectWidget,a.ui.SelectWidget),a.mixinClass(a.ui.ButtonSelectWidget,a.ui.mixin.TabIndexedElement),a.ui.RadioSelectWidget=function(b){a.ui.RadioSelectWidget.parent.call(this,b),a.ui.mixin.TabIndexedElement.call(this,b),this.$element.on({focus:this.bindKeyDownListener.bind(this),blur:this.unbindKeyDownListener.bind(this)}),this.$element.addClass("oo-ui-radioSelectWidget").attr("role","radiogroup")},a.inheritClass(a.ui.RadioSelectWidget,a.ui.SelectWidget),a.mixinClass(a.ui.RadioSelectWidget,a.ui.mixin.TabIndexedElement),a.ui.MenuSelectWidget=function(b){b=b||{},a.ui.MenuSelectWidget.parent.call(this,b),a.ui.mixin.ClippableElement.call(this,$.extend({},b,{$clippable:this.$group})),this.newItems=null,this.autoHide=void 0===b.autoHide||!!b.autoHide,this.filterFromInput=!!b.filterFromInput,this.$input=b.$input?b.$input:b.input?b.input.$input:null,this.$widget=b.widget?b.widget.$element:null,this.onDocumentMouseDownHandler=this.onDocumentMouseDown.bind(this),this.onInputEditHandler=a.ui.debounce(this.updateItemVisibility.bind(this),100),this.$element.addClass("oo-ui-menuSelectWidget").attr("role","menu"),this.visible=!1,this.$element.addClass("oo-ui-element-hidden")},a.inheritClass(a.ui.MenuSelectWidget,a.ui.SelectWidget),a.mixinClass(a.ui.MenuSelectWidget,a.ui.mixin.ClippableElement),a.ui.MenuSelectWidget.prototype.onDocumentMouseDown=function(b){a.ui.contains(this.$element[0],b.target,!0)||this.$widget&&a.ui.contains(this.$widget[0],b.target,!0)||this.toggle(!1)},a.ui.MenuSelectWidget.prototype.onKeyDown=function(b){var c=this.getHighlightedItem()||this.getSelectedItem();if(!this.isDisabled()&&this.isVisible())switch(b.keyCode){case a.ui.Keys.LEFT:case a.ui.Keys.RIGHT:this.$input||a.ui.MenuSelectWidget.parent.prototype.onKeyDown.call(this,b);break;case a.ui.Keys.ESCAPE:case a.ui.Keys.TAB:c&&c.setHighlighted(!1),this.toggle(!1),b.keyCode===a.ui.Keys.ESCAPE&&(b.preventDefault(),b.stopPropagation());break;default:return void a.ui.MenuSelectWidget.parent.prototype.onKeyDown.call(this,b)}},a.ui.MenuSelectWidget.prototype.updateItemVisibility=function(){var b,c,d=this.items.length,e=!this.isVisible(),f=e?null:this.getItemMatcher(this.$input.val());for(b=0;d>b;b++)c=this.items[b],c instanceof a.ui.OptionWidget&&c.toggle(e||f(c));this.clip()},a.ui.MenuSelectWidget.prototype.bindKeyDownListener=function(){this.$input?this.$input.on("keydown",this.onKeyDownHandler):a.ui.MenuSelectWidget.parent.prototype.bindKeyDownListener.call(this)},a.ui.MenuSelectWidget.prototype.unbindKeyDownListener=function(){this.$input?this.$input.off("keydown",this.onKeyDownHandler):a.ui.MenuSelectWidget.parent.prototype.unbindKeyDownListener.call(this)},a.ui.MenuSelectWidget.prototype.bindKeyPressListener=function(){this.$input?this.filterFromInput&&this.$input.on("keydown mouseup cut paste change input select",this.onInputEditHandler):a.ui.MenuSelectWidget.parent.prototype.bindKeyPressListener.call(this)},a.ui.MenuSelectWidget.prototype.unbindKeyPressListener=function(){this.$input?this.filterFromInput&&(this.$input.off("keydown mouseup cut paste change input select",this.onInputEditHandler),
this.updateItemVisibility()):a.ui.MenuSelectWidget.parent.prototype.unbindKeyPressListener.call(this)},a.ui.MenuSelectWidget.prototype.chooseItem=function(b){return a.ui.MenuSelectWidget.parent.prototype.chooseItem.call(this,b),this.toggle(!1),this},a.ui.MenuSelectWidget.prototype.addItems=function(b,c){var d,e,f;for(a.ui.MenuSelectWidget.parent.prototype.addItems.call(this,b,c),this.newItems||(this.newItems=[]),d=0,e=b.length;e>d;d++)f=b[d],this.isVisible()?f.fitLabel():this.newItems.push(f);return this.clip(),this},a.ui.MenuSelectWidget.prototype.removeItems=function(b){return a.ui.MenuSelectWidget.parent.prototype.removeItems.call(this,b),this.clip(),this},a.ui.MenuSelectWidget.prototype.clearItems=function(){return a.ui.MenuSelectWidget.parent.prototype.clearItems.call(this),this.clip(),this},a.ui.MenuSelectWidget.prototype.toggle=function(b){var c,d,e;if(b=(void 0===b?!this.visible:!!b)&&!!this.items.length,e=b!==this.isVisible(),a.ui.MenuSelectWidget.parent.prototype.toggle.call(this,b),e)if(b){if(this.bindKeyDownListener(),this.bindKeyPressListener(),this.newItems&&this.newItems.length){for(c=0,d=this.newItems.length;d>c;c++)this.newItems[c].fitLabel();this.newItems=null}this.toggleClipping(!0),this.autoHide&&a.ui.addCaptureEventListener(this.getElementDocument(),"mousedown",this.onDocumentMouseDownHandler)}else this.unbindKeyDownListener(),this.unbindKeyPressListener(),a.ui.removeCaptureEventListener(this.getElementDocument(),"mousedown",this.onDocumentMouseDownHandler),this.toggleClipping(!1);return this},a.ui.FloatingMenuSelectWidget=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.inputWidget),c=c||{},a.ui.FloatingMenuSelectWidget.parent.call(this,c),this.inputWidget=b,this.$container=c.$container||this.inputWidget.$element,a.ui.mixin.FloatableElement.call(this,$.extend({},c,{$floatableContainer:this.$container})),this.$element.addClass("oo-ui-floatingMenuSelectWidget"),this.$element.addClass("oo-ui-textInputMenuSelectWidget")},a.inheritClass(a.ui.FloatingMenuSelectWidget,a.ui.MenuSelectWidget),a.mixinClass(a.ui.FloatingMenuSelectWidget,a.ui.mixin.FloatableElement),a.ui.TextInputMenuSelectWidget=a.ui.FloatingMenuSelectWidget,a.ui.FloatingMenuSelectWidget.prototype.toggle=function(b){var c;return b=void 0===b?!this.isVisible():!!b,c=b!==this.isVisible(),c&&b&&this.setIdealSize(this.$container.width()),a.ui.FloatingMenuSelectWidget.parent.prototype.toggle.call(this,b),c&&this.togglePositioning(this.isVisible()),this},a.ui.OutlineSelectWidget=function(b){a.ui.OutlineSelectWidget.parent.call(this,b),a.ui.mixin.TabIndexedElement.call(this,b),this.$element.on({focus:this.bindKeyDownListener.bind(this),blur:this.unbindKeyDownListener.bind(this)}),this.$element.addClass("oo-ui-outlineSelectWidget")},a.inheritClass(a.ui.OutlineSelectWidget,a.ui.SelectWidget),a.mixinClass(a.ui.OutlineSelectWidget,a.ui.mixin.TabIndexedElement),a.ui.TabSelectWidget=function(b){a.ui.TabSelectWidget.parent.call(this,b),a.ui.mixin.TabIndexedElement.call(this,b),this.$element.on({focus:this.bindKeyDownListener.bind(this),blur:this.unbindKeyDownListener.bind(this)}),this.$element.addClass("oo-ui-tabSelectWidget")},a.inheritClass(a.ui.TabSelectWidget,a.ui.SelectWidget),a.mixinClass(a.ui.TabSelectWidget,a.ui.mixin.TabIndexedElement),a.ui.NumberInputWidget=function(b){b=$.extend({isInteger:!1,min:-(1/0),max:1/0,step:1,pageStep:null},b),a.ui.NumberInputWidget.parent.call(this,b),this.input=new a.ui.TextInputWidget($.extend({disabled:this.isDisabled()},b.input)),this.minusButton=new a.ui.ButtonWidget($.extend({disabled:this.isDisabled(),tabIndex:-1},b.minusButton,{classes:["oo-ui-numberInputWidget-minusButton"],label:"−"})),this.plusButton=new a.ui.ButtonWidget($.extend({disabled:this.isDisabled(),tabIndex:-1},b.plusButton,{classes:["oo-ui-numberInputWidget-plusButton"],label:"+"})),this.input.connect(this,{change:this.emit.bind(this,"change"),enter:this.emit.bind(this,"enter")}),this.input.$input.on({keydown:this.onKeyDown.bind(this),"wheel mousewheel DOMMouseScroll":this.onWheel.bind(this)}),this.plusButton.connect(this,{click:["onButtonClick",1]}),this.minusButton.connect(this,{click:["onButtonClick",-1]}),this.setIsInteger(!!b.isInteger),this.setRange(b.min,b.max),this.setStep(b.step,b.pageStep),this.$field=$("<div>").addClass("oo-ui-numberInputWidget-field").append(this.minusButton.$element,this.input.$element,this.plusButton.$element),this.$element.addClass("oo-ui-numberInputWidget").append(this.$field),this.input.setValidation(this.validateNumber.bind(this))},a.inheritClass(a.ui.NumberInputWidget,a.ui.Widget),a.ui.NumberInputWidget.prototype.setIsInteger=function(a){this.isInteger=!!a,this.input.setValidityFlag()},a.ui.NumberInputWidget.prototype.getIsInteger=function(){return this.isInteger},a.ui.NumberInputWidget.prototype.setRange=function(a,b){if(a>b)throw new Error("Minimum ("+a+") must not be greater than maximum ("+b+")");this.min=a,this.max=b,this.input.setValidityFlag()},a.ui.NumberInputWidget.prototype.getRange=function(){return[this.min,this.max]},a.ui.NumberInputWidget.prototype.setStep=function(a,b){if(0>=a)throw new Error("Step value must be positive");if(null===b)b=10*a;else if(0>=b)throw new Error("Page step value must be positive");this.step=a,this.pageStep=b},a.ui.NumberInputWidget.prototype.getStep=function(){return[this.step,this.pageStep]},a.ui.NumberInputWidget.prototype.getValue=function(){return this.input.getValue()},a.ui.NumberInputWidget.prototype.getNumericValue=function(){return+this.input.getValue()},a.ui.NumberInputWidget.prototype.setValue=function(a){this.input.setValue(a)},a.ui.NumberInputWidget.prototype.adjustValue=function(a){var b,c=this.getNumericValue();if(a=+a,isNaN(a)||!isFinite(a))throw new Error("Delta must be a finite number");isNaN(c)?b=0:(b=c+a,b=Math.max(Math.min(b,this.max),this.min),this.isInteger&&(b=Math.round(b))),b!==c&&this.setValue(b)},a.ui.NumberInputWidget.prototype.validateNumber=function(a){var b=+a;return isNaN(b)||!isFinite(b)?!1:this.isInteger&&(0|b)!==b?!1:b<this.min||b>this.max?!1:!0},a.ui.NumberInputWidget.prototype.onButtonClick=function(a){this.adjustValue(a*this.step)},a.ui.NumberInputWidget.prototype.onWheel=function(a){var b=0;return void 0!==a.originalEvent.deltaMode&&(this.sawWheelEvent=!0),a.originalEvent.deltaY?b=-a.originalEvent.deltaY:a.originalEvent.deltaX&&(b=a.originalEvent.deltaX),this.sawWheelEvent||(a.originalEvent.wheelDeltaX?b=-a.originalEvent.wheelDeltaX:a.originalEvent.wheelDeltaY?b=a.originalEvent.wheelDeltaY:a.originalEvent.wheelDelta?b=a.originalEvent.wheelDelta:a.originalEvent.detail&&(b=-a.originalEvent.detail)),b&&(b=0>b?-1:1,this.adjustValue(b*this.step)),!1},a.ui.NumberInputWidget.prototype.onKeyDown=function(b){if(!this.isDisabled())switch(b.which){case a.ui.Keys.UP:return this.adjustValue(this.step),!1;case a.ui.Keys.DOWN:return this.adjustValue(-this.step),!1;case a.ui.Keys.PAGEUP:return this.adjustValue(this.pageStep),!1;case a.ui.Keys.PAGEDOWN:return this.adjustValue(-this.pageStep),!1}},a.ui.NumberInputWidget.prototype.setDisabled=function(b){return a.ui.NumberInputWidget.parent.prototype.setDisabled.call(this,b),this.input&&this.input.setDisabled(this.isDisabled()),this.minusButton&&this.minusButton.setDisabled(this.isDisabled()),this.plusButton&&this.plusButton.setDisabled(this.isDisabled()),this},a.ui.ToggleSwitchWidget=function(b){a.ui.ToggleSwitchWidget.parent.call(this,b),a.ui.mixin.TabIndexedElement.call(this,b),this.dragging=!1,this.dragStart=null,this.sliding=!1,this.$glow=$("<span>"),this.$grip=$("<span>"),this.$element.on({click:this.onClick.bind(this),keypress:this.onKeyPress.bind(this)}),this.$glow.addClass("oo-ui-toggleSwitchWidget-glow"),this.$grip.addClass("oo-ui-toggleSwitchWidget-grip"),this.$element.addClass("oo-ui-toggleSwitchWidget").attr("role","checkbox").append(this.$glow,this.$grip)},a.inheritClass(a.ui.ToggleSwitchWidget,a.ui.ToggleWidget),a.mixinClass(a.ui.ToggleSwitchWidget,a.ui.mixin.TabIndexedElement),a.ui.ToggleSwitchWidget.prototype.onClick=function(a){return this.isDisabled()||1!==a.which||this.setValue(!this.value),!1},a.ui.ToggleSwitchWidget.prototype.onKeyPress=function(b){return this.isDisabled()||b.which!==a.ui.Keys.SPACE&&b.which!==a.ui.Keys.ENTER?void 0:(this.setValue(!this.value),!1)}}(OO);
//# sourceMappingURL=oojs-ui.min.js.map