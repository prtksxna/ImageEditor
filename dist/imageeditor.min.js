Caman.Plugin.register("flip",function(a){var b,c,d,e;return d=this.canvas.width,e=this.canvas.height,b=document.createElement("canvas"),b.width=d,b.height=e,b.id=this.canvas.id,c=b.getContext("2d"),"x"===a?(c.translate(d,0),c.scale(-1,1)):"y"===a&&(c.translate(0,e),c.scale(1,-1)),c.drawImage(this.canvas,0,0),this.replaceCanvas(b),this}),Caman.Filter.register("flip",function(){return this.processPlugin("flip",arguments)}),function(a,b){var c=c||{};c.ImageTweaks=function(c,d){this.$container=a("#"+c),this.$container.addClass("mwe-imagetweaks-editor").append(a("<div>").addClass("mwe-imagetweaks-canvas-container").append(a("<img>").attr("src",d).attr("id","mwe-imagetweaks-image"))),this.editor=new b.ui.PanelLayout({framed:!0,padded:!1}),this.$container.append(this.editor.$element),this.toolFactory=new b.ui.ToolFactory,this.toolGroupFactory=new b.ui.ToolGroupFactory,this.toolbar=new b.ui.Toolbar(this.toolFactory,this.toolGroupFactory,{actions:!0}),this.setupTools(),this.toolbar.setup([{type:"bar",include:["undo","redo"]},{type:"bar",include:["rotateCounterClockwise","rotateClockwise"]},{type:"bar",include:["flipVertical","flipHorizontal"]},{type:"bar",include:["crop"]}]),this.saveButton=new b.ui.ButtonWidget({label:"Save",flags:["progressive","primary"]}),this.toolbar.$actions.append(this.saveButton.$element),this.editor.$element.append(this.toolbar.$element)},c.ImageTweaks.prototype.intialize=function(){},c.ImageTweaks.prototype.setupTools=function(){this.setupTool({name:"undo",icon:"undo",title:"Undo"},function(){this.setActive(!1)}),this.setupTool({name:"redo",icon:"redo",title:"Redo"},function(){this.setActive(!1)}),this.setupTool({name:"rotateCounterClockwise",icon:"rotate-counter-clockwise",title:"Rotate counter clockwise"},function(){Caman("#mwe-imagetweaks-image",function(){this.rotate(-90),this.render()}),this.setActive(!1)}),this.setupTool({name:"rotateClockwise",icon:"rotate-clockwise",title:"Rotate clockwise"},function(){Caman("#mwe-imagetweaks-image",function(){this.rotate(90),this.render()}),this.setActive(!1)}),this.setupTool({name:"flipVertical",icon:"flip-vertical",title:"Flip vertical"},function(){Caman("#mwe-imagetweaks-image",function(){this.flip("y"),this.render()}),this.setActive(!1)}),this.setupTool({name:"flipHorizontal",icon:"flip-horizontal",title:"Flip horizontal"},function(){Caman("#mwe-imagetweaks-image",function(){this.flip("x"),this.render()}),this.setActive(!1)}),this.setupTool({name:"crop",icon:"crop",title:"Crop"},function(){this.setActive(!1)})},c.ImageTweaks.prototype.setupTool=function(a,c){function d(){d["super"].apply(this,arguments)}b.inheritClass(d,b.ui.Tool),d["static"].name=a.name,d["static"].icon=a.icon,d["static"].title=a.title,d.prototype.onSelect=c,d.prototype.onUpdateState=function(){this.setActive(!1)},this.toolFactory.register(d)},c.ImageTweaks.prototype.doAction=function(a){switch(a){case"rotateCounterClockwise":Caman("#mwe-imagetweaks-image",function(){this.rotate(-90),this.render()});break;case"rotateClockwise":Caman("#mwe-imagetweaks-image",function(){this.rotate(90),this.render()});break;default:throw new Error("Unknown action")}},a(function(){var a=new c.ImageTweaks("editor","cat.png");a.initialize()})}(jQuery,OO);